(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{292:function(e,t,n){},294:function(e,t,n){},312:function(e,t,n){},465:function(e,t,n){},466:function(e,t,n){},497:function(e,t,n){},498:function(e,t,n){},499:function(e,t,n){},504:function(e,t,n){"use strict";n.r(t);var a,r,i,s,c,o,l,u,d,j,b,m,O,h,v,p,f,x=n(32),g=n(40),y=n.n(g),I=(n(292),function(e){if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var a=t[n].trim();if(a.substring(0,e.length+1)===e+"=")return decodeURIComponent(a.substring(e.length+1))}return null}),k=n(35),C=n.n(k),N=(n(293),n(527)),z=n(46),D=n(202),F=n(505),R=n(503),S=n(21),A=n(16),E=n(519),q=n(531),T=n(272),w=n.n(T),G=n(0),P=n(63),M=n(39),H=(n(294),n.p+"static/media/mill.1f872c17.svg"),$=n(539),_=n(540),B=n(541),V=n(542),J=n(211),U=n(4),L=function(e){var t=e.logout;return Object(U.jsxs)(J.a,{mode:"horizontal",children:[Object(U.jsx)(J.a.Item,{icon:Object(U.jsx)($.a,{}),children:Object(U.jsx)(P.b,{to:"/",children:"Rezervace"})},"reservation"),Object(U.jsx)(J.a.Item,{icon:Object(U.jsx)(_.a,{}),children:Object(U.jsx)(P.b,{to:"/guests",children:"Host\xe9"})},"guests"),Object(U.jsx)(J.a.Item,{icon:Object(U.jsx)(B.a,{}),children:Object(U.jsx)(P.b,{to:"/apartma",children:"Apartm\xe1"})},"suites"),Object(U.jsx)(J.a.Item,{icon:Object(U.jsx)(V.a,{}),onClick:t,children:"Odhl\xe1sit"},"logout")]})},Z=n(265),K=n(525),W=n(533),Y=n(36),Q=n(114),X=Object(Q.a)(a||(a=Object(Y.a)(["\n  mutation RetrieveToken($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  } \n"]))),ee=Object(Q.a)(r||(r=Object(Y.a)(["\n  mutation DeleteToken {\n    deleteToken {\n      deleted\n    }\n  } \n"]))),te=n(275),ne={onQueryError:function(e,t){console.error(e.message),void 0===t&&(t="Chyba serveru, kontaktujte spr\xe1vce"),te.b.error(t)}},ae=Object(M.f)((function(e){var t=e.history,n=e.location,a=e.isAuthenticated,r=e.setIsAuthenticated,i=Object(W.a)(ee,{onCompleted:function(){setTimeout((function(){r(!1),t.push("/login?next=".concat(n.pathname))}))},onError:ne.onQueryError}),s=Object(S.a)(i,2),c=s[0],o=s[1].loading;return Object(U.jsx)(Z.a,{spinning:o,tip:"Odhla\u0161uji...",children:Object(U.jsx)(K.a,{className:"app-header",children:Object(U.jsxs)("div",{className:"app-header__container",children:[Object(U.jsx)("div",{className:"app-header__logo",children:Object(U.jsx)(P.b,{to:"/",children:Object(U.jsx)("img",{src:H,alt:"Kamenice logo"})})}),!0===a&&Object(U.jsx)("div",{className:"app-header__menu-section",children:Object(U.jsx)(L,{logout:c})})]})})})})),re=n(524),ie=n(51),se=n(60),ce=n.n(se),oe=n(536),le=n(518),ue=(Object(Q.a)(i||(i=Object(Y.a)(["\n  query Guests {\n    guests {\n      id\n      name\n      surname\n    }\n  }\n"]))),Object(Q.a)(s||(s=Object(Y.a)(["\n  query GuestsFull {\n    guests {\n      age\n      addressMunicipality\n      addressPsc\n      addressStreet\n      citizenship\n      email\n      gender\n      identity\n      id\n      name\n      phoneNumber\n      surname\n      visaNumber\n    }\n  }\n"])))),de=n(522),je=n(530),be=n(517),me=n(526),Oe=n(141),he=n(543),ve=n(77),pe={requiredRule:{required:!0,message:"pole je povinn\xe9"},trim:function(e){return void 0===e?e:e.trim()}},fe={ageOptions:[{label:"12+",value:"YOUNG"},{label:"3-12 let",value:"CHILD"},{label:"Do 3 let",value:"INFANT"},{label:"Dosp\u011bl\xfd",value:"ADULT"}],getGuestResponseErrorList:function(e){try{return Array.from(Object.values(JSON.parse(e.replaceAll("'",'"'))),(function(e){return e[0]}))}catch(t){return["Chyba serveru, kontaktujte spr\xe1vce"]}},phoneCodeRequiredRules:[pe.requiredRule,{message:"zadejte k\xf3d ve form\xe1tu 420, +420 nebo (420)",pattern:/^\+?\(?[0-9]*\)?$/,transform:pe.trim}],requiredAlphaRules:[pe.requiredRule,{message:"zadejte pouze text",pattern:/^([A-Za-z\s\xe1\xc1\u010d\u010c\u010f\u010e\xe9\xc9\u011b\u011a\xed\xcd\u0148\u0147\u0159\u0158\u0161\u0160\u0165\u0164\xfa\xda\u016f\u016e\xfd\xdd\u017e\u017d\xf3\xd3])+$/,transform:pe.trim}],requiredNumericRules:[pe.requiredRule,{message:"zadejte pouze \u010d\xedsla",pattern:/^[\d\s]+$/,transform:pe.trim}]},xe=(n(312),Object(Q.a)(c||(c=Object(Y.a)(["\n  mutation CreateGuest($data: GuestInput!) {\n    createGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n"])))),ge=Object(Q.a)(o||(o=Object(Y.a)(["\n  mutation CreateGuestBasic($data: GuestInput!) {\n    createGuest(data: $data) {\n      guest {\n        email\n        name\n        surname\n      }\n    }\n  }\n"]))),ye=Object(Q.a)(l||(l=Object(Y.a)(["\n  mutation UpdateGuest($data: GuestInput!) {\n    updateGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n"]))),Ie=Object(Q.a)(u||(u=Object(Y.a)(["\n  mutation DeleteGuest($guestId: ID!) {\n    deleteGuest(guestId: $guestId) {\n      guest {\n        id\n      }\n    }\n  }\n"]))),ke=function(e){var t=e.close,n=e.guest,a=e.refetch,r=e.visible,i=de.a.useForm(),s=Object(S.a)(i,1)[0],c=Object(W.a)(xe,{onCompleted:function(e){var n,r,i,c;te.b.success("Host ".concat(null===(n=e.createGuest)||void 0===n||null===(r=n.guest)||void 0===r?void 0:r.name," ").concat(null===(i=e.createGuest)||void 0===i||null===(c=i.guest)||void 0===c?void 0:c.surname," byl p\u0159id\xe1n")),void 0!==a&&a(),s.resetFields(),t()},onError:function(e){te.b.error(e.message)}}),o=Object(S.a)(c,1)[0],l=Object(W.a)(ye,{onCompleted:function(e){var n,a,r,i;te.b.success("Host ".concat(null===(n=e.updateGuest)||void 0===n||null===(a=n.guest)||void 0===a?void 0:a.name," ").concat(null===(r=e.updateGuest)||void 0===r||null===(i=r.guest)||void 0===i?void 0:i.surname," byl upraven")),s.resetFields(),t()},onError:function(){te.b.error("Chyba serveru, kontaktujte spr\xe1vce")}}),u=Object(S.a)(l,1)[0],d=Object(G.useState)(!1),j=Object(S.a)(d,2),b=j[0],m=j[1],O={age:null===n||void 0===n?void 0:n.age,address:{municipality:null===n||void 0===n?void 0:n.addressMunicipality,psc:null===n||void 0===n?void 0:n.addressPsc,street:null===n||void 0===n?void 0:n.addressStreet},citizenship:{selected:null===n||void 0===n?void 0:n.citizenship},email:null===n||void 0===n?void 0:n.email,gender:null===n||void 0===n?void 0:n.gender,identity:null===n||void 0===n?void 0:n.identity,name:null===n||void 0===n?void 0:n.name,phone:null===n||void 0===n?void 0:n.phoneNumber,surname:null===n||void 0===n?void 0:n.surname,visa:null===n||void 0===n?void 0:n.visaNumber},h=Object(U.jsx)(de.a.Item,{name:"email-prefix",noStyle:!0,children:Object(U.jsx)(he.a,{})});return Object(G.useEffect)((function(){!0===r&&s.resetFields()}),[s,r]),Object(U.jsx)(je.a,{closeIcon:Object(U.jsx)(be.a,{onCancel:function(){return m(!1)},onConfirm:function(){m(!1),s.resetFields(),t()},placement:"rightTop",title:"Zav\u0159\xedt formul\xe1\u0159? Data ve formul\xe1\u0159i budou ztracena",visible:b,children:Object(U.jsx)(ve.a,{onClick:function(){s.isFieldsTouched()?m(!0):t()}})}),placement:"left",title:"Nov\xfd host",width:500,visible:r,footer:Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(ie.a,{onClick:function(){s.validateFields().then((function(){var e,t,a,r,i,c=s.getFieldsValue(!0),l={age:c.age,addressMunicipality:null===(e=c.address)||void 0===e?void 0:e.municipality,addressPsc:null===(t=c.address)||void 0===t?void 0:t.psc,addressStreet:null===(a=c.address)||void 0===a?void 0:a.street,citizenship:void 0===(null===(r=c.citizenship)||void 0===r?void 0:r.selected)?null===(i=c.citizenship)||void 0===i?void 0:i.new:c.citizenship.selected,email:c.email,gender:c.gender,identity:c.identity,name:c.name,phoneNumber:c.phone,surname:c.surname,visaNumber:c.visa};null===n?o({variables:{data:Object(x.a)({},l)}}):u({variables:{data:Object(x.a)({id:n.id},l)}})})).catch((function(){return te.b.error("Formul\xe1\u0159 nelze odeslat, opravte pros\xedm chyby")}))},type:"primary",children:null===n?"Vytvo\u0159it":"Upravit"})}),footerStyle:{padding:"16px 20px",textAlign:"right"},children:Object(U.jsxs)(de.a,{form:s,initialValues:O,layout:"vertical",name:"guest",children:[Object(U.jsx)(ce.a,{level:5,children:"Osobn\xed \xfadaje"}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"Jm\xe9no",name:"name",required:!0,rules:fe.requiredAlphaRules,children:Object(U.jsx)(me.a,{placeholder:"Va\u0161e Jm\xe9no"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"P\u0159\xedjmen\xed",name:"surname",required:!0,rules:fe.requiredAlphaRules,children:Object(U.jsx)(me.a,{placeholder:"Va\u0161e P\u0159\xedjmen\xed"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"\u010c\xedslo OP",name:"identity",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{placeholder:"\u010d\xedslo ob\u010dansk\xe9ho pr\u016fkazu"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"Telefonn\xed \u010c\xedslo",name:"phone",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{placeholder:"\u010d\xedslo"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"E-Mail",name:"email",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{addonBefore:h,placeholder:"e-mail",type:"email"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"V\u011bk",name:"age",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(Oe.a,{options:fe.ageOptions,placeholder:"vyberte ze seznamu"})}),Object(U.jsx)(de.a.Item,{label:"Pohlav\xed",name:"gender",children:Object(U.jsxs)(Oe.a,{placeholder:"vyberte ze seznamu",children:[Object(U.jsx)(Oe.a.Option,{value:"M",children:"Mu\u017e"}),Object(U.jsx)(Oe.a.Option,{value:"F",children:"\u017dena"})]})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"\u010c\xedslo viza",name:"visa",children:Object(U.jsx)(me.a,{placeholder:"\u010d\xedslo visa"})}),Object(U.jsx)(ce.a,{level:5,children:"Trval\xe9 bydli\u0161t\u011b"}),Object(U.jsx)(de.a.Item,{label:"Ulice",name:["address","street"],children:Object(U.jsx)(me.a,{placeholder:"ulice"})}),Object(U.jsx)(de.a.Item,{label:"PS\u010c/Obec",children:Object(U.jsxs)(me.a.Group,{compact:!0,children:[Object(U.jsx)(de.a.Item,{style:{marginBottom:0,width:"50%"},name:["address","psc"],children:Object(U.jsx)(me.a,{placeholder:"PS\u010c"})}),Object(U.jsx)(de.a.Item,{style:{marginBottom:0,width:"50%"},name:["address","municipality"],children:Object(U.jsx)(me.a,{placeholder:"Obec"})})]})}),Object(U.jsx)(de.a.Item,{label:"Ob\u010danstv\xed",children:Object(U.jsxs)(me.a.Group,{compact:!0,children:[Object(U.jsx)(de.a.Item,{style:{width:"50%"},name:["citizenship","selected"],children:Object(U.jsxs)(Oe.a,{style:{width:"100%"},placeholder:"ze seznamu",children:[Object(U.jsx)(Oe.a.Option,{value:"cze",children:"CZE"}),Object(U.jsx)(Oe.a.Option,{value:"sk",children:"SK"})]})}),Object(U.jsx)(de.a.Item,{style:{width:"50%"},name:["citizenship","new"],children:Object(U.jsx)(me.a,{placeholder:"ru\u010dn\u011b"})})]})})]})})},Ce=(n(465),n(537)),Ne=n(276),ze={colors:["#f5222d","#fa541c","#fa8c16","#faad14","#fadb14","#a0d911","#52c41a","#13c2c2","#1890ff","#2f54eb","#722ed1","#eb2f96"],getRandomColor:function(){return ze.colors[Math.floor(Math.random()*ze.colors.length)]}},De=function(e){var t=e.deleteGuest,n=e.guest,a=e.loading,r=e.openGuestDrawer,i=e.selectGuest;return Object(U.jsx)(re.b.Item,{actions:[Object(U.jsx)(ie.a,{onClick:function(){i(n),r()},type:"link",children:"upravit"},"edit"),Object(U.jsx)(be.a,{cancelText:"Ne",icon:Object(U.jsx)(Ce.a,{}),okText:"Ano",onConfirm:function(){return t(n.id)},title:"opravdu odstranit?",children:Object(U.jsx)(ie.a,{loading:a,type:"link",children:"odstranit"},"remove")})],children:Object(U.jsx)(re.b.Item.Meta,{avatar:Object(U.jsx)(Ne.a,{gap:4,size:"large",style:{backgroundColor:ze.getRandomColor()},children:n.name.substring(0,1).toUpperCase()}),description:n.email,title:"".concat(n.name," ").concat(n.surname)})})},Fe=Object(M.f)((function(e){var t=e.history,n=e.isAuthenticated,a=Object(G.useState)(!1),r=Object(S.a)(a,2),i=r[0],s=r[1],c=Object(G.useState)([]),o=Object(S.a)(c,2),l=o[0],u=o[1],d=Object(G.useState)(null),j=Object(S.a)(d,2),b=j[0],m=j[1],O=Object(le.a)(ue,{onError:function(){te.b.error("Chyba serveru, kontaktujte spr\xe1vce")}}),h=Object(S.a)(O,2),v=h[0],p=h[1],f=p.loading,x=p.data,g=p.refetch,y=Object(W.a)(Ie,{onError:function(){te.b.error("Chyba serveru, kontaktujte spr\xe1vce")}}),I=Object(S.a)(y,2),k=I[0],C=I[1],N=C.loading,z=C.data;return Object(G.useEffect)((function(){!0===n?v():t.push("/login?next=/guests")}),[v,t,n]),Object(G.useEffect)((function(){var e,t=[];null===x||void 0===x||null===(e=x.guests)||void 0===e||e.forEach((function(e){null!==e&&t.push(e)})),u(t)}),[x]),Object(G.useEffect)((function(){void 0!==g&&g()}),[g,z]),Object(U.jsxs)(E.a,{children:[Object(U.jsx)(E.a.Header,{children:Object(U.jsx)(ce.a,{level:3,className:"home__listings-title",children:"Host\xe9"})}),Object(U.jsxs)(E.a.Content,{className:"app-content",children:[Object(U.jsx)(re.b,{bordered:!0,className:"guests-list",dataSource:l,footer:Object(U.jsx)(ie.a,{icon:Object(U.jsx)(oe.a,{}),onClick:function(){m(null),s(!0)},type:"primary",children:"P\u0159idat hosta"}),header:Object(U.jsx)("h4",{children:"Seznam host\u016f"}),itemLayout:"horizontal",loading:f,renderItem:function(e){return Object(U.jsx)(De,{deleteGuest:function(e){return k({variables:{guestId:e}})},guest:e,loading:N,openGuestDrawer:function(){return s(!0)},selectGuest:m})}}),Object(U.jsx)(ke,{close:function(){return s(!1)},guest:b,refetch:g,visible:i})]})]})})),Re=n(520),Se=Object(Q.a)(d||(d=Object(Y.a)(["\n  query Whoami {\n    whoami {\n      username\n    }\n  }\n"]))),Ae=(n(466),{labelCol:{lg:8,md:8,sm:8},wrapperCol:{lg:16,md:16,sm:16}}),Ee={wrapperCol:{lg:{offset:8,span:16},xs:{offset:0,span:24}}},qe=Object(M.f)((function(e){var t=e.history,n=e.isAuthenticated,a=e.location,r=e.setIsAuthenticated,i=Object(G.useState)("Na\u010d\xedt\xe1m..."),s=Object(S.a)(i,2),c=s[0],o=s[1],l=Object(G.useState)("/"),u=Object(S.a)(l,2),d=u[0],j=u[1];Object(G.useEffect)((function(){var e=a.search.substring(1).split("=");e.length>=2&&void 0!==e[1]&&j(e[1])}),[a]);var b=Object(W.a)(X,{onCompleted:function(e){null!==e.tokenAuth&&(r(!0),t.push(d))},onError:function(e){console.error(e),te.b.error("Nespr\xe1vn\xe9 p\u0159ihla\u0161ovac\xed \xfadaje")}}),m=Object(S.a)(b,2),O=m[0],h=m[1].loading,v=Object(Re.a)(Se,{onCompleted:function(e){null!==e.whoami&&(r(!0),t.push(d))},onError:function(e){console.error(e)}}),p=v.loading,f=v.refetch;Object(G.useEffect)((function(){!1===n&&f()}),[n,f]);var g=de.a.useForm(),y=Object(S.a)(g,1)[0];return Object(U.jsxs)(E.a,{children:[Object(U.jsx)(E.a.Header,{children:Object(U.jsx)(ce.a,{level:3,className:"home__listings-title",children:"P\u0159ihl\xe1\u0161en\xed"})}),Object(U.jsx)(E.a.Content,{children:Object(U.jsx)(Z.a,{spinning:p||h,tip:c,children:Object(U.jsxs)(de.a,Object(x.a)(Object(x.a)({},Ae),{},{className:"login",form:y,name:"login",onFinish:function(e){o("P\u0159ihla\u0161ov\xe1n\xed..."),O({variables:{password:e.password.trim(),username:e.username.trim()}})},children:[Object(U.jsx)(de.a.Item,{label:"Jm\xe9no",name:"username",rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{type:"text",placeholder:"u\u017eivatelsk\xe9 jm\xe9no"})}),Object(U.jsx)(de.a.Item,{label:"Heslo",name:"password",rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{type:"password",placeholder:"heslo"})}),Object(U.jsxs)(de.a.Item,Object(x.a)(Object(x.a)({},Ee),{},{children:[Object(U.jsx)(ie.a,{type:"default",htmlType:"button",onClick:function(){return y.resetFields()},children:"Reset"}),Object(U.jsx)(ie.a,{type:"primary",htmlType:"submit",children:"P\u0159ihl\xe1sit"})]}))]}))})})]})})),Te=n(529),we=Object(M.f)((function(e){var t=e.history;return Object(U.jsx)(E.a,{children:Object(U.jsx)(E.a.Content,{children:Object(U.jsx)(Te.a,{status:"404",title:"Jejda!",subTitle:"hled\xe1me va\u0161\xed str\xe1nku... ale nem\u016f\u017eeme ji naj\xedt...",extra:Object(U.jsx)(ie.a,{onClick:function(){return t.push("/")},type:"primary",children:"P\u0159ej\xedt na \xfavod"})})})})})),Ge=n(271),Pe=n.n(Ge),Me=n(105),He=n.n(Me),$e=n(267),_e=n(128),Be=(n(496),n(497),function(e){switch(e){case"NONBINDING":return"Nez\xe1vazn\xe1 Rezervace";case"ACCOMMODATED":return"Aktu\xe1ln\u011b Ubytov\xe1n\xed";case"INHABITED":return"Obydlen\xfd Term\xedn";case"BINDING":default:return"Z\xe1vazn\xe1 Rezervace"}}),Ve=function(e){var t=e.close,n=e.open,a=e.refetch,r=de.a.useForm(),i=Object(S.a)(r,1)[0],s=Object(G.useState)(!1),c=Object(S.a)(s,2),o=c[0],l=c[1],u=Object(W.a)(ge,{onCompleted:function(e){var n,r,i,s;te.b.success("Host ".concat(null===(n=e.createGuest)||void 0===n||null===(r=n.guest)||void 0===r?void 0:r.name," ").concat(null===(i=e.createGuest)||void 0===i||null===(s=i.guest)||void 0===s?void 0:s.surname," byl p\u0159id\xe1n")),void 0!==a&&a(),t()},onError:function(e){te.b.error(e.message)}}),d=Object(S.a)(u,1)[0];return Object(U.jsx)(je.a,{closeIcon:Object(U.jsx)(be.a,{onCancel:function(){return l(!1)},onConfirm:function(){l(!1),i.resetFields(),t()},placement:"rightTop",title:"Zav\u0159\xedt formul\xe1\u0159? Data ve formul\xe1\u0159i budou ztracena",visible:o,children:Object(U.jsx)(ve.a,{onClick:function(){i.isFieldsTouched()?l(!0):t()}})}),footer:Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(ie.a,{onClick:function(){i.validateFields().then((function(){var e=i.getFieldsValue(!0),t={email:e.email,name:e.name,surname:e.surname};d({variables:{data:t}})})).catch((function(){return console.error("Formul\xe1\u0159 nelze odeslat")}))},type:"primary",children:"Vytvo\u0159it"})}),footerStyle:{textAlign:"right"},placement:"left",title:"Nov\xfd host",visible:n,width:500,children:Object(U.jsxs)(de.a,{form:i,layout:"vertical",name:"guest",children:[Object(U.jsx)(ce.a,{level:5,children:"Osobn\xed \xfadaje"}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"Jm\xe9no",name:"name",required:!0,rules:fe.requiredAlphaRules,children:Object(U.jsx)(me.a,{placeholder:"Va\u0161e Jm\xe9no"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"P\u0159\xedjmen\xed",name:"surname",required:!0,rules:fe.requiredAlphaRules,children:Object(U.jsx)(me.a,{placeholder:"Va\u0161e P\u0159\xedjmen\xed"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"E-Mail",name:"email",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{addonBefore:Object(U.jsx)(de.a.Item,{name:"email-prefix",noStyle:!0,children:Object(U.jsx)(he.a,{})}),placeholder:"e-mail",type:"email"})})]})})},Je=Object(Q.a)(j||(j=Object(Y.a)(["\n  query Suites {\n    suites {\n      id\n      title\n      number\n    }\n  }\n"]))),Ue=Object(Q.a)(b||(b=Object(Y.a)(["\n  query SuitesWithReservations {\n    guests {\n      id\n      name\n      surname\n    }\n    suites {\n      id\n      number\n      title\n    }\n    reservations {\n      fromDate\n      id\n      guest {\n        id\n        name\n        surname\n      }\n      meal\n      notes\n      purpose\n      roommates {\n        id\n        name\n        surname\n      }\n      suite {\n        id\n      }\n      toDate\n      type\n    }\n  }\n"]))),Le=n(278),Ze=n(523),Ke=n(521),We=n(538),Ye=n(180),Qe=n(535),Xe=n(534),et=n(532),tt=(n(498),{mealOptions:[{label:"Bez Stravy",value:"NOMEAL"},{label:"Jen Sn\xeddan\u011b",value:"BREAKFAST"},{label:"Polopenze",value:"HALFBOARD"}],reservationOptions:[{label:Be("BINDING"),value:"BINDING"},{label:Be("NONBINDING"),value:"NONBINDING"},{label:Be("ACCOMMODATED"),value:"ACCOMMODATED"},{label:Be("INHABITED"),value:"INHABITED"}],getRequiredRule:function(e){return{required:!0,message:e}},guestValidators:function(e){return[{message:"host nem\u016f\u017ee b\xfdt stejn\xfd jako spolubydl\xedc\xed",validator:function(t,n){var a=e.getFieldValue("roommates");if(void 0===a||0===a.length)return Promise.resolve();var r=a.filter((function(e){return void 0!==e&&e.id===n}));return void 0===r||0===r.length?Promise.resolve():Promise.reject(new Error("Fail guest validation, equals to roommate"))}},{message:"vyberte hosta",required:!0}]},roommateValidators:function(e){return[{message:"spolubydl\xedc\xed je ji\u017e vybr\xe1n",validator:function(t,n){var a=e.getFieldValue("roommates").filter((function(e){return void 0!==e&&e.id===n}));return void 0===a||a.length<=1?Promise.resolve():Promise.reject(new Error("Fail roommate validation, duplicate value"))}},{message:"spolubydl\xedc\xed nem\u016f\u017ee b\xfdt stejn\xfd jako host",validator:function(t,n){return e.getFieldValue("guest")!==n?Promise.resolve():Promise.reject(new Error("Fail roommate validation, equals to guest"))}}]}}),nt=Object(Q.a)(m||(m=Object(Y.a)(["\n  mutation CreateReservation($data: ReservationInput!) {\n    createReservation(data: $data) {\n      reservation {\n        id\n      }\n    }\n  }\n"]))),at=Object(Q.a)(O||(O=Object(Y.a)(["\n  mutation DeleteReservation($reservationId: ID!) {\n    deleteReservation(reservationId: $reservationId) {\n      reservation {\n        id\n      }\n    }\n  }\n"]))),rt=Object(Q.a)(h||(h=Object(Y.a)(["\n  mutation UpdateReservation($data: ReservationInput!) {\n    updateReservation(data: $data) {\n      reservation {\n        id\n      }\n    }\n  }\n"]))),it="YYYY-MM-DD HH:mm",st=["key","name","fieldKey"],ct=function(e){var t=e.close,n=e.guests,a=e.isOpen,r=e.openGuestDrawer,i=e.refetch,s=e.reservation,c=Object(W.a)(nt,{onCompleted:function(){te.b.success("Rezervace byla vytvo\u0159ena!"),void 0!==i&&i(),t()},onError:function(e){te.b.error(e.message)}}),o=Object(S.a)(c,1)[0],l=Object(W.a)(rt,{onCompleted:function(){te.b.success("Rezervace byla aktualizov\xe1na!"),void 0!==i&&i(),t()},onError:function(e){te.b.error(e.message)}}),u=Object(S.a)(l,1)[0],d=Object(W.a)(at,{onCompleted:function(){te.b.success("Rezervace byla odstran\u011bna!"),void 0!==i&&i(),t()},onError:function(e){te.b.error(e)}}),j=Object(S.a)(d,1)[0],b=Object(G.useState)(!1),m=Object(S.a)(b,2),O=m[0],h=m[1],v=Object(G.useState)([]),p=Object(S.a)(v,2),f=p[0],g=p[1],y=de.a.useForm(),I=Object(S.a)(y,1)[0],k=void 0!==s?{dates:[s.fromDate,s.toDate],guest:void 0===s.guest?null:s.guest.id,meal:s.meal,notes:s.notes,purpose:s.purpose,roommates:Array.from(s.roommates,(function(e){return{id:e.id}})),type:s.type}:{type:"NONBINDING"},C=function(){h(!1),setTimeout((function(){t()}))},N=function(){var e=I.getFieldsValue(!0),t=I.getFieldValue("dates"),n=Object(S.a)(t,2),a=n[0],r=n[1],i=void 0===e.roommates?[]:Array.from(e.roommates,(function(e){return e.id})),c={fromDate:a.format(it),guest:e.guest,meal:e.meal,notes:e.notes,purpose:e.purpose,roommates:i,suite:void 0!==s?+s.suite.id:null,toDate:r.format(it),type:e.type};void 0!==s&&void 0!==s.id?u({variables:{data:Object(x.a)(Object(x.a)({},c),{},{id:String(s.id)})}}):o({variables:{data:c}})},z=[void 0!==s?Object(U.jsx)(be.a,{cancelText:"Ne",okText:"Ano",onConfirm:function(){j({variables:{reservationId:String(s.id)}})},title:"Odstranit rezervaci?",children:Object(U.jsx)(ie.a,{className:"cancel-button",danger:!0,icon:Object(U.jsx)(Ye.a,{}),children:"Odstranit"})},"remove"):null,Object(U.jsx)(ie.a,{onClick:r,children:"P\u0159idat hosta"},"guest"),Object(U.jsx)(ie.a,{icon:void 0===s?Object(U.jsx)(oe.a,{}):Object(U.jsx)(Qe.a,{}),onClick:function(){I.validateFields().then(N)},type:"primary",children:void 0!==s&&void 0!==s.id?"Upravit":"Ulo\u017eit"},"create")];return Object(G.useEffect)((function(){void 0!==n&&null!==n&&g(Array.from(n,(function(e){return{label:"".concat(e.name," ").concat(e.surname),value:e.id}})))}),[n]),Object(G.useEffect)((function(){!0===a&&I.resetFields()}),[I,a]),Object(U.jsx)(Ze.a,{closeIcon:Object(U.jsx)(be.a,{onCancel:function(){return h(!1)},onConfirm:C,title:"Zav\u0159\xedt formul\xe1\u0159? Data ve formul\xe1\u0159i budou ztracena",visible:O,children:Object(U.jsx)(ve.a,{onClick:function(){I.isFieldsTouched()?h(!0):C()}})}),footer:z,title:"Rezerva\u010dn\xed formul\xe1\u0159",visible:a,children:Object(U.jsxs)(de.a,{form:I,initialValues:k,layout:"vertical",children:[Object(U.jsx)(de.a.Item,{label:"Datum Rezervace",name:"dates",required:!0,children:Object(U.jsx)(Ke.a.RangePicker,{format:it,showTime:!0})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"Host",name:"guest",required:!0,rules:tt.guestValidators(I),children:Object(U.jsx)(Oe.a,{filterOption:function(e,t){var n,a=null===t||void 0===t||null===(n=t.label)||void 0===n?void 0:n.toString().toLowerCase().indexOf(e.toLowerCase());return void 0!==a&&a>=0},options:f,showSearch:!0})}),Object(U.jsx)(de.a.List,{name:"roommates",children:function(e,t){var n=t.add,a=t.remove;return Object(U.jsxs)(U.Fragment,{children:[e.map((function(e){var t=e.key,n=e.name,r=e.fieldKey,i=Object(Le.a)(e,st);return Object(U.jsxs)(We.b,{align:"baseline",className:"roommate-list",children:[Object(U.jsx)(de.a.Item,Object(x.a)(Object(x.a)({hasFeedback:!0},i),{},{fieldKey:[r,"first"],name:[n,"id"],rules:tt.roommateValidators(I),children:Object(U.jsx)(Oe.a,{options:f,showSearch:!0})})),Object(U.jsx)(Xe.a,{onClick:function(){a(n),I.validateFields()}})]},t)})),Object(U.jsx)(de.a.Item,{children:Object(U.jsx)(ie.a,{disabled:e.length>=f.length,type:"dashed",onClick:function(){return n()},block:!0,icon:Object(U.jsx)(et.a,{}),children:"P\u0159idat spolubydl\xedc\xedho"})})]})}}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"Typ Rezervace",name:"type",required:!0,rules:[tt.getRequiredRule("vyberte typ rezervace")],children:Object(U.jsx)(Oe.a,{options:tt.reservationOptions})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"Strava",name:"meal",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(Oe.a,{options:tt.mealOptions})}),Object(U.jsx)(de.a.Item,{label:"\xda\u010del pobytu",name:"purpose",children:Object(U.jsx)(me.a,{placeholder:"\xfa\u010del pobytu"})}),Object(U.jsx)(de.a.Item,{label:"Pozn\xe1mky",name:"notes",children:Object(U.jsx)(me.a.TextArea,{placeholder:"zadejte text",allowClear:!0})})]})})},ot=Object(M.f)((function(e){var t=e.history,n=e.isAuthenticated,a=function(e){switch(e){case"NONBINDING":return"rgb(254, 223, 3)";case"ACCOMMODATED":return"rgb(0, 133, 182)";case"INHABITED":return"rgb(254, 127, 45)";case"BINDING":default:return"rgb(0, 212, 157)"}},r=Object(le.a)(Ue,{onError:function(e){console.error(e),te.b.error("Chyba serveru, kontaktujte spr\xe1vce")}}),i=Object(S.a)(r,2),s=i[0],c=i[1],o=c.data,l=c.refetch,u=Object(G.useState)([]),d=Object(S.a)(u,2),j=d[0],b=d[1],m=Object(G.useState)(!1),O=Object(S.a)(m,2),h=O[0],v=O[1],p=Object(G.useState)([]),f=Object(S.a)(p,2),g=f[0],y=f[1],I=Object(G.useState)(!1),k=Object(S.a)(I,2),N=k[0],z=k[1],D=Object(G.useState)(),F=Object(S.a)(D,2),R=F[0],A=F[1];Object(G.useEffect)((function(){!0===n?s():t.push("/login?next=/")}),[s,t,n]),Object(G.useEffect)((function(){var e,t,n=[],r=[];null===o||void 0===o||null===(e=o.suites)||void 0===e||e.forEach((function(e){null!==e&&n.push(Object(x.a)(Object(x.a)({},e),{},{stackItems:!0}))})),null===o||void 0===o||null===(t=o.reservations)||void 0===t||t.forEach((function(e){null!==e&&r.push({color:a(e.type),end_time:C()(e.toDate),group:e.suite.id,id:e.id,itemProps:{className:"reservation-item",style:{background:a(e.type),border:"none"}},start_time:C()(e.fromDate),title:"".concat(e.guest.name," ").concat(e.guest.surname),type:Be(e.type)})})),b(n),y(r)}),[o]);return Object(U.jsxs)(E.a,{children:[Object(U.jsx)(E.a.Header,{children:Object(U.jsx)(ce.a,{level:3,className:"home__listings-title",children:"Rezervace / Obsazenost"})}),Object(U.jsxs)(E.a.Content,{className:"app-content timeline",children:[void 0!==o?Object(U.jsxs)(He.a,{canChangeGroup:!1,canMove:!1,canResize:!1,defaultTimeEnd:C()().add(12,"day"),defaultTimeStart:C()().add(-12,"day"),groupRenderer:function(e){var t=e.group;return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(ce.a,{level:5,children:t.title})})},groups:j,itemRenderer:function(e){var t=e.item,n=e.itemContext,a=e.getItemProps,r=(0,e.getResizeProps)(),i=r.left,s=r.right;return void 0!==t.itemProps?Object(U.jsxs)("div",Object(x.a)(Object(x.a)({},a(t.itemProps)),{},{children:[n.useResizeHandle?Object(U.jsx)("div",Object(x.a)({},i)):"",Object(U.jsx)($e.a,{title:t.title,content:Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{style:{color:t.color,fontWeight:700},children:t.type}),Object(U.jsxs)("div",{children:["Od: ",Object(U.jsx)("strong",{children:t.start_time.format("DD MMM HH:mm")})]}),Object(U.jsxs)("div",{children:["Do: ",Object(U.jsx)("strong",{children:t.end_time.format("DD MMM HH:mm")})]})]}),children:Object(U.jsx)("div",{className:"rct-item-content",style:{maxHeight:"".concat(n.dimensions.height)},children:Object(U.jsx)(Pe.a,{strong:!0,children:t.title})})}),n.useResizeHandle?Object(U.jsx)("div",Object(x.a)({},s)):""]})):null},items:g,lineHeight:60,onCanvasClick:function(e,t){var n=j.find((function(t){return t.id===e}));void 0!==n&&(A({fromDate:C()(t),suite:Object(x.a)({},n),roommates:[],toDate:C()(t).add(1,"day"),type:"NONBINDING"}),z(!0))},onItemClick:function(e,t,n){if(void 0!==(null===o||void 0===o?void 0:o.reservations)&&null!==o.reservations){var a=o.reservations.find((function(t){return null!==t&&t.id===String(e)}));void 0!==a&&null!==a&&(A({fromDate:C()(a.fromDate),guest:a.guest,id:+a.id,meal:a.meal,notes:a.notes,purpose:a.purpose,roommates:a.roommates,suite:a.suite,toDate:C()(a.toDate),type:a.type}),z(!0))}},children:[Object(U.jsxs)(Me.TimelineHeaders,{children:[Object(U.jsx)(Me.SidebarHeader,{children:function(e){var t=e.getRootProps;return Object(U.jsx)("div",Object(x.a)(Object(x.a)({},t()),{},{className:"side-header"}))}}),Object(U.jsx)(Me.DateHeader,{unit:"primaryHeader"}),Object(U.jsx)(Me.DateHeader,{className:"days",unit:"day"})]}),Object(U.jsx)(Me.CursorMarker,{children:function(e){var t=e.styles,n=e.date;return Object(U.jsx)("div",{style:Object(x.a)(Object(x.a)({},t),{},{backgroundColor:"rgba(136, 136, 136, 0.5)",color:"#888"}),children:Object(U.jsx)("div",{className:"rt-marker__label",children:Object(U.jsx)("div",{className:"rt-marker__content",children:C()(n).format("DD MMM HH:mm")})})})}})]}):Object(U.jsx)(_e.a,{}),Object(U.jsx)(ct,{close:function(){A(void 0),z(!1)},guests:null===o||void 0===o?void 0:o.guests,isOpen:N,openGuestDrawer:function(){return v(!0)},refetch:l,reservation:R}),Object(U.jsx)(Ve,{close:function(){return v(!1)},open:h,refetch:l})]})]})})),lt=n(528),ut=Object(Q.a)(v||(v=Object(Y.a)(["\n  mutation CreateSuite($data: SuiteInput!) {\n    createSuite(data: $data) {\n      suite {\n        id\n        number\n        title\n      }\n    }\n  }\n"]))),dt=Object(Q.a)(p||(p=Object(Y.a)(["\n  mutation UpdateSuite($data: SuiteInput!) {\n    updateSuite(data: $data) {\n      suite {\n        id\n        number\n        title\n      }\n    }\n  }\n"]))),jt=Object(Q.a)(f||(f=Object(Y.a)(["\n  mutation DeleteSuite($suiteId: ID!) {\n    deleteSuite(suiteId: $suiteId) {\n      suite {\n        id\n      }\n    }\n  }\n"]))),bt=function(e){var t=e.close,n=e.suite,a=e.refetch,r=e.visible,i=Object(W.a)(ut,{onCompleted:function(e){var n,r;te.b.success("Apartm\xe1 ".concat(null===(n=e.createSuite)||void 0===n||null===(r=n.suite)||void 0===r?void 0:r.title," byla vytvo\u0159ena")),void 0!==a&&a(),t()},onError:function(e){console.error(e)}}),s=Object(S.a)(i,1)[0],c=Object(W.a)(dt,{onCompleted:function(e){var n,r;te.b.success("Apartm\xe1 ".concat(null===(n=e.updateSuite)||void 0===n||null===(r=n.suite)||void 0===r?void 0:r.title," byla aktualizov\xe1na")),void 0!==a&&a(),t()},onError:function(e){console.error(e)}}),o=Object(S.a)(c,1)[0],l=de.a.useForm(),u=Object(S.a)(l,1)[0],d=Object(G.useState)(!1),j=Object(S.a)(d,2),b=j[0],m=j[1],O={number:null===n||void 0===n?void 0:n.number,title:null===n||void 0===n?void 0:n.title};Object(G.useEffect)((function(){!0===r&&u.resetFields()}),[u,r]);return Object(U.jsx)(je.a,{closeIcon:Object(U.jsx)(be.a,{onCancel:function(){return m(!1)},onConfirm:function(){m(!1),t()},placement:"rightTop",title:"Zav\u0159\xedt formul\xe1\u0159? Data ve formul\xe1\u0159i budou ztracena",visible:b,children:Object(U.jsx)(ve.a,{onClick:function(){u.isFieldsTouched()?m(!0):t()}})}),footer:Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(ie.a,{onClick:function(){u.validateFields().then((function(){var e=u.getFieldsValue(!0),t={data:{number:e.number,title:e.title}};void 0===n?s({variables:t}):u.isFieldsTouched()&&(t.data.id=n.id,o({variables:t}))})).catch((function(){console.error("Form validation failed")}))},type:"primary",children:"Vytvo\u0159it"})}),footerStyle:{textAlign:"right"},placement:"left",title:"Nov\xe9 apartm\xe1",visible:r,width:500,children:Object(U.jsxs)(de.a,{form:u,initialValues:O,layout:"vertical",name:"suite",children:[Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"N\xe1zev",name:"title",required:!0,rules:[pe.requiredRule],children:Object(U.jsx)(me.a,{placeholder:"n\xe1zev apartm\xe1"})}),Object(U.jsx)(de.a.Item,{hasFeedback:!0,label:"\u010c\xedslo",name:"number",required:!0,rules:[pe.requiredRule,{message:"zadejte \u010d\xedslo",pattern:/^[0-9]+$/}],children:Object(U.jsx)(me.a,{placeholder:"\u010d\xedslo apartm\xe1",type:"number"})})]})})},mt=(n(499),Object(M.f)((function(e){var t=e.history,n=e.isAuthenticated,a=Object(G.useState)(!1),r=Object(S.a)(a,2),i=r[0],s=r[1],c=Object(G.useState)(),o=Object(S.a)(c,2),l=o[0],u=o[1],d=Object(G.useState)([]),j=Object(S.a)(d,2),b=j[0],m=j[1],O=Object(le.a)(Je,{onError:function(e){console.error(e),te.b.error("Chyba serveru, kontaktujte spr\xe1vce")}}),h=Object(S.a)(O,2),v=h[0],p=h[1],f=p.loading,x=p.data,g=p.refetch,y=Object(W.a)(jt,{onError:function(e){console.error(e)}}),I=Object(S.a)(y,2),k=I[0],C=I[1],N=C.loading,z=C.data;Object(G.useEffect)((function(){!0===n?v():t.push("/login?next=/apartma")}),[v,t,n]),Object(G.useEffect)((function(){var e,t=[];null===x||void 0===x||null===(e=x.suites)||void 0===e||e.forEach((function(e){null!==e&&t.push(e)})),m(t)}),[x]),Object(G.useEffect)((function(){void 0!==g&&g()}),[g,z]);return Object(U.jsxs)(E.a,{children:[Object(U.jsx)(E.a.Header,{children:Object(U.jsx)(ce.a,{level:3,className:"home__listings-title",children:"Apartm\xe1"})}),Object(U.jsxs)(E.a.Content,{className:"app-content",children:[Object(U.jsx)(re.b,{bordered:!0,className:"suites-list",dataSource:b,footer:Object(U.jsx)(ie.a,{icon:Object(U.jsx)(oe.a,{}),onClick:function(){u(void 0),s(!0)},type:"primary",children:"P\u0159idat apartm\xe1"}),header:Object(U.jsx)("h4",{children:"Seznam apartm\xe1"}),itemLayout:"horizontal",loading:f,renderItem:function(e){return Object(U.jsx)(re.b.Item,{actions:[Object(U.jsx)(ie.a,{onClick:function(){return function(e){u(e),s(!0)}(e)},type:"link",children:"upravit"},"edit"),Object(U.jsx)(be.a,{cancelText:"Ne",icon:Object(U.jsx)(Ce.a,{}),okText:"Ano",onConfirm:function(){return function(e){k({variables:{suiteId:e.id}})}(e)},title:"opravdu odstranit?",children:Object(U.jsx)(ie.a,{loading:N,type:"link",children:"odstranit"},"remove")})],children:Object(U.jsx)(lt.a,{title:!1,loading:f,active:!0,children:Object(U.jsx)(re.b.Item.Meta,{avatar:Object(U.jsx)(Ne.a,{gap:4,size:"large",children:Object(U.jsx)(B.a,{})}),description:"\u010d\xedslo pokoje - ".concat(e.number),title:e.title})})})}}),Object(U.jsx)(bt,{close:function(){return s(!1)},refetch:g,suite:l,visible:i})]})]})}))),Ot=function(){var e=Object(G.useState)(!1),t=Object(S.a)(e,2),n=t[0],a=t[1];return Object(U.jsx)(A.a,{locale:w.a,children:Object(U.jsx)(P.a,{children:Object(U.jsxs)(E.a,{id:"app",children:[Object(U.jsx)(q.a,{offsetTop:0,className:"app__affix-header",children:Object(U.jsx)(ae,{isAuthenticated:n,setIsAuthenticated:a})}),Object(U.jsxs)(M.c,{children:[Object(U.jsx)(M.a,{exact:!0,path:"/",children:Object(U.jsx)(ot,{isAuthenticated:n})}),Object(U.jsx)(M.a,{exact:!0,path:"/apartma",children:Object(U.jsx)(mt,{isAuthenticated:n})}),Object(U.jsx)(M.a,{exact:!0,path:"/guests",children:Object(U.jsx)(Fe,{isAuthenticated:n})}),Object(U.jsx)(M.a,{exact:!0,path:"/login",children:Object(U.jsx)(qe,{isAuthenticated:n,setIsAuthenticated:a})}),Object(U.jsx)(M.a,{path:"*",children:Object(U.jsx)(we,{})})]})]})})})};C.a.locale("cs");var ht=new N.a({uri:"/api"}),vt=new z.ApolloLink((function(e,t){var n=I("JWT"),a=I("csrftoken");return e.setContext((function(e){var t=e.headers,r=void 0===t?{}:t;return{headers:Object(x.a)(Object(x.a)({},r),{},{authorization:null===n?"":"JWT ".concat(n),"X-CSRFToken":null===a?"":a})}})),t(e)})),pt=new D.a({cache:new F.a({typePolicies:{Query:{fields:{guests:{merge:!1},reservations:{merge:!1},suiteReservations:{merge:!1},suites:{merge:!1}}},Reservation:{fields:{roommates:{merge:!1}}}}}),link:Object(z.concat)(vt,ht)});y.a.render(Object(U.jsx)(R.a,{client:pt,children:Object(U.jsx)(Ot,{})}),document.getElementById("root"))}},[[504,1,2]]]);
//# sourceMappingURL=main.b7da4c35.chunk.js.map