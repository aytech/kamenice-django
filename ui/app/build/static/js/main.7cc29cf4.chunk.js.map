{"version":3,"sources":["lib/Types.ts","lib/Cookie.ts","sections/App/components/Header/assets/mill.svg","lib/components/Colors.ts","lib/components/UrlHelper.ts","lib/Constants.ts","lib/graphql/mutations/Token/index.ts","sections/App/components/Header/components/MenuItems/index.tsx","sections/App/components/Header/index.tsx","sections/NotFound/index.tsx","sections/Reservations/components/ReservationItem/index.tsx","lib/components/ReservationFormHelper.ts","lib/components/FormHelper.ts","lib/components/GuestFormHelper.ts","lib/graphql/mutations/Guest/index.ts","sections/GuestDrawer/index.tsx","lib/graphql/queries/Guests/index.ts","lib/graphql/mutations/Reservation/index.ts","lib/Prices.ts","sections/Reservations/components/ReservationModal/index.tsx","lib/graphql/queries/Suites/index.ts","sections/Reservations/index.tsx","sections/Guests/components/GuestItem.tsx","sections/Guests/index.tsx","lib/graphql/mutations/Suite/index.ts","sections/Suites/components/SuiteDrawer/components/RoomActions/index.tsx","sections/Suites/components/SuiteDrawer/index.tsx","sections/Suites/components/AddSuite/index.tsx","sections/Suites/components/SuiteItem/index.tsx","sections/Suites/index.tsx","sections/Login/index.tsx","lib/graphql/queries/ReservationGuests/index.ts","lib/graphql/mutations/Contact/index.ts","sections/ReservationGuests/components/Error/index.tsx","sections/ReservationGuests/components/Host/index.tsx","lib/graphql/mutations/ReservationGuest/index.ts","sections/ReservationGuests/components/ReservationGuestDrawer/index.tsx","sections/ReservationGuests/components/Roommates/index.tsx","sections/ReservationGuests/index.tsx","sections/App/components/PageTitle/index.tsx","sections/App/index.tsx","i18n.ts","index.tsx","sections/Splash/index.tsx"],"names":["GuestAge","GuestGender","getCookie","name","document","cookie","cookies","split","i","length","trim","substring","decodeURIComponent","Colors","colors","getRandomColor","Math","floor","random","getReservationColor","reservationType","UrlHelper","urlParts","window","location","search","undefined","dateFormat","errorMessages","paths","refreshTokenName","tokenName","usernameKey","TOKEN_AUTH","gql","TOKEN_REFRESH","TOKEN_REVOKE","MenuItems","withRouter","history","selectedPage","user","t","useTranslation","useMutation","revokeToken","redirectToLogin","useCallback","localStorage","removeItem","push","userAvatar","size","style","backgroundColor","username","toUpperCase","mode","className","selectedKeys","Item","icon","BookOutlined","to","IdcardOutlined","HomeOutlined","SubMenu","title","LogoutOutlined","onClick","refreshToken","getItem","variables","then","finally","Header","logoImage","src","logo","alt","NotFound","Content","status","subTitle","extra","type","ReservationItem","item","itemContext","getItemProps","getResizeProps","leftResizeProps","left","rightResizeProps","right","itemProps","useResizeHandle","content","color","fontWeight","start_time","format","end_time","maxHeight","dimensions","height","strong","Reservation","key","ReservationFormHelper","mealOptions","label","value","reservationOptions","getRequiredRule","message","required","FormHelper","requiredRule","GuestFormHelper","ageOptions","requiredAlphaRule","pattern","transform","CREATE_GUEST","UPDATE_GUEST","DELETE_GUEST","GuestDrawer","addGuest","close","guest","removeGuest","visible","Form","useForm","form","networkErrorHandler","reason","error","onError","createGuest","createLoading","loading","updateGuest","updateLoading","deleteGuest","deleteLoading","useState","confirmClose","setConfirmClose","initialValues","age","address","municipality","addressMunicipality","psc","addressPsc","street","addressStreet","citizenship","selected","email","gender","identity","phone","phoneNumber","surname","visa","visaNumber","emailPrefixIcon","noStyle","MailOutlined","useEffect","resetFields","closeIcon","onCancel","onConfirm","placement","CloseOutlined","isFieldsTouched","width","footer","cancelText","WarningOutlined","okText","guestId","id","data","success","danger","float","validateFields","formData","getFieldsValue","new","String","catch","footerStyle","padding","textAlign","active","paragraph","rows","layout","level","hasFeedback","rules","placeholder","addonBefore","options","Option","Group","compact","marginBottom","GUESTS","CREATE_RESERVATION","DELETE_RESERVATION","UPDATE_RESERVATION","Prices","municipalityFee","getDailyPricePerGuest","basePrice","mealOption","guestPrice","getDailyPricePerRoommate","calculatePrice","suite","reservationInput","accomodationPrice","priceBase","numberOfDays","toDate","endDate","moment","startDate","fromDate","ceil","duration","diff","asDays","priceAccommodation","priceMunicipality","priceTotal","ReservationModal","addOrUpdateReservation","isOpen","clearReservation","reservation","onCompleted","createReservation","deleteReservation","updateReservation","useLazyQuery","getGuests","guestsLoading","guestsData","deleteConfirmVisible","setDeleteConfirmVisible","guestDrawerOpen","setGuestDrawerOpen","guestOptions","setGuestOptions","additionalInfoVisible","setAdditionalInfoVisible","pricesVisible","setPricesVisible","getGuestOption","dates","meal","notes","priceExtra","priceMeal","purpose","roommates","Array","from","roommate","getReservationInput","getFieldValue","submitForm","guestValidator","validator","_rule","Promise","resolve","duplicate","filter","reject","Error","roommateValidator","duplicates","footerButtons","reservationId","CloseCircleOutlined","PlusCircleOutlined","EditOutlined","updatePrice","setFieldsValue","guests","forEach","setTimeout","spinning","tip","labelCol","span","wrapperCol","RangePicker","onChange","showTime","filterOption","input","option","match","toString","toLowerCase","indexOf","showSearch","List","fields","add","remove","map","fieldKey","restField","align","console","log","MinusCircleOutlined","offset","disabled","block","PlusOutlined","hidden","TextArea","allowClear","EyeInvisibleOutlined","EyeOutlined","Text","concat","SUITES","SUITES_WITH_RESERVATIONS","Reservations","setPageTitle","setSelectedPage","dataLoading","setDataLoading","groups","setGroups","items","setItems","setReservation","reservationModalOpen","setReservationModalOpen","selectedSuite","setSelectedSuite","reservationsData","useQuery","getTimelineReservationItem","group","background","border","reservationList","suiteList","suites","reservations","canChangeGroup","canMove","canResize","defaultTimeEnd","defaultTimeStart","groupRenderer","itemRenderer","props","lineHeight","onCanvasClick","groupId","time","selectedGroup","find","onItemClick","itemId","timelineItem","getRootProps","unit","styles","date","existingReservations","GuestItem","openGuestDrawer","selectGuest","actions","Meta","avatar","gap","description","Guests","drawerVisible","setDrawerVisible","setGuests","selectedGuest","setSelectedGuest","guestsList","bordered","dataSource","header","itemLayout","renderItem","existingGuests","cachedGuest","CREATE_SUITE","UPDATE_SUITE","DELETE_SUITE","RoomActions","deleteSuite","SuiteDrawer","addOrUpdateSuite","clearSuite","createSuite","updateSuite","beds","numberBeds","number","price_base","price_child","priceChild","price_extra","price_infant","priceInfant","suiteId","AddSuite","hasAccess","onAdd","SuiteItem","openSuite","Suites","activeSuite","setActiveSuite","setSuites","setHasAccess","suitesData","suitesList","cachedSuite","lg","md","sm","tailLayout","xs","Login","token","tokenAuth","setItem","payload","getToken","loginLoading","onFinish","password","htmlType","RESERVATION_GUESTS","CONTACT_MESSAGE","show","createContactMessage","creatingMessage","Host","openDrawer","UPDATE_RESERVATON_GUEST","ReservationGuestDrawer","reservationHash","hash","updateReservationGuest","Roommates","ReservationGuests","useParams","setGuest","setRoommates","showError","setShowError","roommateList","reservationGuests","reservationGuest","PageTitle","borderBottom","paddingBottom","App","pageTitle","offsetTop","getUser","exact","path","i18next","use","Backend","initReactI18next","init","fallbackLng","debug","lng","apolloClient","Splash","locale","httpLink","HttpLink","uri","authMiddleware","ApolloLink","operation","forward","csrftoken","setContext","headers","errorLink","graphQLErrors","networkError","fromPromise","mutate","mutation","flatMap","authToken","exp","refreshExpiresIn","replace","ApolloClient","cache","InMemoryCache","typePolicies","Query","merge","suiteReservations","link","ReactDOM","render","fallback","ApolloProvider","client","csCZ","getElementById"],"mappings":"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","file":"static/js/main.7cc29cf4.chunk.js","sourcesContent":["import { Moment } from \"moment\"\n\nexport type AppReferrer = \"/\" | \"/apartma\" | \"/guests\"\nexport type ReservationType = \"Závazná Rezervace\" | \"Nezávazná Rezervace\" | \"Aktuálně Ubytování\" | \"Obydlený Termín\"\nexport type ReservationTypeKey = \"BINDING\" | \"NONBINDING\" | \"ACCOMMODATED\" | \"INHABITED\"\nexport type MenuItemKey = \"reservation\" | \"guests\" | \"suites\" | \"user\"\n\nexport const Reservation = {\n  getType: (key: ReservationTypeKey): ReservationType => {\n    switch (key) {\n      case \"NONBINDING\":\n        return \"Nezávazná Rezervace\"\n      case \"ACCOMMODATED\":\n        return \"Aktuálně Ubytování\"\n      case \"INHABITED\":\n        return \"Obydlený Termín\"\n      case \"BINDING\":\n      default: return \"Závazná Rezervace\"\n    }\n  }\n}\n\nexport type ReservationMeal = \"BREAKFAST\" | \"HALFBOARD\" | \"NOMEAL\"\nexport type GuestsAge = \"ADULT\" | \"CHILD\" | \"INFANT\" | \"YOUNG\"\n\ninterface Address {\n  municipality?: string\n  psc?: number\n  street?: string\n}\n\ninterface Citizenship {\n  new?: string\n  selected?: string\n}\n\nexport interface GuestForm {\n  age: string,\n  address?: Address\n  citizenship?: Citizenship\n  email: string\n  gender?: string\n  id?: number\n  name: string\n  identity: string\n  phone: string\n  surname: string\n  visa?: string\n}\n\nexport interface Guest {\n  id?: number | string\n  name: string\n  surname: string\n}\n\nexport interface Suite {\n  id: number | string\n  number?: number | null\n  title?: string\n}\n\nexport interface Roommate extends Guest {\n  age: string | null\n}\n\nexport interface IReservation {\n  fromDate: Moment\n  guest?: Guest\n  meal?: ReservationMeal\n  id?: number | string\n  notes?: string | null\n  priceAccommodation: string | null\n  priceExtra: string | null\n  priceMeal: string | null\n  priceMunicipality: string | null\n  priceTotal: string | null\n  purpose?: string | null\n  roommates: Array<Roommate>\n  suite: Suite\n  toDate: Moment\n  type?: ReservationTypeKey\n}\n\nexport interface SuiteForm {\n  beds: number\n  number: number\n  price_base: number\n  price_child: number\n  price_extra: number\n  price_infant: number\n  title: string\n}\n\nexport interface OptionsType {\n  label: string\n  value: string | number\n}\n\nexport interface CustomGroupFields {\n  number: number | null\n  title: string\n}\n\nexport interface CustomItemFields {\n  color?: string\n  guest: Guest\n  meal: ReservationMeal\n  notes: string | null\n  priceAccommodation: string | null\n  priceExtra: string | null\n  priceMeal: string | null\n  priceMunicipality: string | null\n  priceTotal: string | null\n  purpose: string | null\n  roommates: Roommate[]\n  suite: Suite\n  type?: ReservationTypeKey\n}\n\nexport enum GuestAge {\n  ADULT = \"ADULT\",\n  CHILD = \"CHILD\",\n  INFANT = \"INFANT\",\n  YOUNG = \"YOUNG\",\n}\n\nexport enum GuestGender {\n  F = \"F\",\n  M = \"M\",\n}\n\nexport interface ReservationGuest {\n  __typename?: string;\n  age?: GuestAge | null;\n  addressMunicipality?: string | null;\n  addressPsc?: number | null;\n  addressStreet?: string | null;\n  citizenship?: string | null;\n  email?: string;\n  gender?: GuestGender | null;\n  identity?: string | null;\n  id?: number | string;\n  name: string;\n  phoneNumber?: string | null;\n  surname?: string;\n  visaNumber?: string | null;\n}\n\nexport interface User {\n  username: string\n}\n\nexport interface PriceInfo {\n  priceAccommodation?: number\n  meal?: number\n  municipality?: number\n  total?: number\n}","export const getCookie = (name: string): string | null => {\r\n  if (document.cookie && document.cookie !== '') {\r\n    const cookies = document.cookie.split(';');\r\n    for (let i = 0; i < cookies.length; i++) {\r\n      const cookie = cookies[ i ].trim();\r\n      // Does this cookie string begin with the name we want?\r\n      if (cookie.substring(0, name.length + 1) === (name + '=')) {\r\n        return decodeURIComponent(cookie.substring(name.length + 1));\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport const setCookie = (name: string, value: string): void => {\r\n  if (document.cookie && document.cookie !== '') {\r\n    document.cookie = `${ name }=${ value };path=/`\r\n  }\r\n}\r\n\r\nexport const deleteCookie = (name: string): void => {\r\n  const cookie = getCookie(name)\r\n  if (cookie !== null) {\r\n    setCookie(name, `${ cookie };expires=Thu, 01 Jan 1970 00:00:01 GMT`)\r\n  }\r\n}","export default __webpack_public_path__ + \"static/media/mill.1f872c17.svg\";","import { ReservationTypeKey } from \"../Types\"\r\n\r\ninterface Props {\r\n  colors: string[]\r\n  getRandomColor: () => string\r\n  getReservationColor: (reservationType: ReservationTypeKey) => string\r\n}\r\n\r\nexport const Colors: Props = {\r\n  colors: [\r\n    \"#f5222d\", // red\r\n    \"#fa541c\", // volcano\r\n    \"#fa8c16\", // orange\r\n    \"#faad14\", // gold\r\n    \"#fadb14\", // yellow\r\n    \"#a0d911\", // lime\r\n    \"#52c41a\", // green\r\n    \"#13c2c2\", // cyan\r\n    \"#1890ff\", // blue\r\n    \"#2f54eb\", // geekblue\r\n    \"#722ed1\", // purple\r\n    \"#eb2f96\", // magenta\r\n  ],\r\n  getRandomColor: () => {\r\n    return Colors.colors[ Math.floor(Math.random() * Colors.colors.length) ]\r\n  },\r\n  getReservationColor: (reservationType: ReservationTypeKey): string => {\r\n    switch (reservationType) {\r\n      case \"NONBINDING\":\r\n        return \"rgb(254, 223, 3)\"\r\n      case \"ACCOMMODATED\":\r\n        return \"rgb(0, 133, 182)\"\r\n      case \"INHABITED\":\r\n        return \"rgb(254, 127, 45)\"\r\n      case \"BINDING\":\r\n      default: return \"rgb(0, 212, 157)\"\r\n    }\r\n  }\r\n}","import { AppReferrer } from \"../Types\";\r\n\r\ninterface IUrlHelper {\r\n  getReferrer: () => AppReferrer\r\n}\r\n\r\nexport const UrlHelper: IUrlHelper = {\r\n  getReferrer: (): AppReferrer => {\r\n    const urlParts = window.location.search.substring(1).split(\"=\")\r\n    if (urlParts.length >= 2 && urlParts[ 1 ] !== undefined) {\r\n      return urlParts[ 1 ] as AppReferrer\r\n    }\r\n    return \"/\"\r\n  }\r\n}","export const apolloErrorUnauthorized: string = \"Unauthorized\"\nexport const csrfTokenName: string = \"csrftoken\"\nexport const defaultArrivalHour: number = 14\nexport const defaultDepartureHour: number = 10\nexport const dateFormat = \"YYYY-MM-DD HH:mm\"\nexport const errorMessages = {\n  invalidCredentials: \"Please enter valid credentials\",\n  refreshTokenExpired: \"Refresh token is expired\",\n  signatureExpired: \"Signature has expired\",\n  unauthorized: \"Unauthorized\"\n}\nexport const paths = {\n  guests: \"/guests\",\n  login: \"/login\",\n  reservation_guests: \"/rezervace/:hash/hoste\",\n  root: \"/\",\n  suites: \"/apartma\"\n}\nexport const refreshTokenName: string = \"refreshToken\"\nexport const tokenName: string = \"token\"\nexport const usernameKey: string = \"username\"","import { gql } from \"@apollo/client\";\r\n\r\nexport const TOKEN_AUTH = gql`\r\n  mutation TokenAuth($username: String!, $password: String!) {\r\n    tokenAuth(username: $username, password: $password) {\r\n      payload\r\n      refreshExpiresIn\r\n      refreshToken\r\n      token\r\n    }\r\n  }\r\n`\r\n\r\nexport const TOKEN_REFRESH = gql`\r\n  mutation RefreshToken($refreshToken: String!) {\r\n    refreshToken(refreshToken: $refreshToken) {\r\n      payload\r\n      refreshExpiresIn\r\n      refreshToken\r\n      token\r\n    }\r\n  }\r\n`\r\n\r\nexport const TOKEN_REVOKE = gql`\r\n  mutation RevokeToken($refreshToken: String!) {\r\n    revokeToken(refreshToken: $refreshToken) {\r\n      revoked\r\n    }\r\n  }\r\n`","import { BookOutlined, HomeOutlined, IdcardOutlined, LogoutOutlined } from \"@ant-design/icons\"\r\nimport { useMutation } from \"@apollo/client\"\r\nimport { Avatar, Menu } from \"antd\"\r\nimport { useCallback } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { Link, RouteComponentProps, withRouter } from \"react-router-dom\"\r\nimport { Colors } from \"../../../../../../lib/components/Colors\"\r\nimport { UrlHelper } from \"../../../../../../lib/components/UrlHelper\"\r\nimport { refreshTokenName, tokenName, usernameKey } from \"../../../../../../lib/Constants\"\r\nimport { TOKEN_REVOKE } from \"../../../../../../lib/graphql/mutations/Token\"\r\nimport { RevokeToken, RevokeTokenVariables } from \"../../../../../../lib/graphql/mutations/Token/__generated__/RevokeToken\"\r\nimport { MenuItemKey, User } from \"../../../../../../lib/Types\"\r\nimport \"./styles.css\"\r\n\r\ninterface Props {\r\n  selectedPage: MenuItemKey\r\n  user: User | null\r\n}\r\n\r\nexport const MenuItems = withRouter(({\r\n  history,\r\n  selectedPage,\r\n  user\r\n}: RouteComponentProps & Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ revokeToken ] = useMutation<RevokeToken, RevokeTokenVariables>(TOKEN_REVOKE)\r\n\r\n  const redirectToLogin = useCallback(() => {\r\n    localStorage.removeItem(usernameKey)\r\n    history.push(`/login?next=${ UrlHelper.getReferrer() }`)\r\n  }, [ history ])\r\n\r\n  const logout = (): void => {\r\n    const refreshToken = localStorage.getItem(refreshTokenName)\r\n    if (refreshToken !== null) {\r\n      revokeToken({ variables: { refreshToken } })\r\n        .then(() => {\r\n          localStorage.removeItem(tokenName)\r\n          localStorage.removeItem(refreshTokenName)\r\n        })\r\n        .finally(() => redirectToLogin())\r\n    } else {\r\n      redirectToLogin()\r\n    }\r\n  }\r\n\r\n  const userAvatar = user !== null ? (\r\n    <Avatar\r\n      size={ 32 }\r\n      style={ {\r\n        backgroundColor: Colors.getRandomColor()\r\n      } }>\r\n      { user.username.substring(0, 1).toUpperCase() }\r\n    </Avatar>\r\n  ) : null\r\n\r\n  return user !== null ? (\r\n    <>\r\n      <Menu\r\n        mode=\"horizontal\"\r\n        className=\"navigation-items\"\r\n        selectedKeys={ [ selectedPage ] }>\r\n        <Menu.Item key=\"reservation\" icon={ <BookOutlined /> }>\r\n          <Link to=\"/\">{ t(\"reservations.name\") }</Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"guests\" icon={ <IdcardOutlined /> }>\r\n          <Link to=\"/guests\">{ t(\"guests.name-pl\") }</Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"suites\" icon={ <HomeOutlined /> }>\r\n          <Link to=\"/apartma\">{ t(\"living-units\") }</Link>\r\n        </Menu.Item>\r\n      </Menu >\r\n      <Menu\r\n        className=\"user\"\r\n        mode=\"horizontal\"\r\n        selectedKeys={ [ selectedPage ] }>\r\n        <Menu.SubMenu\r\n          key=\"user\"\r\n          title={ userAvatar }>\r\n          <Menu.Item\r\n            key=\"logout\"\r\n            icon={ <LogoutOutlined /> }\r\n            onClick={ logout }>\r\n            { t(\"logout\") }\r\n          </Menu.Item>\r\n        </Menu.SubMenu>\r\n      </Menu>\r\n    </>\r\n  ) : null\r\n})","import { Link } from 'react-router-dom'\nimport './styles.css'\nimport logo from './assets/mill.svg'\nimport { MenuItems } from './components/MenuItems'\nimport { PageHeader } from 'antd'\nimport { MenuItemKey, User } from '../../../../lib/Types'\n\ninterface Props {\n  selectedPage: MenuItemKey\n  user: User | null\n}\n\nexport const Header = ({\n  selectedPage,\n  user\n}: Props) => {\n\n  const logoImage = (\n    <img\n      className=\"logo\"\n      src={ logo }\n      alt=\"Kamenice logo\" />\n  )\n\n  const homeLink = () => {\n    return user !== null ? (\n      <Link to=\"/\">{ logoImage }</Link>\n    ) : logoImage\n  }\n\n  return (\n    <PageHeader>\n      { homeLink() }\n      <MenuItems\n        selectedPage={ selectedPage }\n        user={ user } />\n    </PageHeader>\n  )\n}","import { Button, Layout, Result } from \"antd\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\r\n\r\nexport const NotFound = withRouter(({ history }: RouteComponentProps) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return (\r\n    <Layout>\r\n      <Layout.Content>\r\n        <Result\r\n          status=\"404\"\r\n          title={ t(\"errors.oops\") }\r\n          subTitle={ t(\"errors.404\") }\r\n          extra={\r\n            <Button\r\n              onClick={ () => history.push(\"/\") }\r\n              type=\"primary\">\r\n              { t(\"go-home\") }\r\n            </Button>\r\n          } />\r\n      </Layout.Content>\r\n    </Layout>\r\n  )\r\n})","import { Popover } from \"antd\"\r\nimport { Moment } from \"moment\"\r\nimport { ReactCalendarItemRendererProps, TimelineItem } from \"react-calendar-timeline\"\r\nimport Text from \"antd/lib/typography/Text\"\r\nimport { CustomItemFields } from \"../../../../lib/Types\"\r\nimport { useTranslation } from \"react-i18next\"\r\n\r\nexport const ReservationItem = ({\r\n  item,\r\n  itemContext,\r\n  getItemProps,\r\n  getResizeProps\r\n}: ReactCalendarItemRendererProps<TimelineItem<CustomItemFields, Moment>>) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const { left: leftResizeProps, right: rightResizeProps } = getResizeProps()\r\n\r\n  return item.itemProps !== undefined ? (\r\n    <div { ...getItemProps(item.itemProps) }>\r\n      { itemContext.useResizeHandle ? <div { ...leftResizeProps } /> : '' }\r\n      <Popover title={ item.title } content={ (\r\n        <>\r\n          <div style={ { color: item.color, fontWeight: 700 } }>\r\n            { t(`reservation-types.${ item.type }`) }\r\n          </div>\r\n          <div>\r\n            { t(\"from\") }: <strong>{ item.start_time.format(\"DD MMM HH:mm\") }</strong>\r\n          </div>\r\n          <div>\r\n            { t(\"to\") }: <strong>{ item.end_time.format(\"DD MMM HH:mm\") }</strong>\r\n          </div>\r\n        </>\r\n      ) }>\r\n        <div\r\n          className=\"rct-item-content\"\r\n          style={ { maxHeight: `${ itemContext.dimensions.height }` } }>\r\n          <Text strong>{ item.title }</Text>\r\n        </div>\r\n      </Popover>\r\n      { itemContext.useResizeHandle ? <div { ...rightResizeProps } /> : '' }\r\n    </div>\r\n  ) : null\r\n}","import { Rule } from \"antd/lib/form\";\r\nimport { OptionsType, Reservation, ReservationTypeKey } from \"../Types\";\r\n\r\ninterface IReservationFormHelper {\r\n  getRequiredRule: (message: string) => Rule\r\n  mealOptions: OptionsType[]\r\n  reservationOptions: (OptionsType & { value: ReservationTypeKey })[]\r\n}\r\n\r\nexport const ReservationFormHelper: IReservationFormHelper = {\r\n  mealOptions: [\r\n    {\r\n      label: \"Bez Stravy\",\r\n      value: \"NOMEAL\"\r\n    },\r\n    {\r\n      label: \"Jen Snídaně\",\r\n      value: \"BREAKFAST\"\r\n    },\r\n    {\r\n      label: \"Polopenze\",\r\n      value: \"HALFBOARD\"\r\n    }\r\n  ],\r\n  reservationOptions: [\r\n    {\r\n      label: Reservation.getType(\"BINDING\"),\r\n      value: \"BINDING\"\r\n    },\r\n    {\r\n      label: Reservation.getType(\"NONBINDING\"),\r\n      value: \"NONBINDING\"\r\n    },\r\n    {\r\n      label: Reservation.getType(\"ACCOMMODATED\"),\r\n      value: \"ACCOMMODATED\"\r\n    },\r\n    {\r\n      label: Reservation.getType(\"INHABITED\"),\r\n      value: \"INHABITED\"\r\n    }\r\n  ],\r\n  getRequiredRule: (message: string): Rule => {\r\n    return { required: true, message }\r\n  }\r\n}","import { Rule } from \"antd/lib/form\"\r\n\r\ninterface IFormHelper {\r\n  requiredRule: (message: string) => Rule\r\n  trim: (value: string | undefined) => string | undefined\r\n}\r\nexport const FormHelper: IFormHelper = {\r\n  requiredRule: (message: string) => {\r\n    return {\r\n      required: true,\r\n      message: message\r\n    }\r\n  },\r\n  trim: (value: string | undefined): string | undefined => {\r\n    return value === undefined ? value : value.trim()\r\n  }\r\n}","import { Rule } from \"antd/lib/form\";\nimport { OptionsType } from \"../Types\";\nimport { FormHelper } from \"./FormHelper\";\n\ninterface IGuestFormHelper {\n  ageOptions: OptionsType[]\n  requiredAlphaRule: (message: string) => Rule\n}\n\nexport const GuestFormHelper: IGuestFormHelper = {\n  ageOptions: [\n    {\n      label: \"12+\",\n      value: \"YOUNG\"\n    },\n    {\n      label: \"3-12 let\",\n      value: \"CHILD\"\n    },\n    {\n      label: \"Do 3 let\",\n      value: \"INFANT\"\n    },\n    {\n      label: \"Dospělý\",\n      value: \"ADULT\"\n    }\n  ],\n  requiredAlphaRule: (message: string) => {\n    return {\n      message: message,\n      pattern: /^([A-Za-z\\sáÁčČďĎéÉěĚíÍňŇřŘšŠťŤúÚůŮýÝžŽóÓ])+$/,\n      transform: FormHelper.trim\n    }\n  }\n}","import { gql } from \"@apollo/client\"\n\nexport const CREATE_GUEST = gql`\n  mutation CreateGuest($data: GuestInput!) {\n    createGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n`\n\nexport const UPDATE_GUEST = gql`\n  mutation UpdateGuest($data: GuestInput!) {\n    updateGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n`\n\nexport const DELETE_GUEST = gql`\n  mutation DeleteGuest($guestId: ID!) {\n    deleteGuest(guestId: $guestId) {\n      guest {\n        id\n      }\n    }\n  }\n`","import { useState } from \"react\"\r\nimport { Button, Drawer, Form, Input, message, Popconfirm, Select, Skeleton } from \"antd\"\r\nimport { CloseOutlined, MailOutlined, WarningOutlined } from \"@ant-design/icons\"\r\nimport Title from \"antd/lib/typography/Title\"\r\nimport { Store } from \"rc-field-form/lib/interface\"\r\nimport { GuestForm } from \"../../lib/Types\"\r\nimport { GuestFormHelper } from \"../../lib/components/GuestFormHelper\"\r\nimport { FormHelper } from \"../../lib/components/FormHelper\"\r\nimport \"./styles.css\"\r\nimport { ApolloError, FetchResult, useMutation } from \"@apollo/client\"\r\nimport { CREATE_GUEST, DELETE_GUEST, UPDATE_GUEST } from \"../../lib/graphql/mutations/Guest\"\r\nimport { CreateGuest, CreateGuestVariables } from \"../../lib/graphql/mutations/Guest/__generated__/CreateGuest\"\r\nimport { GuestsFull_guests } from \"../../lib/graphql/queries/Guests/__generated__/GuestsFull\"\r\nimport { Guests_guests } from \"../../lib/graphql/queries/Guests/__generated__/Guests\"\r\nimport { UpdateGuest, UpdateGuestVariables } from \"../../lib/graphql/mutations/Guest/__generated__/UpdateGuest\"\r\nimport { useEffect } from \"react\"\r\nimport { DeleteGuest, DeleteGuestVariables } from \"../../lib/graphql/mutations/Guest/__generated__/DeleteGuest\"\r\nimport { useTranslation } from \"react-i18next\"\r\n\r\ninterface Props {\r\n  addGuest: (guest: Guests_guests) => void\r\n  close: () => void\r\n  guest?: GuestsFull_guests | null\r\n  removeGuest?: (guestId: string) => void\r\n  visible: boolean\r\n}\r\n\r\nexport const GuestDrawer = ({\r\n  addGuest,\r\n  close,\r\n  guest,\r\n  removeGuest,\r\n  visible\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const networkErrorHandler = (reason: ApolloError) => message.error(reason.message)\r\n\r\n  const [ createGuest, { loading: createLoading } ] = useMutation<CreateGuest, CreateGuestVariables>(CREATE_GUEST, {\r\n    onError: networkErrorHandler\r\n  })\r\n  const [ updateGuest, { loading: updateLoading } ] = useMutation<UpdateGuest, UpdateGuestVariables>(UPDATE_GUEST, {\r\n    onError: networkErrorHandler\r\n  })\r\n  const [ deleteGuest, { loading: deleteLoading } ] = useMutation<DeleteGuest, DeleteGuestVariables>(DELETE_GUEST, {\r\n    onError: networkErrorHandler\r\n  })\r\n\r\n  const [ confirmClose, setConfirmClose ] = useState<boolean>(false)\r\n\r\n  const initialValues: Store = {\r\n    age: guest?.age,\r\n    address: {\r\n      municipality: guest?.addressMunicipality,\r\n      psc: guest?.addressPsc,\r\n      street: guest?.addressStreet\r\n    },\r\n    citizenship: {\r\n      selected: guest?.citizenship\r\n    },\r\n    email: guest?.email,\r\n    gender: guest?.gender,\r\n    identity: guest?.identity,\r\n    name: guest?.name,\r\n    phone: guest?.phoneNumber,\r\n    surname: guest?.surname,\r\n    visa: guest?.visaNumber\r\n  }\r\n  const emailPrefixIcon = (\r\n    <Form.Item name=\"email-prefix\" noStyle>\r\n      <MailOutlined />\r\n    </Form.Item>\r\n  )\r\n\r\n  const submitForm = (): void => {\r\n    form.validateFields()\r\n      .then(() => {\r\n        const formData: GuestForm = form.getFieldsValue(true)\r\n        const variables = {\r\n          age: formData.age,\r\n          addressMunicipality: formData.address?.municipality,\r\n          addressPsc: formData.address?.psc,\r\n          addressStreet: formData.address?.street,\r\n          citizenship: formData.citizenship?.selected === undefined ? formData.citizenship?.new : formData.citizenship.selected,\r\n          email: formData.email,\r\n          gender: formData.gender,\r\n          identity: formData.identity,\r\n          name: formData.name,\r\n          phoneNumber: formData.phone,\r\n          surname: formData.surname,\r\n          visaNumber: formData.visa\r\n        }\r\n        if (guest === undefined || guest === null) {\r\n          createGuest({ variables: { data: { ...variables } } })\r\n            .then((value: FetchResult<CreateGuest>) => {\r\n              const guest = value.data?.createGuest?.guest\r\n              if (guest !== undefined && guest !== null) {\r\n                addGuest(guest)\r\n                message.success(t(\"guests.added\", { name: guest.name, surname: guest.surname }))\r\n              }\r\n              close()\r\n            })\r\n        } else {\r\n          updateGuest({ variables: { data: { id: String(guest.id), ...variables } } })\r\n            .then((value: FetchResult<UpdateGuest>) => {\r\n              const guest = value.data?.updateGuest?.guest\r\n              if (guest !== undefined && guest !== null) {\r\n                addGuest(guest)\r\n                message.success(t(\"guests.updated\", { name: guest.name, surname: guest.surname }))\r\n              }\r\n              close()\r\n            })\r\n        }\r\n      })\r\n      .catch(() => message.error(t(\"errors.invalid-form\")))\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (visible === true) {\r\n      form.resetFields()\r\n    }\r\n  }, [ form, visible ])\r\n\r\n  return (\r\n    <Drawer\r\n      closeIcon={ (\r\n        <Popconfirm\r\n          onCancel={ () => setConfirmClose(false) }\r\n          onConfirm={ () => {\r\n            setConfirmClose(false)\r\n            form.resetFields()\r\n            close()\r\n          } }\r\n          placement=\"rightTop\"\r\n          title={ t(\"forms.close-dirty\") }\r\n          visible={ confirmClose }>\r\n          <CloseOutlined onClick={ () => {\r\n            if (form.isFieldsTouched()) {\r\n              setConfirmClose(true)\r\n            } else {\r\n              close()\r\n            }\r\n          } } />\r\n        </Popconfirm>\r\n      ) }\r\n      placement=\"left\"\r\n      title={ t(\"guests.name\") }\r\n      width={ 500 }\r\n      visible={ visible }\r\n      footer={\r\n        <>\r\n          { guest !== undefined && guest !== null &&\r\n            <Popconfirm\r\n              cancelText={ t(\"no\") }\r\n              icon={ <WarningOutlined /> }\r\n              okText={ t(\"yes\") }\r\n              onConfirm={ () => {\r\n                deleteGuest({ variables: { guestId: guest.id } })\r\n                  .then((value: FetchResult<DeleteGuest>) => {\r\n                    const guest = value.data?.deleteGuest?.guest\r\n                    if (removeGuest !== undefined && guest !== undefined && guest !== null) {\r\n                      removeGuest(guest.id)\r\n                      message.success(t(\"guests.deleted\"))\r\n                      close()\r\n                    }\r\n                  })\r\n              } }\r\n              title={ t(\"forms.delete-confirm\") }>\r\n              <Button\r\n                danger\r\n                style={ {\r\n                  float: \"left\"\r\n                } }\r\n                type=\"primary\">\r\n                { t('forms.delete') }\r\n              </Button>\r\n            </Popconfirm>\r\n          }\r\n          <Button\r\n            onClick={ submitForm }\r\n            type=\"primary\">\r\n            { (guest === undefined || guest === null) ? t(\"forms.create\") : t(\"forms.update\") }\r\n          </Button>\r\n        </>\r\n      }\r\n      footerStyle={ {\r\n        padding: \"16px 20px\",\r\n        textAlign: \"right\"\r\n      } }>\r\n      <Skeleton\r\n        active\r\n        loading={ createLoading || updateLoading || deleteLoading }\r\n        paragraph={ { rows: 15 } }>\r\n        <Form\r\n          form={ form }\r\n          initialValues={ initialValues }\r\n          layout=\"vertical\"\r\n          name=\"guest\">\r\n          <Title level={ 5 }>\r\n            { t(\"forms.personal-data\") }\r\n          </Title>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"name\") }\r\n            name=\"name\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder={ t('forms.your-name') } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"surname\") }\r\n            name=\"surname\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder={ t(\"your-surname\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"email\") }\r\n            name=\"email\"\r\n            required\r\n            rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\r\n            <Input\r\n              addonBefore={ emailPrefixIcon }\r\n              placeholder={ t(\"email\") }\r\n              type=\"email\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"forms.id-number\") }\r\n            name=\"identity\">\r\n            <Input placeholder={ t(\"forms.id-number-full\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"phone-number\") }\r\n            name=\"phone\">\r\n            <Input placeholder={ t(\"number\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"age\") }\r\n            name=\"age\">\r\n            <Select\r\n              options={ GuestFormHelper.ageOptions }\r\n              placeholder={ t(\"forms.choose-from-list\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label={ t(\"sex\") }\r\n            name=\"gender\">\r\n            <Select\r\n              placeholder={ t(\"forms.choose-from-list\") }>\r\n              <Select.Option value=\"M\">{ t(\"man\") }</Select.Option>\r\n              <Select.Option value=\"F\">{ t(\"woman\") }</Select.Option>\r\n            </Select>\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"forms.visa-number\") }\r\n            name=\"visa\">\r\n            <Input placeholder={ t(\"forms.visa-number\") } />\r\n          </Form.Item>\r\n          <Title level={ 5 }>{ t(\"forms.address\") }</Title>\r\n          <Form.Item\r\n            label={ t(\"forms.street\") }\r\n            name={ [ \"address\", \"street\" ] }>\r\n            <Input placeholder={ t(\"forms.street\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label={ t(\"forms.psc-label\") }>\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"psc\" ] }>\r\n                <Input placeholder={ t(\"forms.psc\") } />\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"municipality\" ] }>\r\n                <Input placeholder={ t(\"forms.municipality\") } />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n          <Form.Item\r\n            label={ t(\"forms.citizenship\") }>\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"selected\" ] }>\r\n                <Select style={ { width: \"100%\" } } placeholder={ t(\"forms.from-list\") }>\r\n                  <Select.Option value=\"cze\">CZE</Select.Option>\r\n                  <Select.Option value=\"sk\">SK</Select.Option>\r\n                </Select>\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"new\" ] }>\r\n                <Input placeholder={ t(\"forms.by-hand\") } />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n        </Form>\r\n      </Skeleton>\r\n    </Drawer>\r\n  )\r\n}","import { gql } from \"@apollo/client\";\r\n\r\nexport const GUESTS = gql`\r\n  query Guests {\r\n    guests {\r\n      age\r\n      addressMunicipality\r\n      addressPsc\r\n      addressStreet\r\n      citizenship\r\n      email\r\n      gender\r\n      identity\r\n      id\r\n      name\r\n      phoneNumber\r\n      surname\r\n      visaNumber\r\n    }\r\n  }\r\n`","import { gql } from \"@apollo/client\";\r\n\r\nexport const CREATE_RESERVATION = gql`\r\n  mutation CreateReservation($data: ReservationInput!) {\r\n    createReservation(data: $data) {\r\n      reservation {\r\n        fromDate\r\n        id\r\n        guest {\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        meal\r\n        notes\r\n        priceAccommodation\r\n        priceExtra\r\n        priceMeal\r\n        priceMunicipality\r\n        priceTotal\r\n        purpose\r\n        roommates {\r\n          age\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        suite {\r\n          id\r\n          number\r\n          title\r\n        }\r\n        toDate\r\n        type\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const DELETE_RESERVATION = gql`\r\n  mutation DeleteReservation($reservationId: ID!) {\r\n    deleteReservation(reservationId: $reservationId) {\r\n      reservation {\r\n        id\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const UPDATE_RESERVATION = gql`\r\n  mutation UpdateReservation($data: ReservationInput!) {\r\n    updateReservation(data: $data) {\r\n      reservation {\r\n        fromDate\r\n        id\r\n        guest {\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        meal\r\n        notes\r\n        priceAccommodation\r\n        priceExtra\r\n        priceMeal\r\n        priceMunicipality\r\n        priceTotal\r\n        purpose\r\n        roommates {\r\n          age\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        suite {\r\n          id\r\n          number\r\n          title\r\n        }\r\n        toDate\r\n        type\r\n      }\r\n    }\r\n  }\r\n`","import moment from \"moment\";\r\nimport { ReservationInput } from \"./graphql/globalTypes\";\r\nimport { Suites_suites } from \"./graphql/queries/Suites/__generated__/Suites\";\r\nimport { GuestsAge, PriceInfo, ReservationMeal } from \"./Types\";\r\n\r\ninterface IPrices {\r\n  calculatePrice: (suite: Suites_suites, reservationInput: ReservationInput) => PriceInfo\r\n  getDailyPricePerGuest: (basePrice: number, mealOption?: ReservationMeal | null) => number\r\n  getDailyPricePerRoommate: (basePrice: number, age: GuestsAge, mealOption: ReservationMeal) => number\r\n  municipalityFee: number\r\n}\r\n\r\nexport const Prices: IPrices = {\r\n\r\n  municipalityFee: 21, // @TODO: make configurable\r\n\r\n  getDailyPricePerGuest: (basePrice: number, mealOption?: ReservationMeal | null) => {\r\n    let guestPrice = basePrice\r\n\r\n    const breakfastPrice: number = 80 // @TODO: make configurable\r\n    const halfBoardPrice: number = 200 // TODO: make configurable\r\n\r\n    switch (mealOption) {\r\n      case \"BREAKFAST\":\r\n        guestPrice += breakfastPrice\r\n        break\r\n      case \"HALFBOARD\":\r\n        guestPrice += halfBoardPrice\r\n        break\r\n    }\r\n\r\n    return guestPrice\r\n  },\r\n\r\n  getDailyPricePerRoommate: (basePrice: number, age: GuestsAge, mealOption: ReservationMeal) => {\r\n    let roomamatePrice = 0\r\n    return roomamatePrice\r\n  },\r\n\r\n  // calculateMealPricePerDay: (meal: ReservationMeal | undefined, guest: Guest | undefined, roommates: Roommate[]) => {\r\n  //   let mealPrice = 0\r\n  //   if (meal === undefined || guest === undefined) {\r\n  //     return mealPrice\r\n  //   }\r\n  //   switch (meal) {\r\n  //     case \"BREAKFAST\":\r\n  //       mealPrice += 80\r\n  //       break\r\n  //     case \"HALFBOARD\":\r\n  //       mealPrice += 200\r\n  //       break\r\n  //     default:\r\n  //       break\r\n  //   }\r\n  //   roommates.forEach((roommate: Roommate) => {\r\n  //     console.log(\"Roommate: \", roommate);\r\n\r\n  //   })\r\n  //   console.log(\"Meal price: \", mealPrice);\r\n\r\n  //   return mealPrice\r\n  // },\r\n  // Basic formula:\r\n  // 1. Each room has price per day\r\n  // 2. Room price can be divided per number of guests, if all guests are 12+ of age\r\n  //    - Model: 2x room apartment is 1400 Kc, for 2 adult guests the price is 700 Kc each\r\n  // 3. If one of the guests in a child or infant, price is not halved, but 10% discount is given. @TODO make that percent configurable\r\n  // 4. If the stay is longer than 3 days, 12% discount is given for the price of the room. @TODO: make percent configurable \r\n  // 5. Meal:\r\n  //    - Breakfast: 80 Kc per person per day. @TODO make the price configurable\r\n  //    - Halfboard: 200 Kc per person per day. @TODO make the price configurable\r\n  //    - No meal. Free. Children under 3 cannot have meal ordered\r\n  //    - Discount: 40% for children 3-12 years of age. @TODO make the percent configurable\r\n  // 6. Municipality fee: 21 Kc per day per person\r\n  // Questions:\r\n  // 1. Model calculation:\r\n  //    - 4x room apartment, 2x adults, 1x child/infant?\r\n  //    - 2x room apartment, 2x adults, 1child/infant, 1 extra bed?\r\n  //    - 4x room apartment, 3 adults, 1 child/infant?\r\n  //    - 4x room apartment, 1 adult, 1 child/infant?\r\n  calculatePrice: (suite: Suites_suites, reservationInput: ReservationInput) => {\r\n    let accomodationPrice: number = suite.priceBase\r\n    let numberOfDays: number = 0\r\n    let municipalityFee: number = 0\r\n\r\n    if (reservationInput.toDate !== undefined && reservationInput.toDate !== null) {\r\n      const endDate = moment(reservationInput.toDate)\r\n      const startDate = moment(reservationInput.fromDate)\r\n      numberOfDays = Math.ceil(moment.duration(endDate.diff(startDate)).asDays())\r\n    }\r\n\r\n    if (numberOfDays < 3) {\r\n      accomodationPrice = suite.priceBase * numberOfDays\r\n    } else {\r\n      accomodationPrice = (suite.priceBase * numberOfDays) - ((suite.priceBase * numberOfDays) * .12) // 12% discount. @TODO: make percent configurable\r\n    }\r\n\r\n    municipalityFee = Prices.municipalityFee * numberOfDays\r\n\r\n    // Steps:\r\n    // 1. Calculate base price for a room.\r\n    // 2. Loop through roommates, apply formula:\r\n    //    - If room capacity is 2 and \r\n    //    - Figure out the rest\r\n    // 3. Apply discount if stay is longer than 3 days\r\n    // 4. Add meal price\r\n    // 5. Add municipality fee. For children also? ask\r\n\r\n    // @TODO\r\n    // 1. Calculate price per roommate with scenarios:\r\n    //    - 2x bed room with base price 1400\r\n    //      2x adults = full price\r\n    //      1x adult + 1x child = full price - 10%\r\n    //      2x adults + 1x child = ???\r\n    //    - 4x bed room with base price 2600\r\n    //      1x adult + 1x child = ???\r\n    //      2x adults + 1 child = ???\r\n    //      2x adults + 2x child = ???\r\n    //      extra bed calculation = ???\r\n    // 2. Calculate prices permeal:\r\n    //    - Just breakfast - + 80 Kc per person\r\n    //    - Polopenze - 200 Kc per person\r\n    //    - Deti - 40% sleva\r\n\r\n    // finalPrice += (numberOfGuests * municipalityFee) * numberOfDays\r\n\r\n    return {\r\n      priceAccommodation: accomodationPrice,\r\n      priceMunicipality: municipalityFee,\r\n      priceTotal: accomodationPrice + municipalityFee\r\n    }\r\n  }\r\n}","import { useCallback, useEffect, useState } from \"react\"\nimport { Button, DatePicker, Form, Input, message, Modal, Popconfirm, Select, Space, Spin, Typography } from \"antd\"\nimport { Moment } from \"moment\"\nimport { ApolloError, useLazyQuery, useMutation } from \"@apollo/client\"\nimport { Store } from \"rc-field-form/lib/interface\"\nimport { CloseCircleOutlined, CloseOutlined, EditOutlined, EyeInvisibleOutlined, EyeOutlined, MinusCircleOutlined, PlusCircleOutlined, PlusOutlined } from \"@ant-design/icons\"\nimport \"./styles.css\"\nimport { IReservation, OptionsType, ReservationTypeKey } from \"../../../../lib/Types\"\nimport { ReservationFormHelper } from \"../../../../lib/components/ReservationFormHelper\"\nimport { FormHelper } from \"../../../../lib/components/FormHelper\"\nimport { ReservationInput } from \"../../../../lib/graphql/globalTypes\"\nimport { dateFormat } from \"../../../../lib/Constants\"\nimport { GuestDrawer } from \"../../../GuestDrawer\"\nimport { Guests, Guests_guests } from \"../../../../lib/graphql/queries/Guests/__generated__/Guests\"\nimport { GUESTS } from \"../../../../lib/graphql/queries/Guests\"\nimport { CreateReservation, CreateReservationVariables } from \"../../../../lib/graphql/mutations/Reservation/__generated__/CreateReservation\"\nimport { CREATE_RESERVATION, DELETE_RESERVATION, UPDATE_RESERVATION } from \"../../../../lib/graphql/mutations/Reservation\"\nimport { UpdateReservation, UpdateReservationVariables } from \"../../../../lib/graphql/mutations/Reservation/__generated__/UpdateReservation\"\nimport { DeleteReservation, DeleteReservationVariables } from \"../../../../lib/graphql/mutations/Reservation/__generated__/DeleteReservation\"\nimport { SuitesWithReservations_reservations } from \"../../../../lib/graphql/queries/Suites/__generated__/SuitesWithReservations\"\nimport { useTranslation } from \"react-i18next\"\nimport { Suites_suites } from \"../../../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport { Prices } from \"../../../../lib/Prices\"\n\ninterface Props {\n  addOrUpdateReservation: (reservation?: SuitesWithReservations_reservations | null) => void\n  close: () => void\n  isOpen: boolean\n  clearReservation: (reservationId?: string | null) => void\n  reservation?: IReservation\n  suite?: Suites_suites\n}\n\nexport const ReservationModal = ({\n  addOrUpdateReservation,\n  close,\n  isOpen,\n  clearReservation,\n  reservation,\n  suite\n}: Props) => {\n\n  const { t } = useTranslation()\n\n  const networkErrorHandler = (reason: ApolloError) => message.error(reason.message)\n\n  const [ createReservation, { loading: createLoading } ] = useMutation<CreateReservation, CreateReservationVariables>(CREATE_RESERVATION, {\n    onCompleted: (data: CreateReservation) => {\n      addOrUpdateReservation(data.createReservation?.reservation)\n      message.success(t(\"reservations.created\"))\n      close()\n    },\n    onError: networkErrorHandler\n  })\n  const [ deleteReservation, { loading: deleteLoading } ] = useMutation<DeleteReservation, DeleteReservationVariables>(DELETE_RESERVATION, {\n    onCompleted: (data: DeleteReservation) => {\n      clearReservation(data.deleteReservation?.reservation?.id)\n      message.success(t(\"reservations.deleted\"))\n      close()\n    },\n    onError: networkErrorHandler\n  })\n  const [ updateReservation, { loading: updateLoading } ] = useMutation<UpdateReservation, UpdateReservationVariables>(UPDATE_RESERVATION, {\n    onCompleted: (data: UpdateReservation) => {\n      addOrUpdateReservation(data.updateReservation?.reservation)\n      message.success(t(\"reservations.updated\"))\n      close()\n    },\n    onError: networkErrorHandler\n  })\n  const [ getGuests, { loading: guestsLoading, data: guestsData } ] = useLazyQuery<Guests>(GUESTS, {\n    onError: networkErrorHandler\n  })\n\n  const [ deleteConfirmVisible, setDeleteConfirmVisible ] = useState<boolean>(false)\n  const [ guestDrawerOpen, setGuestDrawerOpen ] = useState<boolean>(false)\n  const [ guestOptions, setGuestOptions ] = useState<OptionsType[]>([])\n  const [ additionalInfoVisible, setAdditionalInfoVisible ] = useState<boolean>(false)\n  const [ pricesVisible, setPricesVisible ] = useState<boolean>(false)\n\n  const [ form ] = Form.useForm()\n\n  const getGuestOption = (guest: Guests_guests) => {\n    return {\n      label: `${ guest.name } ${ guest.surname }`,\n      value: guest.id\n    }\n  }\n\n  const addGuestOption = (guest: Guests_guests) => {\n    setGuestOptions(guestOptions.concat(getGuestOption(guest)))\n  }\n\n  const initialValues: Store & { type?: ReservationTypeKey } = reservation !== undefined ? {\n    dates: [ reservation.fromDate, reservation.toDate ],\n    guest: reservation.guest === undefined ? null : reservation.guest.id,\n    meal: reservation.meal,\n    notes: reservation.notes,\n    priceAccommodation: \"0.00\", // @TODO: calculate\n    priceExtra: \"0.00\", // @TODO: calculate\n    priceMeal: \"0.00\", // @TODO: calculate\n    priceMunicipality: \"0.00\", // @TODO: calculate\n    priceTotal: reservation.priceTotal,\n    purpose: reservation.purpose,\n    roommates: Array.from(reservation.roommates, roommate => {\n      return { id: roommate.id }\n    }),\n    type: reservation.type\n  } : { type: \"NONBINDING\" }\n\n  const getReservationInput = useCallback((): ReservationInput => {\n    const formData = form.getFieldsValue(true)\n    const [ from, to ]: Array<Moment> = form.getFieldValue(\"dates\")\n    const roommates = formData.roommates === undefined ? [] :\n      Array.from(formData.roommates, (data: { id: number }) => data.id)\n    return {\n      fromDate: from.format(dateFormat),\n      guest: formData.guest,\n      meal: formData.meal,\n      notes: formData.notes,\n      priceAccommodation: formData.priceAccommodation,\n      priceExtra: formData.priceExtra,\n      priceMeal: formData.priceMeal,\n      priceMunicipality: formData.priceMunicipality,\n      priceTotal: formData.priceTotal,\n      purpose: formData.purpose,\n      roommates: roommates,\n      suite: reservation !== undefined ? +reservation.suite.id : null,\n      toDate: to.format(dateFormat),\n      type: formData.type\n    }\n  }, [ form, reservation ])\n\n  const submitForm = (): void => {\n    const variables: ReservationInput = getReservationInput()\n    if (reservation !== undefined && reservation.id !== undefined) {\n      updateReservation({ variables: { data: { id: String(reservation.id), ...variables } } })\n    } else {\n      createReservation({ variables: { data: { ...variables } } })\n    }\n  }\n\n  const guestValidator = [\n    {\n      message: t(\"forms.guest-duplicate\"),\n      validator: (_rule: any, value: number): Promise<void | Error> => {\n        const roommates: Array<{ id: number }> = form.getFieldValue(\"roommates\")\n        if (roommates === undefined || roommates.length === 0) {\n          return Promise.resolve()\n        }\n        const duplicate = roommates.filter((id: { id: number } | undefined) => {\n          return id !== undefined && id.id === value\n        })\n        if (duplicate === undefined || duplicate.length === 0) {\n          return Promise.resolve()\n        }\n        return Promise.reject(new Error(\"Fail guest validation, equals to roommate\"))\n      }\n    },\n    {\n      message: t(\"forms.choose-guest\"),\n      required: true\n    }\n  ]\n\n  const roommateValidator = [\n    {\n      message: t(\"forms.guest-selected\"),\n      validator: (_rule: any, value: number): Promise<void | Error> => {\n        const duplicates: Array<{ id: number }> = form.getFieldValue(\"roommates\").filter((id: { id: number } | undefined) => {\n          return id !== undefined && id.id === value\n        })\n        if (duplicates === undefined || duplicates.length <= 1) {\n          return Promise.resolve()\n        }\n        return Promise.reject(new Error(\"Fail roommate validation, duplicate value\"))\n      }\n    },\n    {\n      message: t(\"forms.guest-equals-roommate\"),\n      validator: (_rule: any, value: number): Promise<void | Error> => {\n        if (form.getFieldValue(\"guest\") !== value) {\n          return Promise.resolve()\n        }\n        return Promise.reject(new Error(\"Fail roommate validation, equals to guest\"))\n      }\n    }\n  ]\n\n  const getRemoveButton = () => {\n    return reservation !== undefined && reservation.id !== undefined ? (\n      <Popconfirm\n        cancelText={ t(\"no\") }\n        key=\"remove\"\n        okText={ t(\"yes\") }\n        onConfirm={ () => {\n          if (reservation.id !== undefined) {\n            deleteReservation({ variables: { reservationId: String(reservation.id) } })\n          }\n        } }\n        title={ `${ t(\"reservations.remove\") }?` }>\n        <Button\n          className=\"cancel-button\"\n          danger\n          icon={ <CloseCircleOutlined /> }>\n          { t(\"forms.delete\") }\n        </Button>\n      </Popconfirm>\n    ) : null\n  }\n\n  const footerButtons = [\n    getRemoveButton(),\n    <Button\n      key=\"guest\"\n      onClick={ () => setGuestDrawerOpen(true) }>\n      { t(\"guests.add\") }\n    </Button>,\n    <Button\n      key=\"create\"\n      icon={ reservation === undefined ? <PlusCircleOutlined /> : <EditOutlined /> }\n      onClick={ () => {\n        form.validateFields()\n          .then(submitForm)\n      } }\n      type=\"primary\">\n      { (reservation !== undefined && reservation.id !== undefined) ? t(\"forms.update\") : t(\"forms.save\") }\n    </Button>\n  ]\n\n  const updatePrice = useCallback(() => {\n    if (suite !== undefined && reservation !== undefined) {\n      form.setFieldsValue(Prices.calculatePrice(suite, getReservationInput()))\n    }\n  }, [ form, getReservationInput, reservation, suite ])\n\n  useEffect(() => {\n    // Form instance is created on page load (before modal is open),\n    // but the component is rendered only when modal is opened\n    if (isOpen === true) {\n      form.resetFields()\n      getGuests()\n    }\n  }, [ form, getGuests, isOpen, reservation ])\n\n  useEffect(() => {\n    if (guestsData !== undefined && guestsData.guests !== null) {\n      const options: OptionsType[] = []\n      guestsData.guests.forEach((guest: Guests_guests | null) => {\n        if (guest !== null) {\n          options.push(getGuestOption(guest))\n        }\n      })\n      setGuestOptions(options)\n    }\n  }, [ guestsData ])\n\n  const formLayout = {\n    labelCol: {\n      span: 8\n    },\n    wrapperCol: {\n      span: 16\n    }\n  }\n\n  return (\n    <>\n      <Modal\n        className=\"reservation-modal\"\n        closeIcon={ (\n          <Popconfirm\n            onCancel={ () => setDeleteConfirmVisible(false) }\n            onConfirm={ () => {\n              setDeleteConfirmVisible(false)\n              setTimeout(close)\n            } }\n            title={ t(\"forms.close-dirty\") }\n            visible={ deleteConfirmVisible }>\n            <CloseOutlined onClick={ () => {\n              if (form.isFieldsTouched()) {\n                setDeleteConfirmVisible(true)\n              } else {\n                close()\n              }\n            } } />\n          </Popconfirm>\n        ) }\n        footer={ footerButtons }\n        title={ t(\"reservations.form\") }\n        visible={ isOpen }>\n        <Spin\n          spinning={ guestsLoading || createLoading || deleteLoading || updateLoading }\n          tip={ `${ t(\"loading\") }...` }>\n          <Form\n            form={ form }\n            initialValues={ initialValues }\n            { ...formLayout }>\n            <Form.Item\n              label={ t(\"reservations.date\") }\n              name=\"dates\"\n              required>\n              <DatePicker.RangePicker\n                format={ dateFormat }\n                onChange={ updatePrice }\n                showTime />\n            </Form.Item>\n            <Form.Item\n              hasFeedback\n              label={ t(\"guests.name\") }\n              name=\"guest\"\n              required\n              rules={ guestValidator }>\n              <Select\n                filterOption={ (input, option): boolean => {\n                  const match = option?.label?.toString().toLowerCase().indexOf(input.toLowerCase())\n                  return match !== undefined && match >= 0\n                } }\n                options={ guestOptions }\n                showSearch />\n            </Form.Item>\n            <Form.List name=\"roommates\">\n              { (fields, { add, remove }) => (\n                <>\n                  { fields.map(({ key, name, fieldKey, ...restField }) => (\n                    <Space\n                      align=\"baseline\"\n                      className=\"roommate-list\"\n                      key={ key }>\n                      <Form.Item\n                        hasFeedback\n                        { ...restField }\n                        fieldKey={ [ fieldKey, 'first' ] }\n                        label={ t(\"reservations.roommate\") }\n                        name={ [ name, \"id\" ] }\n                        rules={ roommateValidator }>\n                        <Select\n                          onChange={ () => console.log(fields) }\n                          options={ guestOptions }\n                          showSearch />\n                      </Form.Item>\n                      <MinusCircleOutlined onClick={ () => {\n                        remove(name)\n                        form.validateFields()\n                        console.log(fields)\n                        // updatePrice()\n                      } } />\n                    </Space>\n                  )) }\n                  <Form.Item wrapperCol={ { offset: 8, span: 16 } }>\n                    <Button\n                      disabled={ fields.length >= guestOptions.length }\n                      type=\"dashed\"\n                      onClick={ () => add() }\n                      block\n                      icon={ <PlusOutlined /> }>\n                      { t(\"reservations.add-roommate\") }\n                    </Button>\n                  </Form.Item>\n                </>\n              ) }\n            </Form.List>\n            <Form.Item\n              hasFeedback\n              label={ t(\"reservations.type\") }\n              name=\"type\"\n              required\n              rules={ [ ReservationFormHelper.getRequiredRule(t(\"reservations.choose-type\")) ] }>\n              <Select\n                options={ ReservationFormHelper.reservationOptions } />\n            </Form.Item>\n            <Form.Item\n              hasFeedback\n              label={ t(\"reservations.meal\") }\n              name=\"meal\"\n              required\n              rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\n              <Select\n                options={ ReservationFormHelper.mealOptions } />\n            </Form.Item>\n            <Form.Item\n              hidden={ !additionalInfoVisible }\n              label={ t(\"reservations.purpose\") }\n              name=\"purpose\">\n              <Input placeholder={ t(\"reservations.purpose\") } />\n            </Form.Item>\n            <Form.Item\n              hidden={ !additionalInfoVisible }\n              label={ t(\"reservations.notes\") }\n              name=\"notes\">\n              <Input.TextArea\n                placeholder={ t(\"forms.enter-text\") }\n                allowClear />\n            </Form.Item>\n            <Form.Item wrapperCol={ { offset: 8, span: 16 } }>\n              <Button\n                block\n                onClick={ () => setAdditionalInfoVisible(!additionalInfoVisible) }\n                type=\"dashed\"\n                icon={ additionalInfoVisible ? <EyeInvisibleOutlined /> : <EyeOutlined /> }>\n                { additionalInfoVisible ? t(\"reservations.hide-info\") : t(\"reservations.show-info\") }\n              </Button>\n            </Form.Item>\n            {/* @TODO: add tooltips explaining price calculation */}\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-room\") }>\n              <Typography.Text>\n                <strong>\n                  { suite?.priceBase } { t(\"rooms.currency\") }\n                </strong>\n              </Typography.Text>\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-accommodation\") }\n              name=\"priceAccommodation\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-extra\") }\n              name=\"priceExtra\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-meal\") }\n              name=\"priceMeal\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-municipality\") }\n              name=\"priceMunicipality\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ <strong>{ t(\"reservations.price-total\") }</strong> }\n              name=\"priceTotal\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item wrapperCol={ { offset: 8, span: 16 } }>\n              <Button\n                block\n                onClick={ () => setPricesVisible(!pricesVisible) }\n                type=\"dashed\"\n                icon={ pricesVisible ? <EyeInvisibleOutlined /> : <EyeOutlined /> }>\n                { pricesVisible ? t(\"reservations.hide-prices\") : t(\"reservations.show-prices\") }\n              </Button>\n            </Form.Item>\n          </Form>\n        </Spin>\n      </Modal>\n      <GuestDrawer\n        close={ () => setGuestDrawerOpen(false) }\n        addGuest={ addGuestOption }\n        visible={ guestDrawerOpen } />\n    </>\n  )\n}","import { gql } from \"@apollo/client\";\r\n\r\nexport const SUITES = gql`\r\n  query Suites {\r\n    suites {\r\n      id\r\n      number\r\n      numberBeds\r\n      priceBase\r\n      priceChild\r\n      priceExtra\r\n      priceInfant\r\n      title\r\n    }\r\n  }\r\n`\r\n\r\nexport const SUITES_WITH_RESERVATIONS = gql`\r\n  query SuitesWithReservations {\r\n    guests {\r\n      id\r\n      name\r\n      surname\r\n    }\r\n    suites {\r\n      id\r\n      number\r\n      numberBeds\r\n      priceBase\r\n      priceChild\r\n      priceExtra\r\n      priceInfant\r\n      title\r\n    }\r\n    reservations {\r\n      fromDate\r\n      id\r\n      guest {\r\n        id\r\n        name\r\n        surname\r\n      }\r\n      meal\r\n      notes\r\n      priceAccommodation\r\n      priceExtra\r\n      priceMeal\r\n      priceMunicipality\r\n      priceTotal\r\n      purpose\r\n      roommates {\r\n        age\r\n        id\r\n        name\r\n        surname\r\n      }\r\n      suite {\r\n        id\r\n      }\r\n      toDate\r\n      type\r\n    }\r\n  }\r\n`","import { RouteComponentProps, withRouter } from \"react-router-dom\"\nimport Title from \"antd/lib/typography/Title\"\nimport Timeline, { CursorMarker, DateHeader, SidebarHeader, TimelineGroup, TimelineHeaders, TimelineItem } from \"react-calendar-timeline\"\nimport { useEffect, useState } from \"react\"\nimport \"react-calendar-timeline/lib/Timeline.css\"\nimport \"./styles.css\"\nimport moment, { Moment } from \"moment\"\nimport { CustomGroupFields, CustomItemFields, IReservation, MenuItemKey } from \"../../lib/Types\"\nimport { Colors } from \"../../lib/components/Colors\"\nimport { ReservationItem } from \"./components/ReservationItem\"\nimport { ReservationModal } from \"./components/ReservationModal\"\nimport { ApolloError, useQuery } from \"@apollo/client\"\nimport { Suites_suites } from \"../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport { SUITES_WITH_RESERVATIONS } from \"../../lib/graphql/queries/Suites\"\nimport { SuitesWithReservations, SuitesWithReservations_reservations } from \"../../lib/graphql/queries/Suites/__generated__/SuitesWithReservations\"\nimport { message, Skeleton } from \"antd\"\nimport { useTranslation } from \"react-i18next\"\n\ninterface Props {\n  setPageTitle: (title: string) => void\n  setSelectedPage: (page: MenuItemKey) => void\n}\n\n// https://github.com/namespace-ee/react-calendar-timeline\nexport const Reservations = withRouter(({\n  setPageTitle,\n  setSelectedPage\n}: RouteComponentProps & Props) => {\n\n  const { t } = useTranslation()\n\n  const [ dataLoading, setDataLoading ] = useState<boolean>(true)\n  const [ groups, setGroups ] = useState<TimelineGroup<CustomGroupFields>[]>([])\n  const [ items, setItems ] = useState<TimelineItem<CustomItemFields, Moment>[]>([])\n  const [ reservation, setReservation ] = useState<IReservation>()\n  const [ reservationModalOpen, setReservationModalOpen ] = useState<boolean>(false)\n  const [ selectedSuite, setSelectedSuite ] = useState<Suites_suites>()\n\n  const { data: reservationsData } = useQuery<SuitesWithReservations>(SUITES_WITH_RESERVATIONS, {\n    onCompleted: () => {\n      setDataLoading(false)\n    },\n    onError: (reason: ApolloError) => message.error(reason.message)\n  })\n\n  const getTimelineReservationItem = (reservation: SuitesWithReservations_reservations): TimelineItem<CustomItemFields, Moment> => {\n    return {\n      color: Colors.getReservationColor(reservation.type),\n      end_time: moment(reservation.toDate),\n      group: reservation.suite.id,\n      guest: reservation.guest,\n      id: reservation.id,\n      itemProps: {\n        className: 'reservation-item',\n        style: {\n          background: Colors.getReservationColor(reservation.type),\n          border: \"none\"\n        }\n      },\n      meal: reservation.meal,\n      notes: reservation.notes,\n      priceAccommodation: reservation.priceAccommodation,\n      priceExtra: reservation.priceExtra,\n      priceMeal: reservation.priceMeal,\n      priceMunicipality: reservation.priceMunicipality,\n      priceTotal: reservation.priceTotal,\n      purpose: reservation.purpose,\n      roommates: reservation.roommates,\n      start_time: moment(reservation.fromDate),\n      suite: reservation.suite,\n      title: `${ reservation.guest.name } ${ reservation.guest.surname }`,\n      type: reservation.type\n    }\n  }\n\n  const addOrUpdateReservation = (reservation?: SuitesWithReservations_reservations | null) => {\n    if (reservation !== undefined && reservation !== null) {\n      const existingReservations = items.filter(item => item.id !== reservation.id)\n      setItems(existingReservations.concat(getTimelineReservationItem(reservation)))\n    }\n  }\n\n  const clearReservation = (reservationId?: string | null) => {\n    if (reservationId !== undefined && reservationId !== null) {\n      setItems(items.filter(item => item.id !== reservationId))\n    }\n    setReservation(undefined)\n  }\n\n  useEffect(() => {\n    const reservationList: TimelineItem<CustomItemFields, Moment>[] = []\n    const suiteList: TimelineGroup<CustomGroupFields>[] = []\n    reservationsData?.suites?.forEach((suite: Suites_suites | null) => {\n      if (suite !== null) {\n        suiteList.push(suite)\n      }\n    })\n    reservationsData?.reservations?.forEach((reservation: SuitesWithReservations_reservations | null) => {\n      if (reservation !== null) {\n        reservationList.push(getTimelineReservationItem(reservation))\n      }\n    })\n    setItems(reservationList)\n    setGroups(suiteList)\n  }, [ reservationsData ])\n\n  useEffect(() => {\n    setPageTitle(t(\"home-title\"))\n    setSelectedPage(\"reservation\")\n  }, [ setPageTitle, setSelectedPage, t ])\n\n  // Click on timeline outside of any reservation, \n  // opens modal for new reservation\n  const onCanvasClick = (groupId: number, time: number) => {\n    const selectedGroup = groups.find(group => group.id === groupId)\n    if (selectedGroup !== undefined) {\n      const suite = reservationsData?.suites?.find(suite => suite?.id === selectedGroup.id)\n      if (suite !== null) {\n        setSelectedSuite(suite)\n      }\n      setReservation({\n        fromDate: moment(time),\n        meal: \"NOMEAL\",\n        roommates: [],\n        suite: { ...selectedGroup },\n        priceAccommodation: \"0.00\",\n        priceExtra: \"0.00\",\n        priceMeal: \"0.00\",\n        priceMunicipality: \"0.00\",\n        priceTotal: \"0.00\",\n        toDate: moment(time).add(1, \"day\"),\n        type: \"NONBINDING\"\n      })\n      setReservationModalOpen(true)\n    }\n  }\n\n  // Click on item on the timeline opens modal\n  // with existing reservation for editing\n  const onItemClick = (itemId: number) => {\n    const timelineItem = items.find(item => item.id === itemId)\n    if (timelineItem !== undefined) {\n      const suite = reservationsData?.suites?.find(suite => suite?.id === timelineItem.suite.id)\n      if (suite !== null) {\n        setSelectedSuite(suite)\n      }\n      setReservation({\n        fromDate: moment(timelineItem.start_time),\n        guest: timelineItem.guest,\n        id: timelineItem.id,\n        meal: timelineItem.meal,\n        notes: timelineItem.notes,\n        priceAccommodation: timelineItem.priceAccommodation,\n        priceExtra: timelineItem.priceExtra,\n        priceMeal: timelineItem.priceMeal,\n        priceMunicipality: timelineItem.priceMunicipality,\n        priceTotal: timelineItem.priceTotal,\n        purpose: timelineItem.purpose,\n        roommates: timelineItem.roommates,\n        suite: timelineItem.suite,\n        toDate: moment(timelineItem.end_time),\n        type: timelineItem.type\n      })\n      setReservationModalOpen(true)\n    }\n  }\n\n  return (\n    <>\n      <Skeleton\n        active\n        loading={ dataLoading }\n        paragraph={ { rows: 5 } }>\n        <Timeline\n          canChangeGroup={ false }\n          canMove={ false }\n          canResize={ false }\n          defaultTimeEnd={ moment().add(12, \"day\") }\n          defaultTimeStart={ moment().add(-12, \"day\") }\n          groupRenderer={ ({ group }) => {\n            return (\n              <>\n                <Title level={ 5 }>{ group.title }</Title>\n              </>\n            )\n          } }\n          groups={ groups }\n          itemRenderer={ props => <ReservationItem { ...props } /> }\n          items={ items }\n          lineHeight={ 60 }\n          onCanvasClick={ onCanvasClick }\n          onItemClick={ onItemClick }>\n          <TimelineHeaders>\n            <SidebarHeader>\n              { ({ getRootProps }) => {\n                return (\n                  <div\n                    { ...getRootProps() }\n                    className=\"side-header\">\n                    { t(\"living-units\") }\n                  </div>\n                )\n              } }\n            </SidebarHeader>\n            <DateHeader unit=\"primaryHeader\" />\n            <DateHeader\n              className=\"days\"\n              unit=\"day\" />\n          </TimelineHeaders>\n          <CursorMarker>\n            {\n              ({ styles, date }) => {\n                return (\n                  <div style={ { ...styles, backgroundColor: \"rgba(136, 136, 136, 0.5)\", color: \"#888\" } }>\n                    <div className=\"rt-marker__label\">\n                      <div className=\"rt-marker__content\">\n                        { moment(date).format(\"DD MMM HH:mm\") }\n                      </div>\n                    </div>\n                  </div>\n                )\n              }\n            }\n          </CursorMarker>\n        </Timeline>\n      </Skeleton>\n      <ReservationModal\n        addOrUpdateReservation={ addOrUpdateReservation }\n        close={ () => {\n          setReservation(undefined)\n          setReservationModalOpen(false)\n        } }\n        isOpen={ reservationModalOpen }\n        clearReservation={ clearReservation }\n        reservation={ reservation }\n        suite={ selectedSuite } />\n    </>\n  )\n})","import { Avatar, Button, List } from \"antd\"\r\nimport { Colors } from \"../../../lib/components/Colors\"\r\nimport { Guests_guests } from \"../../../lib/graphql/queries/Guests/__generated__/Guests\"\r\n\r\ninterface Props {\r\n  guest: Guests_guests\r\n  openGuestDrawer: () => void\r\n  selectGuest: (guest: Guests_guests) => void\r\n}\r\n\r\nexport const GuestItem = ({\r\n  guest,\r\n  openGuestDrawer,\r\n  selectGuest\r\n}: Props) => {\r\n  return (\r\n    <List.Item\r\n      actions={ [\r\n        <Button\r\n          key=\"edit\"\r\n          onClick={ () => {\r\n            selectGuest(guest)\r\n            openGuestDrawer()\r\n          } }\r\n          type=\"link\">\r\n          upravit\r\n        </Button>,\r\n      ] }>\r\n      <List.Item.Meta\r\n        avatar={\r\n          <Avatar\r\n            gap={ 4 }\r\n            size=\"large\"\r\n            style={ {\r\n              backgroundColor: Colors.getRandomColor()\r\n            } }>\r\n            { guest.name.substring(0, 1).toUpperCase() }\r\n          </Avatar>\r\n        }\r\n        description={ guest.email }\r\n        title={ `${ guest.name } ${ guest.surname }` } />\r\n    </List.Item>\r\n  )\r\n}","import { useState } from \"react\"\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\nimport { Button, List, message, Skeleton } from \"antd\"\nimport { GUESTS } from \"../../lib/graphql/queries/Guests\"\nimport { Guests as GuestsData, Guests_guests } from \"../../lib/graphql/queries/Guests/__generated__/Guests\"\nimport { PlusCircleOutlined } from \"@ant-design/icons\"\nimport { ApolloError, useQuery } from \"@apollo/client\"\nimport { useEffect } from \"react\"\nimport { GuestDrawer } from \"../GuestDrawer\"\nimport \"./styles.css\"\nimport { GuestItem } from \"./components/GuestItem\"\nimport { useTranslation } from \"react-i18next\"\nimport { MenuItemKey } from \"../../lib/Types\"\n\ninterface Props {\n  setPageTitle: (title: string) => void\n  setSelectedPage: (page: MenuItemKey) => void\n}\n\nexport const Guests = withRouter(({\n  setPageTitle,\n  setSelectedPage\n}: RouteComponentProps & Props) => {\n\n  const { t } = useTranslation()\n\n  const [ dataLoading, setDataLoading ] = useState<boolean>(true)\n  const [ drawerVisible, setDrawerVisible ] = useState<boolean>(false)\n  const [ guests, setGuests ] = useState<Guests_guests[]>([])\n  const [ selectedGuest, setSelectedGuest ] = useState<Guests_guests | null>(null)\n\n  const { data: guestsData } = useQuery<GuestsData>(GUESTS, {\n    onCompleted: () => {\n      setDataLoading(false)\n    },\n    onError: (reason: ApolloError) => message.error(reason.message)\n  })\n\n  const addOrRemoveGuest = (guest: Guests_guests) => {\n    const existingGuests = guests.filter(cachedGuest => cachedGuest.id !== guest.id)\n    setGuests(existingGuests.concat(guest))\n  }\n\n  const removeGuest = (guestId: string) =>\n    setGuests(guests.filter(cachedGuest => cachedGuest.id !== guestId))\n\n  useEffect(() => {\n    const guestsList: Guests_guests[] = []\n    if (guestsData !== undefined && guestsData?.guests !== null) {\n      guestsData.guests.forEach((guest: Guests_guests | null) => {\n        if (guest !== null) {\n          guestsList.push(guest)\n        }\n      })\n      setGuests(guestsList)\n    }\n  }, [ guestsData ])\n\n  useEffect(() => {\n    setPageTitle(t(\"guests.page-title\"))\n    setSelectedPage(\"guests\")\n  }, [ setPageTitle, setSelectedPage, t ])\n\n  return (\n    <>\n      <Skeleton\n        active\n        loading={ dataLoading }\n        paragraph={ { rows: 5 } }>\n        <List\n          bordered={ true }\n          className=\"guests-list\"\n          dataSource={ guests }\n          footer={\n            <Button\n              icon={ <PlusCircleOutlined /> }\n              onClick={ () => {\n                setSelectedGuest(null)\n                setDrawerVisible(true)\n              } }\n              type=\"primary\">\n              { t(\"guests.add\") }\n            </Button>\n          }\n          header={ <h4>{ t(\"guests.list\") }</h4> }\n          itemLayout=\"horizontal\"\n          renderItem={ (guest: Guests_guests) => (\n            <GuestItem\n              guest={ guest }\n              openGuestDrawer={ () => setDrawerVisible(true) }\n              selectGuest={ setSelectedGuest } />\n          ) } />\n      </Skeleton>\n      <GuestDrawer\n        addGuest={ addOrRemoveGuest }\n        close={ () => setDrawerVisible(false) }\n        guest={ selectedGuest }\n        removeGuest={ removeGuest }\n        visible={ drawerVisible } />\n    </>\n  )\n})","import { gql } from \"@apollo/client\";\r\n\r\nexport const CREATE_SUITE = gql`\r\n  mutation CreateSuite($data: SuiteInput!) {\r\n    createSuite(data: $data) {\r\n      suite {\r\n        id\r\n        number\r\n        numberBeds\r\n        priceBase\r\n        priceChild\r\n        priceExtra\r\n        priceInfant\r\n        title\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const UPDATE_SUITE = gql`\r\n  mutation UpdateSuite($data: SuiteInput!) {\r\n    updateSuite(data: $data) {\r\n      suite {\r\n        id\r\n        number\r\n        numberBeds\r\n        priceBase\r\n        priceChild\r\n        priceExtra\r\n        priceInfant\r\n        title\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const DELETE_SUITE = gql`\r\n  mutation DeleteSuite($suiteId: ID!) {\r\n    deleteSuite(suiteId: $suiteId) {\r\n      suite {\r\n        id\r\n      }\r\n    }\r\n  }\r\n`","import { WarningOutlined } from \"@ant-design/icons\"\r\nimport { Button, Popconfirm } from \"antd\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { Suites_suites } from \"../../../../../../lib/graphql/queries/Suites/__generated__/Suites\"\r\n\r\ninterface Props {\r\n  deleteSuite: (suiteId: string) => void\r\n  submitForm: () => void\r\n  suite?: Suites_suites\r\n}\r\n\r\nexport const RoomActions = ({\r\n  deleteSuite,\r\n  submitForm,\r\n  suite\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return (\r\n    <>\r\n      { suite !== undefined &&\r\n        <Popconfirm\r\n          cancelText={ t(\"no\") }\r\n          icon={ <WarningOutlined /> }\r\n          okText={ t(\"yes\") }\r\n          onConfirm={ () => {\r\n            deleteSuite(suite.id)\r\n          } }\r\n          title={ t(\"forms.delete-confirm\") }>\r\n          <Button\r\n            danger\r\n            style={ {\r\n              float: \"left\"\r\n            } }\r\n            type=\"primary\">\r\n            { t(\"forms.delete\") }\r\n          </Button>\r\n        </Popconfirm>\r\n      }\r\n      <Button\r\n        onClick={ submitForm }\r\n        type=\"primary\">\r\n        { suite === undefined ? t(\"forms.create\") : t(\"forms.update\") }\r\n      </Button>\r\n    </>\r\n  )\r\n}","import { useEffect, useState } from \"react\"\nimport { Drawer, Form, Input, message, Popconfirm, Spin } from \"antd\"\nimport { FormHelper } from \"../../../../lib/components/FormHelper\"\nimport { CloseOutlined } from \"@ant-design/icons\"\nimport { Suites_suites } from \"../../../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport { Store } from \"antd/lib/form/interface\"\nimport { SuiteForm } from \"../../../../lib/Types\"\nimport { ApolloError, FetchResult, useMutation } from \"@apollo/client\"\nimport { CreateSuite, CreateSuiteVariables } from \"../../../../lib/graphql/mutations/Suite/__generated__/CreateSuite\"\nimport { CREATE_SUITE, DELETE_SUITE, UPDATE_SUITE } from \"../../../../lib/graphql/mutations/Suite\"\nimport { UpdateSuite, UpdateSuiteVariables } from \"../../../../lib/graphql/mutations/Suite/__generated__/UpdateSuite\"\nimport { DeleteSuite, DeleteSuiteVariables } from \"../../../../lib/graphql/mutations/Suite/__generated__/DeleteSuite\"\nimport { useTranslation } from \"react-i18next\"\nimport { RoomActions } from \"./components/RoomActions\"\nimport Title from \"antd/lib/typography/Title\"\n\ninterface Props {\n  addOrUpdateSuite: (suite: Suites_suites) => void\n  clearSuite: (suiteId: string) => void\n  close: () => void\n  suite?: Suites_suites\n  visible: boolean\n}\n\nexport const SuiteDrawer = ({\n  addOrUpdateSuite,\n  clearSuite,\n  close,\n  suite,\n  visible\n}: Props) => {\n\n  const { t } = useTranslation()\n\n  const networkErrorHandler = (reason: ApolloError) => message.error(reason.message)\n\n  const [ createSuite, { loading: createLoading } ] = useMutation<CreateSuite, CreateSuiteVariables>(CREATE_SUITE, {\n    onError: networkErrorHandler\n  })\n  const [ deleteSuite, { loading: deleteLoading } ] = useMutation<DeleteSuite, DeleteSuiteVariables>(DELETE_SUITE, {\n    onError: networkErrorHandler\n  })\n  const [ updateSuite, { loading: updateLoading } ] = useMutation<UpdateSuite, UpdateSuiteVariables>(UPDATE_SUITE, {\n    onError: networkErrorHandler\n  })\n\n  const [ form ] = Form.useForm()\n\n  const [ confirmClose, setConfirmClose ] = useState<boolean>(false)\n\n  const initialValues: Store = {\n    beds: suite?.numberBeds,\n    number: suite?.number,\n    price_base: suite?.priceBase,\n    price_child: suite?.priceChild,\n    price_extra: suite?.priceExtra,\n    price_infant: suite?.priceInfant,\n    title: suite?.title\n  }\n\n  const submitForm = () => {\n    form.validateFields()\n      .then(() => {\n        const formData: SuiteForm = form.getFieldsValue(true)\n        const variables = {\n          number: formData.number,\n          numberBeds: formData.beds,\n          priceBase: formData.price_base,\n          priceChild: formData.price_child,\n          priceExtra: formData.price_extra,\n          priceInfant: formData.price_infant,\n          title: formData.title\n        }\n        if (suite === undefined) {\n          createSuite({ variables: { data: { ...variables } } })\n            .then((value: FetchResult<CreateSuite>) => {\n              const suite = value.data?.createSuite?.suite\n              if (suite !== undefined && suite !== null) {\n                addOrUpdateSuite(suite)\n                message.success(t(\"rooms.created\"))\n                close()\n              }\n            })\n        } else {\n          updateSuite({ variables: { data: { id: suite.id, ...variables } } })\n            .then((value: FetchResult<UpdateSuite>) => {\n              const suite = value.data?.updateSuite?.suite\n              if (suite !== undefined && suite !== null) {\n                addOrUpdateSuite(suite)\n                message.success(t(\"rooms.updated\"))\n                close()\n              }\n            })\n        }\n      })\n      .catch(() => {\n        console.error(\"Form validation failed\");\n      })\n  }\n\n  const deleteSuiteHandle = (suiteId: string) => {\n    deleteSuite({ variables: { suiteId } })\n      .then((value: FetchResult<DeleteSuite>) => {\n        const suiteId = value.data?.deleteSuite?.suite?.id\n        if (suiteId !== undefined) {\n          clearSuite(suiteId)\n          message.success(t(\"rooms.deleted\"))\n          close()\n        }\n      })\n  }\n\n  const closeDrawer = (): void => {\n    if (form.isFieldsTouched()) {\n      setConfirmClose(true)\n    } else {\n      close()\n    }\n  }\n\n  useEffect(() => {\n    if (visible === true) {\n      form.resetFields()\n    }\n  }, [ form, visible ])\n\n  return (\n    <Drawer\n      closeIcon={ (\n        <Popconfirm\n          onCancel={ () => setConfirmClose(false) }\n          onConfirm={ () => {\n            setConfirmClose(false)\n            close()\n          } }\n          placement=\"rightTop\"\n          title={ t(\"forms.close-dirty\") }\n          visible={ confirmClose }>\n          <CloseOutlined onClick={ closeDrawer } />\n        </Popconfirm>\n      ) }\n      footer={\n        <RoomActions\n          deleteSuite={ deleteSuiteHandle }\n          submitForm={ submitForm }\n          suite={ suite } />\n      }\n      footerStyle={ {\n        textAlign: \"right\"\n      } }\n      placement=\"left\"\n      title={ t(\"rooms.new\") }\n      visible={ visible }\n      width={ 500 }>\n      <Spin\n        size=\"large\"\n        spinning={\n          createLoading\n          || deleteLoading\n          || updateLoading\n        }\n        tip={ `${ t(\"loading\") }...` }>\n        <Form\n          form={ form }\n          initialValues={ initialValues }\n          layout=\"vertical\"\n          name=\"suite\">\n          <Form.Item\n            hasFeedback\n            label={ t(\"forms.name\") }\n            name=\"title\"\n            required\n            rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\n            <Input placeholder={ t(\"rooms.name\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.number-beds\") }\n            name=\"beds\"\n            required\n            rules={ [\n              FormHelper.requiredRule(t(\"forms.field-required\")),\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]+$/\n              }\n            ] }>\n            <Input placeholder={ t(\"rooms.number-beds\") } type=\"number\" />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"number\") }\n            name=\"number\"\n            required\n            rules={ [\n              FormHelper.requiredRule(t(\"forms.field-required\")),\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]+$/\n              }\n            ] }>\n            <Input placeholder={ t(\"rooms.number\") } type=\"number\" />\n          </Form.Item>\n          <Title level={ 5 }>{ t(\"rooms.prices-title\") }</Title>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-base\") }\n            name=\"price_base\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-child\") }\n            name=\"price_child\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-infant\") }\n            name=\"price_infant\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-extra\") }\n            name=\"price_extra\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n        </Form>\n      </Spin>\n    </Drawer>\n  )\n}","import { PlusCircleOutlined } from \"@ant-design/icons\";\r\nimport { Button } from \"antd\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\ninterface Props {\r\n  hasAccess: boolean\r\n  onAdd: () => void\r\n}\r\n\r\nexport const AddSuite = ({\r\n  hasAccess,\r\n  onAdd\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return hasAccess === true ? (\r\n    <Button\r\n      icon={ <PlusCircleOutlined /> }\r\n      onClick={ onAdd }\r\n      type=\"primary\">\r\n      { t(\"living-unit-add\") }\r\n    </Button>\r\n  ) : null\r\n}","import { HomeOutlined } from \"@ant-design/icons\"\r\nimport { Avatar, Button, List } from \"antd\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { Suites_suites } from \"../../../../lib/graphql/queries/Suites/__generated__/Suites\"\r\n\r\ninterface Props {\r\n  openSuite: (suite: Suites_suites) => void\r\n  suite: Suites_suites\r\n}\r\n\r\nexport const SuiteItem = ({\r\n  openSuite,\r\n  suite\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return (\r\n    <List.Item\r\n      actions={ [\r\n        <Button\r\n          className=\"low-case\"\r\n          key=\"edit\"\r\n          onClick={ () => openSuite(suite) }\r\n          type=\"link\">\r\n          { t(\"forms.update\") }\r\n        </Button>\r\n      ] }\r\n      className=\"suite-item\"\r\n      onClick={ () => openSuite(suite) }>\r\n      <List.Item.Meta\r\n        avatar={\r\n          <Avatar gap={ 4 } size=\"large\">\r\n            <HomeOutlined />\r\n          </Avatar>\r\n        }\r\n        description={ `${ t(\"rooms.number\") } - ${ suite.number }` }\r\n        title={ suite.title } />\r\n    </List.Item>\r\n  )\r\n}","import { useEffect, useState } from \"react\"\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\nimport { List, message, Skeleton } from \"antd\"\nimport { SuiteDrawer } from \"./components/SuiteDrawer\"\nimport { Suites as SuitesData, Suites_suites } from \"../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport \"./styles.css\"\nimport { AddSuite } from \"./components/AddSuite\"\nimport { ApolloError, useQuery } from \"@apollo/client\"\nimport { SUITES } from \"../../lib/graphql/queries/Suites\"\nimport { useTranslation } from \"react-i18next\"\nimport { MenuItemKey } from \"../../lib/Types\"\nimport { SuiteItem } from \"./components/SuiteItem\"\n\ninterface Props {\n  setPageTitle: (title: string) => void\n  setSelectedPage: (page: MenuItemKey) => void\n}\n\nexport const Suites = withRouter(({\n  setPageTitle,\n  setSelectedPage\n}: RouteComponentProps & Props) => {\n\n  const { t } = useTranslation()\n\n  const [ dataLoading, setDataLoading ] = useState<boolean>(true)\n  const [ drawerVisible, setDrawerVisible ] = useState<boolean>(false)\n  const [ activeSuite, setActiveSuite ] = useState<Suites_suites>()\n  const [ suites, setSuites ] = useState<Suites_suites[]>([])\n  const [ hasAccess, setHasAccess ] = useState<boolean>(false)\n\n  const { data: suitesData } = useQuery<SuitesData>(SUITES, {\n    onCompleted: () => {\n      setHasAccess(true)\n      setDataLoading(false)\n    },\n    onError: (reason: ApolloError) => {\n      message.error(reason.message)\n      setHasAccess(false)\n      setDataLoading(false)\n    }\n  })\n\n  const addOrUpdateSuite = (suite: Suites_suites) => {\n    setSuites(suites.filter(cachedSuite => cachedSuite.id !== suite.id).concat(suite))\n  }\n\n  const clearSuite = (suiteId: string) => {\n    setSuites(suites.filter(suite => suite.id !== suiteId))\n  }\n\n  const openSuite = (suite: Suites_suites | undefined) => {\n    setActiveSuite(suite)\n    setDrawerVisible(true)\n  }\n\n  useEffect(() => {\n    const suitesList: Suites_suites[] = []\n    suitesData?.suites?.forEach((suite: Suites_suites | null) => {\n      if (suite !== null) {\n        suitesList.push(suite)\n      }\n    })\n    setSuites(suitesList)\n  }, [ suitesData ])\n\n  useEffect(() => {\n    setPageTitle(t(\"living-units\"))\n    setSelectedPage(\"suites\")\n  }, [ setPageTitle, setSelectedPage, t ])\n\n  return (\n    <>\n      <Skeleton\n        active\n        loading={ dataLoading }\n        paragraph={ { rows: 5 } }>\n        <List\n          bordered={ true }\n          className=\"suites-list\"\n          dataSource={ suites }\n          footer={\n            <AddSuite\n              hasAccess={ hasAccess }\n              onAdd={ () => openSuite(undefined) } />\n          }\n          header={ <h4>{ t(\"living-units-list\") }</h4> }\n          itemLayout=\"horizontal\"\n          renderItem={ suite => (\n            <SuiteItem\n              openSuite={ openSuite }\n              suite={ suite } />\n          ) } />\n      </Skeleton>\n      <SuiteDrawer\n        addOrUpdateSuite={ addOrUpdateSuite }\n        clearSuite={ clearSuite }\n        close={ () => setDrawerVisible(false) }\n        suite={ activeSuite }\n        visible={ drawerVisible } />\n    </>\n  )\n})","import { ApolloError, useMutation } from \"@apollo/client\"\r\nimport { Button, Form, FormProps, Input, Layout, message, Spin } from \"antd\"\r\nimport { useEffect } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\r\nimport { UrlHelper } from \"../../lib/components/UrlHelper\"\r\nimport { errorMessages, refreshTokenName, tokenName, usernameKey } from \"../../lib/Constants\"\r\nimport { TOKEN_AUTH } from \"../../lib/graphql/mutations/Token\"\r\nimport { TokenAuth, TokenAuthVariables } from \"../../lib/graphql/mutations/Token/__generated__/TokenAuth\"\r\nimport \"./styles.css\"\r\n\r\ninterface Props {\r\n  setPageTitle: (title: string) => void\r\n}\r\n\r\nconst layout: FormProps = {\r\n  labelCol: {\r\n    lg: 8,\r\n    md: 8,\r\n    sm: 8\r\n  },\r\n  wrapperCol: {\r\n    lg: 16,\r\n    md: 16,\r\n    sm: 16,\r\n  },\r\n};\r\nconst tailLayout = {\r\n  wrapperCol: {\r\n    lg: {\r\n      offset: 8,\r\n      span: 16,\r\n    },\r\n    xs: {\r\n      offset: 0,\r\n      span: 24\r\n    }\r\n  },\r\n};\r\n\r\nexport const Login = withRouter(({\r\n  history,\r\n  setPageTitle\r\n}: RouteComponentProps & Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ getToken, { loading: loginLoading } ] = useMutation<TokenAuth, TokenAuthVariables>(TOKEN_AUTH, {\r\n    onCompleted: (token: TokenAuth) => {\r\n      if (token.tokenAuth !== null) {\r\n        localStorage.setItem(tokenName, token.tokenAuth.token)\r\n        localStorage.setItem(refreshTokenName, token.tokenAuth.refreshToken)\r\n        localStorage.setItem(usernameKey, token.tokenAuth.payload.username)\r\n        history.push(UrlHelper.getReferrer())\r\n      }\r\n    },\r\n    onError: (reason: ApolloError) => {\r\n      switch (reason.message) {\r\n        case errorMessages.invalidCredentials:\r\n          message.error(t(\"login.invalid-login\"))\r\n          break\r\n        default:\r\n          message.error(t(\"generic-error\"))\r\n      }\r\n    }\r\n  })\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const login = (data: { password: string, username: string }): void => {\r\n    getToken({\r\n      variables: {\r\n        password: data.password.trim(),\r\n        username: data.username.trim()\r\n      }\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    setPageTitle(t(\"pages.login\"))\r\n  }, [ setPageTitle, t ])\r\n\r\n  return (\r\n    <Layout.Content>\r\n      <Spin\r\n        spinning={ loginLoading }\r\n        tip={ `${ t(\"login.in-progress\") }...` }>\r\n        <Form\r\n          { ...layout }\r\n          className=\"login\"\r\n          form={ form }\r\n          name=\"login\"\r\n          onFinish={ login }>\r\n          <Form.Item\r\n            label={ t(\"name\") }\r\n            name=\"username\"\r\n            rules={ [ {\r\n              required: true,\r\n              message: t(\"forms.field-required\")\r\n            } ] }>\r\n            <Input type=\"text\" placeholder={ t(\"forms.user-name\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"Heslo\"\r\n            name=\"password\"\r\n            rules={ [ {\r\n              required: true,\r\n              message: t(\"forms.field-required\")\r\n            } ] }>\r\n            <Input type=\"password\" placeholder={ t(\"forms.password\") } />\r\n          </Form.Item>\r\n          <Form.Item { ...tailLayout }>\r\n            <Button type=\"default\" htmlType=\"button\" onClick={ () => form.resetFields() }>\r\n              { t(\"forms.reset\") }\r\n            </Button>\r\n            <Button type=\"primary\" htmlType=\"submit\">\r\n              { t(\"forms.login\") }\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Spin>\r\n    </Layout.Content>\r\n  )\r\n})","import { gql } from \"@apollo/client\";\r\n\r\nexport const RESERVATION_GUESTS = gql`\r\n  query ReservationGuests($reservationHash: String!) {\r\n    reservationGuests(reservationHash: $reservationHash) {\r\n      guest {\r\n        addressMunicipality\r\n        addressPsc\r\n        addressStreet\r\n        age\r\n        citizenship\r\n        email\r\n        gender\r\n        identity\r\n        id\r\n        name\r\n        phoneNumber\r\n        surname\r\n        visaNumber\r\n      }\r\n      roommates {\r\n        addressMunicipality\r\n        addressPsc\r\n        addressStreet\r\n        age\r\n        citizenship\r\n        email\r\n        gender\r\n        identity\r\n        id\r\n        name\r\n        phoneNumber\r\n        surname\r\n        visaNumber\r\n      }\r\n    }\r\n  }\r\n`","import { gql } from \"@apollo/client\";\r\n\r\nexport const CONTACT_MESSAGE = gql`\r\n  mutation CreateContactMessage($data: ContactInput!) {\r\n    createContactMessage(data: $data) {\r\n      contact {\r\n        message\r\n      }\r\n    }\r\n  }\r\n`","import { useMutation } from \"@apollo/client\"\r\nimport { Button, Form, Input, message, Result, Spin } from \"antd\"\r\nimport { CONTACT_MESSAGE } from \"../../../../lib/graphql/mutations/Contact\"\r\nimport { CreateContactMessage, CreateContactMessageVariables } from \"../../../../lib/graphql/mutations/Contact/__generated__/CreateContactMessage\"\r\n\r\ninterface Props {\r\n  show: boolean\r\n}\r\n\r\nexport const Error = ({\r\n  show\r\n}: Props) => {\r\n\r\n  const [ createContactMessage, { loading: creatingMessage } ] = useMutation<CreateContactMessage, CreateContactMessageVariables>(CONTACT_MESSAGE)\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const submitForm = () => {\r\n    form.validateFields()\r\n      .then(() => {\r\n        createContactMessage({ variables: { data: { message: form.getFieldValue(\"message\") } } })\r\n        .then(() => {\r\n          message.success(\"Vaše zpráva byla odeslána, děkujeme!\")\r\n          form.resetFields()\r\n        })\r\n      })\r\n      .catch(() => message.error(\"Formulář nelze odeslat, opravte prosím chyby\"))\r\n  }\r\n\r\n  return show === true ? (\r\n    <Spin\r\n      spinning={ creatingMessage }\r\n      tip=\"Posílám zprávu\">\r\n      <Result\r\n        status=\"error\"\r\n        title=\"Rezervace nenalezena\"\r\n        subTitle=\"Zanechte nám prosím zprávu, nebo nám zavolejte na +420 XXX XXX XXX\"\r\n        extra={\r\n          <Form\r\n            form={ form }\r\n            name=\"contact\"\r\n            onFinish={ submitForm }\r\n            wrapperCol={ {\r\n              offset: 6,\r\n              span: 12\r\n            } }>\r\n            <Form.Item\r\n              name=\"message\"\r\n              rules={ [\r\n                {\r\n                  required: true,\r\n                  message: \"Zadejte text zprávy\"\r\n                }\r\n              ] }>\r\n              <Input.TextArea rows={ 4 } />\r\n            </Form.Item>\r\n            <Form.Item>\r\n              <Button type=\"primary\" htmlType=\"submit\">\r\n                Odeslat\r\n              </Button>\r\n            </Form.Item>\r\n          </Form>\r\n        } />\r\n    </Spin>\r\n  ) : null\r\n}","import { Avatar, Button, List } from \"antd\"\r\nimport { Colors } from \"../../../../lib/components/Colors\"\r\nimport { ReservationGuest } from \"../../../../lib/Types\"\r\n\r\ninterface Props {\r\n  guest?: ReservationGuest[]\r\n  loading: boolean\r\n  openDrawer: (guest: ReservationGuest) => void\r\n}\r\n\r\nexport const Host = ({\r\n  guest,\r\n  loading,\r\n  openDrawer\r\n}: Props) => {\r\n  return guest === undefined ? null : (\r\n    <List\r\n      bordered={ true }\r\n      className=\"guests-list\"\r\n      dataSource={ guest }\r\n      header={ <h4>Host</h4> }\r\n      itemLayout=\"horizontal\"\r\n      renderItem={ (guest: ReservationGuest) => (\r\n        <List.Item\r\n          key={ guest.id }\r\n          actions={\r\n            loading ? [] : [\r\n              <Button\r\n                key=\"edit\"\r\n                onClick={ () => {\r\n                  openDrawer(guest)\r\n                  // setSelectedGuest(guest)\r\n                  // setDrawerVisible(true)\r\n                } }\r\n                type=\"link\">\r\n                upravit\r\n              </Button>,\r\n            ]\r\n          }>\r\n          <List.Item.Meta\r\n            avatar={\r\n              <Avatar\r\n                gap={ 4 }\r\n                size=\"large\"\r\n                style={ {\r\n                  backgroundColor: Colors.getRandomColor()\r\n                } }>\r\n                { guest.name.substring(0, 1).toUpperCase() }\r\n              </Avatar>\r\n            }\r\n            description={ guest.email }\r\n            title={ `${ guest.name } ${ guest.surname }` } />\r\n        </List.Item>\r\n      ) } />\r\n  )\r\n}","import { gql } from \"@apollo/client\";\r\n\r\nexport const UPDATE_RESERVATON_GUEST = gql`\r\n  mutation UpdateReservationGuest($data: ReservationGuestInput!) {\r\n    updateReservationGuest(data: $data) {\r\n      guest {\r\n        addressMunicipality\r\n        addressPsc\r\n        addressStreet\r\n        age\r\n        citizenship\r\n        email\r\n        gender\r\n        identity\r\n        id\r\n        name\r\n        phoneNumber\r\n        surname\r\n        visaNumber\r\n      }\r\n    }\r\n  }\r\n`","import { CloseOutlined, MailOutlined } from \"@ant-design/icons\"\r\nimport { ApolloError, FetchResult, useMutation } from \"@apollo/client\"\r\nimport { Button, Drawer, Form, Input, message, Popconfirm, Select, Skeleton } from \"antd\"\r\nimport { Store } from \"antd/lib/form/interface\"\r\nimport Title from \"antd/lib/typography/Title\"\r\nimport { useEffect } from \"react\"\r\nimport { useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { FormHelper } from \"../../../../lib/components/FormHelper\"\r\nimport { GuestFormHelper } from \"../../../../lib/components/GuestFormHelper\"\r\nimport { UPDATE_RESERVATON_GUEST } from \"../../../../lib/graphql/mutations/ReservationGuest\"\r\nimport { UpdateReservationGuest, UpdateReservationGuestVariables } from \"../../../../lib/graphql/mutations/ReservationGuest/__generated__/UpdateReservationGuest\"\r\nimport { GuestForm, ReservationGuest } from \"../../../../lib/Types\"\r\n\r\ninterface Props {\r\n  close: () => void\r\n  guest?: ReservationGuest\r\n  reservationHash: string\r\n  visible: boolean\r\n}\r\n\r\nexport const ReservationGuestDrawer = ({\r\n  close,\r\n  guest,\r\n  reservationHash,\r\n  visible\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ updateGuest, { loading: updateLoading } ] = useMutation<UpdateReservationGuest, UpdateReservationGuestVariables>(UPDATE_RESERVATON_GUEST)\r\n\r\n  const [ confirmClose, setConfirmClose ] = useState<boolean>(false)\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const initialValues: Store = {\r\n    age: guest?.age,\r\n    address: {\r\n      municipality: guest?.addressMunicipality,\r\n      psc: guest?.addressPsc,\r\n      street: guest?.addressStreet\r\n    },\r\n    citizenship: {\r\n      selected: guest?.citizenship\r\n    },\r\n    email: guest?.email,\r\n    gender: guest?.gender,\r\n    identity: guest?.identity,\r\n    name: guest?.name,\r\n    phone: guest?.phoneNumber,\r\n    surname: guest?.surname,\r\n    visa: guest?.visaNumber\r\n  }\r\n  const emailPrefixIcon = (\r\n    <Form.Item name=\"email-prefix\" noStyle>\r\n      <MailOutlined />\r\n    </Form.Item>\r\n  )\r\n\r\n  const submitForm = (): void => {\r\n    form.validateFields()\r\n      .then(() => {\r\n        const formData: GuestForm = form.getFieldsValue(true)\r\n        const variables = {\r\n          age: formData.age,\r\n          addressMunicipality: formData.address?.municipality,\r\n          addressPsc: formData.address?.psc,\r\n          addressStreet: formData.address?.street,\r\n          citizenship: formData.citizenship?.selected === undefined ? formData.citizenship?.new : formData.citizenship.selected,\r\n          email: formData.email,\r\n          gender: formData.gender,\r\n          identity: formData.identity,\r\n          name: formData.name,\r\n          phoneNumber: formData.phone,\r\n          surname: formData.surname,\r\n          visaNumber: formData.visa\r\n        }\r\n        updateGuest({ variables: { data: { id: String(guest?.id), hash: reservationHash, ...variables } } })\r\n          .then((value: FetchResult<UpdateReservationGuest>) => {\r\n            const guest = value.data?.updateReservationGuest?.guest\r\n            if (guest !== undefined && guest !== null) {\r\n              message.success(`Host ${ guest.name } ${ guest.surname } aktualizován!`)\r\n            }\r\n            close()\r\n          })\r\n          .catch((reason: ApolloError) => message.error(reason.message))\r\n      })\r\n      .catch(() => message.error(\"Formulář nelze odeslat, opravte prosím chyby\"))\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (visible === true) {\r\n      form.resetFields()\r\n    }\r\n  }, [ form, visible ])\r\n\r\n  return guest === undefined ? null : (\r\n    <Drawer\r\n      closeIcon={ (\r\n        <Popconfirm\r\n          onCancel={ () => setConfirmClose(false) }\r\n          onConfirm={ () => {\r\n            setConfirmClose(false)\r\n            form.resetFields()\r\n            close()\r\n          } }\r\n          placement=\"rightTop\"\r\n          title=\"Zavřít formulář? Data ve formuláři budou ztracena\"\r\n          visible={ confirmClose }>\r\n          <CloseOutlined onClick={ () => {\r\n            if (form.isFieldsTouched()) {\r\n              setConfirmClose(true)\r\n            } else {\r\n              close()\r\n            }\r\n          } } />\r\n        </Popconfirm>\r\n      ) }\r\n      placement=\"left\"\r\n      title=\"Nový host\"\r\n      width={ 500 }\r\n      visible={ visible }\r\n      footer={\r\n        <Button\r\n          onClick={ submitForm }\r\n          type=\"primary\">\r\n          Uložit\r\n        </Button>\r\n      }\r\n      footerStyle={ {\r\n        padding: \"16px 20px\",\r\n        textAlign: \"right\"\r\n      } }>\r\n      <Skeleton\r\n        active\r\n        loading={ updateLoading }\r\n        paragraph={ { rows: 15 } }>\r\n        <Form\r\n          form={ form }\r\n          initialValues={ initialValues }\r\n          layout=\"vertical\"\r\n          name=\"guest\">\r\n          <Title level={ 5 }>Osobní údaje</Title>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Jméno\"\r\n            name=\"name\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder=\"Vaše Jméno\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Příjmení\"\r\n            name=\"surname\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder=\"Vaše Příjmení\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"E-Mail\"\r\n            name=\"email\"\r\n            required\r\n            rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\r\n            <Input\r\n              addonBefore={ emailPrefixIcon }\r\n              placeholder=\"e-mail\"\r\n              type=\"email\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Číslo OP\"\r\n            name=\"identity\">\r\n            <Input placeholder=\"číslo občanského průkazu\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Telefonní Číslo\"\r\n            name=\"phone\">\r\n            <Input placeholder=\"číslo\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Věk\"\r\n            name=\"age\">\r\n            <Select\r\n              options={ GuestFormHelper.ageOptions }\r\n              placeholder=\"vyberte ze seznamu\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"Pohlaví\"\r\n            name=\"gender\">\r\n            <Select\r\n              placeholder=\"vyberte ze seznamu\">\r\n              <Select.Option value=\"M\">Muž</Select.Option>\r\n              <Select.Option value=\"F\">Žena</Select.Option>\r\n            </Select>\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Číslo viza\"\r\n            name=\"visa\">\r\n            <Input placeholder=\"číslo visa\" />\r\n          </Form.Item>\r\n          <Title level={ 5 }>Trvalé bydliště</Title>\r\n          <Form.Item\r\n            label=\"Ulice\"\r\n            name={ [ \"address\", \"street\" ] }>\r\n            <Input placeholder=\"ulice\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"PSČ/Obec\">\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"psc\" ] }>\r\n                <Input placeholder=\"PSČ\" />\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"municipality\" ] }>\r\n                <Input placeholder=\"Obec\" />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"Občanství\">\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"selected\" ] }>\r\n                <Select style={ { width: \"100%\" } } placeholder=\"ze seznamu\">\r\n                  <Select.Option value=\"cze\">CZE</Select.Option>\r\n                  <Select.Option value=\"sk\">SK</Select.Option>\r\n                </Select>\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"new\" ] }>\r\n                <Input placeholder=\"ručně\" />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n        </Form>\r\n      </Skeleton>\r\n    </Drawer>\r\n  )\r\n}","import { Avatar, Button, List } from \"antd\"\r\nimport { Colors } from \"../../../../lib/components/Colors\"\r\nimport { ReservationGuest } from \"../../../../lib/Types\"\r\n\r\ninterface Props {\r\n  loading: boolean\r\n  openDrawer: (guest: ReservationGuest) => void\r\n  roommates?: ReservationGuest[]\r\n}\r\n\r\nexport const Roommates = ({\r\n  loading,\r\n  openDrawer,\r\n  roommates\r\n}: Props) => {\r\n  return roommates === undefined || roommates.length === 0 ? null : (\r\n    <List\r\n      bordered={ true }\r\n      className=\"guests-list\"\r\n      dataSource={ roommates }\r\n      header={ <h4>Spolubydlící</h4> }\r\n      itemLayout=\"horizontal\"\r\n      renderItem={ (roommate: ReservationGuest) => (\r\n        <List.Item\r\n          key={ roommate.id }\r\n          actions={\r\n            loading ? [] : [\r\n              <Button\r\n                key=\"edit\"\r\n                onClick={ () => {\r\n                  openDrawer(roommate)\r\n                  // setSelectedGuest(roommate)\r\n                  // setDrawerVisible(true)\r\n                } }\r\n                type=\"link\">\r\n                upravit\r\n              </Button>,\r\n            ]\r\n          }>\r\n          <List.Item.Meta\r\n            avatar={\r\n              <Avatar\r\n                gap={ 4 }\r\n                size=\"large\"\r\n                style={ {\r\n                  backgroundColor: Colors.getRandomColor()\r\n                } }>\r\n                { roommate.name.substring(0, 1).toUpperCase() }\r\n              </Avatar>\r\n            }\r\n            description={ roommate.email }\r\n            title={ `${ roommate.name } ${ roommate.surname }` } />\r\n        </List.Item>\r\n      ) } />\r\n  )\r\n}","import { useQuery } from \"@apollo/client\"\r\nimport { Spin } from \"antd\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { useParams } from \"react-router-dom\"\r\nimport { Guests_guests } from \"../../lib/graphql/queries/Guests/__generated__/Guests\"\r\nimport { RESERVATION_GUESTS } from \"../../lib/graphql/queries/ReservationGuests\"\r\nimport { ReservationGuests as ReservationGuestsData, ReservationGuestsVariables, ReservationGuests_reservationGuests_roommates } from \"../../lib/graphql/queries/ReservationGuests/__generated__/ReservationGuests\"\r\nimport { ReservationGuest } from \"../../lib/Types\"\r\nimport { Error } from \"./components/Error\"\r\nimport { Host } from \"./components/Host\"\r\nimport { ReservationGuestDrawer } from \"./components/ReservationGuestDrawer\"\r\nimport { Roommates } from \"./components/Roommates\"\r\n\r\ninterface Props {\r\n  setPageTitle: (title: string | null) => void\r\n}\r\n\r\nexport const ReservationGuests = ({ setPageTitle }: Props) => {\r\n\r\n  let { hash }: { hash: string } = useParams()\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ guest, setGuest ] = useState<ReservationGuest[]>()\r\n  const [ roommates, setRoommates ] = useState<ReservationGuest[]>()\r\n  const [ selectedGuest, setSelectedGuest ] = useState<ReservationGuest>()\r\n  const [ drawerVisible, setDrawerVisible ] = useState<boolean>(false)\r\n  const [ showError, setShowError ] = useState<boolean>(false)\r\n\r\n  const { loading: dataLoading, data } = useQuery<ReservationGuestsData, ReservationGuestsVariables>(RESERVATION_GUESTS, {\r\n    variables: { reservationHash: hash },\r\n    onCompleted: () => {\r\n      setPageTitle(t(\"guests.page-title\"))\r\n      setShowError(false)\r\n    },\r\n    onError: () => {\r\n      setPageTitle(null)\r\n      setShowError(true)\r\n    }\r\n  })\r\n\r\n  useEffect(() => {\r\n    const roommateList: Guests_guests[] = []\r\n    const guest = data?.reservationGuests?.guest\r\n    const roommates = data?.reservationGuests?.roommates\r\n    if (guest !== undefined && guest !== null) {\r\n      setGuest([ guest ])\r\n    }\r\n    if (roommates !== undefined && roommates !== null) {\r\n      roommates.forEach((roommate: ReservationGuests_reservationGuests_roommates | null) => {\r\n        if (roommate !== null) {\r\n          roommateList.push(roommate)\r\n        }\r\n      })\r\n      setRoommates(roommateList)\r\n    }\r\n  }, [ data ])\r\n\r\n  return (\r\n    <>\r\n      <Spin\r\n        spinning={ dataLoading }>\r\n        <Host\r\n          guest={ guest }\r\n          loading={ dataLoading }\r\n          openDrawer={ (reservationGuest: ReservationGuest) => {\r\n            setSelectedGuest(reservationGuest)\r\n            setDrawerVisible(true)\r\n          } } />\r\n        <Roommates\r\n          loading={ dataLoading }\r\n          openDrawer={ (roommate: ReservationGuest) => {\r\n            setSelectedGuest(roommate)\r\n            setDrawerVisible(true)\r\n          } }\r\n          roommates={ roommates } />\r\n        <Error show={ showError } />\r\n      </Spin>\r\n      <ReservationGuestDrawer\r\n        close={ () => setDrawerVisible(false) }\r\n        guest={ selectedGuest }\r\n        reservationHash={ hash }\r\n        visible={ drawerVisible } />\r\n    </>\r\n  )\r\n}","import Title from \"antd/lib/typography/Title\"\r\n\r\ninterface Props {\r\n  title: string | null\r\n}\r\n\r\nexport const PageTitle = ({\r\n  title\r\n}: Props) => {\r\n  return title === null ? null : (\r\n    <Title\r\n      level={ 3 }\r\n      style={ {\r\n        borderBottom: \"1px solid #e1e1e1\",\r\n        paddingBottom: \".3em\"\r\n      } }>\r\n      { title }\r\n    </Title>\r\n  )\r\n}","import { Affix, Layout } from \"antd\"\nimport { useState } from \"react\"\nimport { Route, Switch } from \"react-router-dom\"\nimport { Header } from \"./components/Header\"\nimport { NotFound } from \"../NotFound\"\nimport { Reservations } from \"../Reservations\"\nimport { Guests } from \"../Guests\"\nimport { Suites } from \"../Suites\"\nimport { Login } from \"../Login\"\nimport { paths, usernameKey } from \"../../lib/Constants\"\nimport { ReservationGuests } from \"../ReservationGuests\"\nimport { PageTitle } from \"./components/PageTitle\"\nimport { useTranslation } from \"react-i18next\"\nimport { MenuItemKey, User } from \"../../lib/Types\"\n\nexport const App = () => {\n\n  const { t } = useTranslation()\n\n  const [ pageTitle, setPageTitle ] = useState<string | null>(`${ t(\"loading\") }...`)\n  const [ selectedPage, setSelectedPage ] = useState<MenuItemKey>(\"user\")\n\n  const getUser = (): User | null => {\n    const username = localStorage.getItem(usernameKey)\n    return username !== null ? {\n      username\n    } : null\n  }\n\n  return (\n    <Layout id=\"app\">\n      <Affix offsetTop={ 0 } className=\"app__affix-header\">\n        <Header\n          selectedPage={ selectedPage }\n          user={ getUser() } />\n      </Affix>\n      <Layout.Header>\n        <PageTitle title={ pageTitle } />\n      </Layout.Header>\n      <Layout.Content className=\"app-content\">\n        <Switch>\n          <Route exact path={ paths.root }>\n            <Reservations\n              setPageTitle={ setPageTitle }\n              setSelectedPage={ setSelectedPage } />\n          </Route>\n          <Route exact path={ paths.suites }>\n            <Suites\n              setPageTitle={ setPageTitle }\n              setSelectedPage={ setSelectedPage } />\n          </Route>\n          <Route exact path={ paths.guests }>\n            <Guests\n              setPageTitle={ setPageTitle }\n              setSelectedPage={ setSelectedPage } />\n          </Route>\n          <Route exact path={ paths.login }>\n            <Login\n              setPageTitle={ setPageTitle } />\n          </Route>\n          <Route exact path={ paths.reservation_guests }>\n            <ReservationGuests\n              setPageTitle={ setPageTitle } />\n          </Route>\n          <Route path=\"*\">\n            <NotFound />\n          </Route>\n        </Switch>\n      </Layout.Content>\n    </Layout >\n  )\n}","import i18next from \"i18next\";\r\n\r\nimport Backend from \"i18next-http-backend\"\r\nimport { initReactI18next } from \"react-i18next\";\r\n\r\ni18next\r\n  .use(Backend)\r\n  .use(initReactI18next)\r\n  .init({\r\n    fallbackLng: \"cs\",\r\n    debug: false,\r\n    lng: \"cs\"\r\n  })\r\n\r\nexport default i18next\r\n","import ReactDOM from 'react-dom'\nimport { BrowserRouter as Router } from \"react-router-dom\"\nimport './index.css'\nimport { getCookie } from \"./lib/Cookie\"\nimport moment from 'moment'\nimport 'moment/locale/cs'\nimport { ApolloClient, ApolloError, ApolloLink, ApolloProvider, FetchResult, from, fromPromise, HttpLink, InMemoryCache } from '@apollo/client'\nimport { onError } from '@apollo/client/link/error'\nimport { App } from './sections/App'\nimport { ConfigProvider } from 'antd'\nimport csCZ from \"antd/lib/locale/cs_CZ\"\nimport { csrfTokenName, errorMessages, paths, refreshTokenName, tokenName, usernameKey } from './lib/Constants'\nimport { RefreshToken, RefreshToken_refreshToken } from './lib/graphql/mutations/Token/__generated__/RefreshToken'\nimport { TOKEN_REFRESH } from './lib/graphql/mutations/Token'\nimport \"./i18n\"\nimport { Suspense } from 'react'\nimport { Splash } from './sections/Splash'\n\nmoment.locale(\"cs\")\n\nlet apolloClient: any\n\nconst httpLink = new HttpLink({\n  uri: '/api'\n});\nconst authMiddleware = new ApolloLink((operation, forward) => {\n  const token = localStorage.getItem(tokenName)\n  const csrftoken = getCookie(csrfTokenName)\n  operation.setContext(({ headers = {} }) => ({\n    headers: {\n      ...headers,\n      \"Authorization\": token === null ? \"\" : `JWT ${ token }`,\n      \"X-CSRFToken\": csrftoken === null ? \"\" : csrftoken\n    }\n  }));\n  return forward(operation);\n})\n\nconst refreshToken = () => {\n  return apolloClient\n    .mutate({ mutation: TOKEN_REFRESH, variables: { refreshToken: localStorage.getItem(refreshTokenName) } })\n    .then((value: FetchResult<RefreshToken>) => {\n      return value.data?.refreshToken\n    })\n}\n\nconst errorLink = onError(\n  ({ graphQLErrors, networkError, operation, forward }) => {\n    if (graphQLErrors) {\n      for (let reason of graphQLErrors) {\n        switch (reason.message) {\n          case errorMessages.signatureExpired:\n            return fromPromise(\n              refreshToken()\n                .catch((reason: ApolloError) => console.error(reason))\n            )\n              .flatMap(authToken => {\n                const token = authToken as RefreshToken_refreshToken\n                localStorage.setItem(tokenName, token.token)\n                localStorage.setItem(refreshTokenName, token.refreshToken)\n                localStorage.setItem(usernameKey, token.payload.username)\n                // for debugging only\n                localStorage.setItem(\"tokenExpiresIn\", token.payload.exp.toString())\n                localStorage.setItem(\"refreshTokenExpiresIn\", token.refreshExpiresIn.toString())\n                // --- / ---\n                return forward(operation)\n              })\n          case errorMessages.refreshTokenExpired:\n          case errorMessages.unauthorized:\n            localStorage.removeItem(tokenName)\n            localStorage.removeItem(refreshTokenName)\n            localStorage.removeItem(usernameKey)\n            window.location.replace(paths.login)\n        }\n      }\n    }\n    if (networkError) {\n      console.error(networkError);\n    }\n  }\n)\n\napolloClient = new ApolloClient({\n  cache: new InMemoryCache({\n    typePolicies: {\n      Query: {\n        fields: {\n          guests: {\n            merge: false\n          },\n          reservations: {\n            merge: false\n          },\n          suiteReservations: {\n            merge: false\n          },\n          suites: {\n            merge: false\n          }\n        }\n      },\n      Reservation: {\n        fields: {\n          roommates: { merge: false }\n        }\n      }\n    }\n  }),\n  link: from([\n    errorLink,\n    authMiddleware,\n    httpLink\n  ]),\n})\n\nReactDOM.render(\n  <Suspense fallback={ <Splash /> }>\n    <ApolloProvider client={ apolloClient }>\n      <ConfigProvider locale={ csCZ }>\n        <Router>\n          <App />\n        </Router>\n      </ConfigProvider>\n    </ApolloProvider>\n  </Suspense>,\n  document.getElementById('root')\n);\n","import { Layout, Skeleton } from \"antd\"\r\nimport \"./index.css\"\r\n\r\nexport const Splash = () => {\r\n  return (\r\n    <Layout\r\n      className=\"splash-layout\">\r\n      <Layout.Content>\r\n        <Skeleton\r\n          active\r\n          avatar\r\n          paragraph={ { rows: 3 } }\r\n          className=\"splash-skeleton\" />\r\n        <Skeleton\r\n          active\r\n          avatar\r\n          paragraph={ { rows: 3 } }\r\n          className=\"splash-skeleton\" />\r\n        <Skeleton\r\n          active\r\n          avatar\r\n          paragraph={ { rows: 3 } }\r\n          className=\"splash-skeleton\" />\r\n      </Layout.Content>\r\n    </Layout>\r\n  )\r\n}"],"sourceRoot":""}