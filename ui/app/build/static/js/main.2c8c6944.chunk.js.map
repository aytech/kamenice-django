{"version":3,"sources":["lib/Types.ts","lib/Cookie.ts","sections/App/components/Header/assets/mill.svg","lib/components/Colors.ts","lib/components/UrlHelper.ts","lib/Constants.ts","lib/graphql/mutations/Token/index.ts","sections/App/components/Header/components/MenuItems/index.tsx","sections/App/components/Header/index.tsx","sections/NotFound/index.tsx","sections/Reservations/components/ReservationItem/index.tsx","lib/components/ReservationFormHelper.ts","lib/graphql/globalTypes.ts","lib/components/FormHelper.ts","lib/components/GuestFormHelper.ts","lib/graphql/mutations/Guest/index.ts","sections/GuestDrawer/index.tsx","lib/graphql/queries/Guests/index.ts","lib/graphql/mutations/Reservation/index.ts","lib/Prices.ts","sections/Reservations/components/ReservationModal/index.tsx","lib/graphql/queries/Suites/index.ts","sections/Reservations/index.tsx","sections/Guests/components/GuestItem.tsx","sections/Guests/index.tsx","lib/graphql/mutations/Suite/index.ts","sections/Suites/components/SuiteDrawer/components/RoomActions/index.tsx","sections/Suites/components/SuiteDrawer/index.tsx","sections/Suites/components/AddSuite/index.tsx","sections/Suites/components/SuiteItem/index.tsx","sections/Suites/index.tsx","sections/Login/index.tsx","lib/graphql/queries/ReservationGuests/index.ts","lib/graphql/mutations/Contact/index.ts","sections/ReservationGuests/components/Error/index.tsx","sections/ReservationGuests/components/Host/index.tsx","lib/graphql/mutations/ReservationGuest/index.ts","sections/ReservationGuests/components/ReservationGuestDrawer/index.tsx","sections/ReservationGuests/components/Roommates/index.tsx","sections/ReservationGuests/index.tsx","sections/App/components/PageTitle/index.tsx","sections/App/index.tsx","i18n.ts","index.tsx","sections/Splash/index.tsx"],"names":["GuestAge","GuestGender","getCookie","name","document","cookie","cookies","split","i","length","trim","substring","decodeURIComponent","Colors","colors","getRandomColor","Math","floor","random","getReservationColor","reservationType","UrlHelper","urlParts","window","location","search","undefined","dateFormat","errorMessages","paths","refreshTokenName","tokenName","usernameKey","TOKEN_AUTH","gql","TOKEN_REFRESH","TOKEN_REVOKE","MenuItems","withRouter","history","selectedPage","user","t","useTranslation","useMutation","revokeToken","redirectToLogin","useCallback","localStorage","removeItem","push","userAvatar","size","style","backgroundColor","username","toUpperCase","mode","className","selectedKeys","Item","icon","BookOutlined","to","IdcardOutlined","HomeOutlined","SubMenu","title","LogoutOutlined","onClick","refreshToken","getItem","variables","then","finally","Header","logoImage","src","logo","alt","NotFound","Content","status","subTitle","extra","type","ReservationItem","item","itemContext","getItemProps","getResizeProps","leftResizeProps","left","rightResizeProps","right","itemProps","useResizeHandle","content","color","fontWeight","start_time","format","end_time","maxHeight","dimensions","height","strong","Reservation","key","ReservationMeal","ReservationType","ReservationFormHelper","mealOptions","label","value","reservationOptions","getRequiredRule","message","required","FormHelper","requiredRule","GuestFormHelper","ageOptions","requiredAlphaRule","pattern","transform","CREATE_GUEST","UPDATE_GUEST","DELETE_GUEST","GuestDrawer","addGuest","close","guest","removeGuest","visible","Form","useForm","form","networkErrorHandler","reason","error","onError","createGuest","createLoading","loading","updateGuest","updateLoading","deleteGuest","deleteLoading","useState","confirmClose","setConfirmClose","initialValues","age","address","municipality","addressMunicipality","psc","addressPsc","street","addressStreet","citizenship","selected","email","gender","identity","phone","phoneNumber","surname","visa","visaNumber","emailPrefixIcon","noStyle","MailOutlined","useEffect","resetFields","closeIcon","onCancel","onConfirm","placement","CloseOutlined","isFieldsTouched","width","footer","cancelText","WarningOutlined","okText","guestId","id","data","success","danger","float","validateFields","formData","getFieldsValue","new","String","catch","footerStyle","padding","textAlign","active","paragraph","rows","layout","level","hasFeedback","rules","placeholder","addonBefore","options","Option","Group","compact","marginBottom","GUESTS","CREATE_RESERVATION","DELETE_RESERVATION","UPDATE_RESERVATION","Prices","getMealPrice","mealOption","roommates","finalPrice","getPrice","guestPrice","roommatesPrice","forEach","roommate","INFANT","CHILD","getMunicipalityFee","numberOfGuests","getAccomodationPrice","numberOfDays","suite","accomodationPrice","Number","priceBase","getPriceExtra","price","index","numberBeds","priceExtra","calculatePrice","reservationInput","priceAccommodation","priceMeal","priceMunicipality","priceTotal","toDate","endDate","moment","startDate","fromDate","ceil","duration","diff","asDays","meal","ReservationModal","addOrUpdateReservation","isOpen","clearReservation","reservation","onCompleted","createReservation","deleteReservation","updateReservation","useLazyQuery","getGuests","guestsLoading","guestsData","deleteConfirmVisible","setDeleteConfirmVisible","guestDrawerOpen","setGuestDrawerOpen","guestOptions","setGuestOptions","additionalInfoVisible","setAdditionalInfoVisible","pricesVisible","setPricesVisible","getGuestOption","dates","notes","purpose","Array","from","getReservationInput","formDates","getFieldValue","roommatesIds","suiteId","submitForm","guestValidator","validator","_rule","Promise","resolve","duplicate","filter","reject","Error","roommateValidator","duplicates","footerButtons","reservationId","CloseCircleOutlined","PlusCircleOutlined","EditOutlined","updatePrice","input","guests","find","setFieldsValue","setTimeout","spinning","tip","labelCol","span","wrapperCol","RangePicker","onChange","showTime","filterOption","option","match","toString","toLowerCase","indexOf","showSearch","List","fields","add","remove","map","fieldKey","restField","align","MinusCircleOutlined","offset","disabled","block","PlusOutlined","hidden","TextArea","allowClear","EyeInvisibleOutlined","EyeOutlined","Text","concat","SUITES","SUITES_WITH_RESERVATIONS","Reservations","setPageTitle","setSelectedPage","dataLoading","setDataLoading","groups","setGroups","items","setItems","setReservation","reservationModalOpen","setReservationModalOpen","selectedSuite","setSelectedSuite","reservationsData","useQuery","getTimelineReservationItem","group","background","border","reservationList","suiteList","suites","reservations","canChangeGroup","canMove","canResize","defaultTimeEnd","defaultTimeStart","groupRenderer","itemRenderer","props","lineHeight","onCanvasClick","groupId","time","selectedGroup","onItemClick","itemId","timelineItem","getRootProps","unit","styles","date","existingReservations","GuestItem","openGuestDrawer","selectGuest","actions","Meta","avatar","gap","description","Guests","drawerVisible","setDrawerVisible","setGuests","selectedGuest","setSelectedGuest","guestsList","bordered","dataSource","header","itemLayout","renderItem","existingGuests","cachedGuest","CREATE_SUITE","UPDATE_SUITE","DELETE_SUITE","RoomActions","deleteSuite","SuiteDrawer","addOrUpdateSuite","clearSuite","createSuite","updateSuite","beds","number","price_base","price_child","priceChild","price_extra","price_infant","priceInfant","console","AddSuite","hasAccess","onAdd","SuiteItem","openSuite","Suites","activeSuite","setActiveSuite","setSuites","setHasAccess","suitesData","suitesList","cachedSuite","lg","md","sm","tailLayout","xs","Login","token","tokenAuth","setItem","payload","getToken","loginLoading","onFinish","password","htmlType","RESERVATION_GUESTS","CONTACT_MESSAGE","show","createContactMessage","creatingMessage","Host","openDrawer","UPDATE_RESERVATON_GUEST","ReservationGuestDrawer","reservationHash","hash","updateReservationGuest","Roommates","ReservationGuests","useParams","setGuest","setRoommates","showError","setShowError","roommateList","reservationGuests","reservationGuest","PageTitle","borderBottom","paddingBottom","App","pageTitle","offsetTop","getUser","exact","path","i18next","use","Backend","initReactI18next","init","fallbackLng","debug","lng","apolloClient","Splash","locale","httpLink","HttpLink","uri","authMiddleware","ApolloLink","operation","forward","csrftoken","setContext","headers","errorLink","graphQLErrors","networkError","fromPromise","mutate","mutation","flatMap","authToken","exp","refreshExpiresIn","replace","ApolloClient","cache","InMemoryCache","typePolicies","Query","merge","suiteReservations","link","ReactDOM","render","fallback","ApolloProvider","client","csCZ","getElementById"],"mappings":"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","file":"static/js/main.2c8c6944.chunk.js","sourcesContent":["import { Moment } from \"moment\"\nimport { Guests_guests } from \"./graphql/queries/Guests/__generated__/Guests\"\nimport { Suites_suites } from \"./graphql/queries/Suites/__generated__/Suites\"\n\nexport type AppReferrer = \"/\" | \"/apartma\" | \"/guests\"\nexport type ReservationType = \"Závazná Rezervace\" | \"Nezávazná Rezervace\" | \"Aktuálně Ubytování\" | \"Obydlený Termín\"\nexport type ReservationTypeKey = \"BINDING\" | \"NONBINDING\" | \"ACCOMMODATED\" | \"INHABITED\"\nexport type MenuItemKey = \"reservation\" | \"guests\" | \"suites\" | \"user\"\n\nexport const Reservation = {\n  getType: (key: ReservationTypeKey): ReservationType => {\n    switch (key) {\n      case \"NONBINDING\":\n        return \"Nezávazná Rezervace\"\n      case \"ACCOMMODATED\":\n        return \"Aktuálně Ubytování\"\n      case \"INHABITED\":\n        return \"Obydlený Termín\"\n      case \"BINDING\":\n      default: return \"Závazná Rezervace\"\n    }\n  }\n}\n\nexport type ReservationMeal = \"BREAKFAST\" | \"HALFBOARD\" | \"NOMEAL\"\nexport type GuestsAge = \"ADULT\" | \"CHILD\" | \"INFANT\" | \"YOUNG\"\n\ninterface Address {\n  municipality?: string\n  psc?: number\n  street?: string\n}\n\ninterface Citizenship {\n  new?: string\n  selected?: string\n}\n\nexport interface GuestForm {\n  age: string,\n  address?: Address\n  citizenship?: Citizenship\n  email: string\n  gender?: string\n  id?: number\n  name: string\n  identity: string\n  phone: string\n  surname: string\n  visa?: string\n}\n\nexport interface Guest {\n  id?: number | string\n  name: string\n  surname: string\n}\n\nexport interface Suite {\n  id: number | string\n  number?: number | null\n  title?: string\n}\n\nexport interface Roommate extends Guest {\n  age: string | null\n}\n\nexport interface IReservation {\n  fromDate: Moment\n  guest?: Guest\n  meal?: ReservationMeal\n  id?: number | string\n  notes?: string | null\n  priceAccommodation: string | null\n  priceExtra: string | null\n  priceMeal: string | null\n  priceMunicipality: string | null\n  priceTotal: string | null\n  purpose?: string | null\n  roommates: Array<Roommate>\n  suite: Suite\n  toDate: Moment\n  type?: ReservationTypeKey\n}\n\nexport interface SuiteForm {\n  beds: number\n  number: number\n  price_base: number\n  price_child: number\n  price_extra: number\n  price_infant: number\n  title: string\n}\n\nexport interface OptionsType {\n  label: string\n  value: string | number\n}\n\nexport interface CustomGroupFields {\n  number: number | null\n  title: string\n}\n\nexport interface CustomItemFields {\n  color?: string\n  guest: Guest\n  meal: ReservationMeal\n  notes: string | null\n  priceAccommodation: string | null\n  priceExtra: string | null\n  priceMeal: string | null\n  priceMunicipality: string | null\n  priceTotal: string | null\n  purpose: string | null\n  roommates: Roommate[]\n  suite: Suite\n  type?: ReservationTypeKey\n}\n\nexport enum GuestAge {\n  ADULT = \"ADULT\",\n  CHILD = \"CHILD\",\n  INFANT = \"INFANT\",\n  YOUNG = \"YOUNG\",\n}\n\nexport enum GuestGender {\n  F = \"F\",\n  M = \"M\",\n}\n\nexport interface ReservationGuest {\n  __typename?: string;\n  age?: GuestAge | null;\n  addressMunicipality?: string | null;\n  addressPsc?: number | null;\n  addressStreet?: string | null;\n  citizenship?: string | null;\n  email?: string;\n  gender?: GuestGender | null;\n  identity?: string | null;\n  id?: number | string;\n  name: string;\n  phoneNumber?: string | null;\n  surname?: string;\n  visaNumber?: string | null;\n}\n\nexport interface User {\n  username: string\n}\n\nexport interface PriceInfo {\n  priceAccommodation: number\n  priceExtra: number\n  priceMeal: number\n  priceMunicipality?: number\n  priceTotal?: number\n}\n\nexport interface ReservationInputExtended {\n  guest?: Guests_guests | null\n  roommates?: Guests_guests[]\n  suite?: Suites_suites\n}","export const getCookie = (name: string): string | null => {\r\n  if (document.cookie && document.cookie !== '') {\r\n    const cookies = document.cookie.split(';');\r\n    for (let i = 0; i < cookies.length; i++) {\r\n      const cookie = cookies[ i ].trim();\r\n      // Does this cookie string begin with the name we want?\r\n      if (cookie.substring(0, name.length + 1) === (name + '=')) {\r\n        return decodeURIComponent(cookie.substring(name.length + 1));\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nexport const setCookie = (name: string, value: string): void => {\r\n  if (document.cookie && document.cookie !== '') {\r\n    document.cookie = `${ name }=${ value };path=/`\r\n  }\r\n}\r\n\r\nexport const deleteCookie = (name: string): void => {\r\n  const cookie = getCookie(name)\r\n  if (cookie !== null) {\r\n    setCookie(name, `${ cookie };expires=Thu, 01 Jan 1970 00:00:01 GMT`)\r\n  }\r\n}","export default __webpack_public_path__ + \"static/media/mill.1f872c17.svg\";","import { ReservationTypeKey } from \"../Types\"\r\n\r\ninterface Props {\r\n  colors: string[]\r\n  getRandomColor: () => string\r\n  getReservationColor: (reservationType: ReservationTypeKey) => string\r\n}\r\n\r\nexport const Colors: Props = {\r\n  colors: [\r\n    \"#f5222d\", // red\r\n    \"#fa541c\", // volcano\r\n    \"#fa8c16\", // orange\r\n    \"#faad14\", // gold\r\n    \"#fadb14\", // yellow\r\n    \"#a0d911\", // lime\r\n    \"#52c41a\", // green\r\n    \"#13c2c2\", // cyan\r\n    \"#1890ff\", // blue\r\n    \"#2f54eb\", // geekblue\r\n    \"#722ed1\", // purple\r\n    \"#eb2f96\", // magenta\r\n  ],\r\n  getRandomColor: () => {\r\n    return Colors.colors[ Math.floor(Math.random() * Colors.colors.length) ]\r\n  },\r\n  getReservationColor: (reservationType: ReservationTypeKey): string => {\r\n    switch (reservationType) {\r\n      case \"NONBINDING\":\r\n        return \"rgb(254, 223, 3)\"\r\n      case \"ACCOMMODATED\":\r\n        return \"rgb(0, 133, 182)\"\r\n      case \"INHABITED\":\r\n        return \"rgb(254, 127, 45)\"\r\n      case \"BINDING\":\r\n      default: return \"rgb(0, 212, 157)\"\r\n    }\r\n  }\r\n}","import { AppReferrer } from \"../Types\";\r\n\r\ninterface IUrlHelper {\r\n  getReferrer: () => AppReferrer\r\n}\r\n\r\nexport const UrlHelper: IUrlHelper = {\r\n  getReferrer: (): AppReferrer => {\r\n    const urlParts = window.location.search.substring(1).split(\"=\")\r\n    if (urlParts.length >= 2 && urlParts[ 1 ] !== undefined) {\r\n      return urlParts[ 1 ] as AppReferrer\r\n    }\r\n    return \"/\"\r\n  }\r\n}","export const apolloErrorUnauthorized: string = \"Unauthorized\"\nexport const csrfTokenName: string = \"csrftoken\"\nexport const defaultArrivalHour: number = 14\nexport const defaultDepartureHour: number = 10\nexport const dateFormat = \"YYYY-MM-DD HH:mm\"\nexport const errorMessages = {\n  invalidCredentials: \"Please enter valid credentials\",\n  refreshTokenExpired: \"Refresh token is expired\",\n  signatureExpired: \"Signature has expired\",\n  unauthorized: \"Unauthorized\"\n}\nexport const paths = {\n  guests: \"/guests\",\n  login: \"/login\",\n  reservation_guests: \"/rezervace/:hash/hoste\",\n  root: \"/\",\n  suites: \"/apartma\"\n}\nexport const refreshTokenName: string = \"refreshToken\"\nexport const tokenName: string = \"token\"\nexport const usernameKey: string = \"username\"","import { gql } from \"@apollo/client\";\r\n\r\nexport const TOKEN_AUTH = gql`\r\n  mutation TokenAuth($username: String!, $password: String!) {\r\n    tokenAuth(username: $username, password: $password) {\r\n      payload\r\n      refreshExpiresIn\r\n      refreshToken\r\n      token\r\n    }\r\n  }\r\n`\r\n\r\nexport const TOKEN_REFRESH = gql`\r\n  mutation RefreshToken($refreshToken: String!) {\r\n    refreshToken(refreshToken: $refreshToken) {\r\n      payload\r\n      refreshExpiresIn\r\n      refreshToken\r\n      token\r\n    }\r\n  }\r\n`\r\n\r\nexport const TOKEN_REVOKE = gql`\r\n  mutation RevokeToken($refreshToken: String!) {\r\n    revokeToken(refreshToken: $refreshToken) {\r\n      revoked\r\n    }\r\n  }\r\n`","import { BookOutlined, HomeOutlined, IdcardOutlined, LogoutOutlined } from \"@ant-design/icons\"\r\nimport { useMutation } from \"@apollo/client\"\r\nimport { Avatar, Menu } from \"antd\"\r\nimport { useCallback } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { Link, RouteComponentProps, withRouter } from \"react-router-dom\"\r\nimport { Colors } from \"../../../../../../lib/components/Colors\"\r\nimport { UrlHelper } from \"../../../../../../lib/components/UrlHelper\"\r\nimport { refreshTokenName, tokenName, usernameKey } from \"../../../../../../lib/Constants\"\r\nimport { TOKEN_REVOKE } from \"../../../../../../lib/graphql/mutations/Token\"\r\nimport { RevokeToken, RevokeTokenVariables } from \"../../../../../../lib/graphql/mutations/Token/__generated__/RevokeToken\"\r\nimport { MenuItemKey, User } from \"../../../../../../lib/Types\"\r\nimport \"./styles.css\"\r\n\r\ninterface Props {\r\n  selectedPage: MenuItemKey\r\n  user: User | null\r\n}\r\n\r\nexport const MenuItems = withRouter(({\r\n  history,\r\n  selectedPage,\r\n  user\r\n}: RouteComponentProps & Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ revokeToken ] = useMutation<RevokeToken, RevokeTokenVariables>(TOKEN_REVOKE)\r\n\r\n  const redirectToLogin = useCallback(() => {\r\n    localStorage.removeItem(usernameKey)\r\n    history.push(`/login?next=${ UrlHelper.getReferrer() }`)\r\n  }, [ history ])\r\n\r\n  const logout = (): void => {\r\n    const refreshToken = localStorage.getItem(refreshTokenName)\r\n    if (refreshToken !== null) {\r\n      revokeToken({ variables: { refreshToken } })\r\n        .then(() => {\r\n          localStorage.removeItem(tokenName)\r\n          localStorage.removeItem(refreshTokenName)\r\n        })\r\n        .finally(() => redirectToLogin())\r\n    } else {\r\n      redirectToLogin()\r\n    }\r\n  }\r\n\r\n  const userAvatar = user !== null ? (\r\n    <Avatar\r\n      size={ 32 }\r\n      style={ {\r\n        backgroundColor: Colors.getRandomColor()\r\n      } }>\r\n      { user.username.substring(0, 1).toUpperCase() }\r\n    </Avatar>\r\n  ) : null\r\n\r\n  return user !== null ? (\r\n    <>\r\n      <Menu\r\n        mode=\"horizontal\"\r\n        className=\"navigation-items\"\r\n        selectedKeys={ [ selectedPage ] }>\r\n        <Menu.Item key=\"reservation\" icon={ <BookOutlined /> }>\r\n          <Link to=\"/\">{ t(\"reservations.name\") }</Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"guests\" icon={ <IdcardOutlined /> }>\r\n          <Link to=\"/guests\">{ t(\"guests.name-pl\") }</Link>\r\n        </Menu.Item>\r\n        <Menu.Item key=\"suites\" icon={ <HomeOutlined /> }>\r\n          <Link to=\"/apartma\">{ t(\"living-units\") }</Link>\r\n        </Menu.Item>\r\n      </Menu >\r\n      <Menu\r\n        className=\"user\"\r\n        mode=\"horizontal\"\r\n        selectedKeys={ [ selectedPage ] }>\r\n        <Menu.SubMenu\r\n          key=\"user\"\r\n          title={ userAvatar }>\r\n          <Menu.Item\r\n            key=\"logout\"\r\n            icon={ <LogoutOutlined /> }\r\n            onClick={ logout }>\r\n            { t(\"logout\") }\r\n          </Menu.Item>\r\n        </Menu.SubMenu>\r\n      </Menu>\r\n    </>\r\n  ) : null\r\n})","import { Link } from 'react-router-dom'\nimport './styles.css'\nimport logo from './assets/mill.svg'\nimport { MenuItems } from './components/MenuItems'\nimport { PageHeader } from 'antd'\nimport { MenuItemKey, User } from '../../../../lib/Types'\n\ninterface Props {\n  selectedPage: MenuItemKey\n  user: User | null\n}\n\nexport const Header = ({\n  selectedPage,\n  user\n}: Props) => {\n\n  const logoImage = (\n    <img\n      className=\"logo\"\n      src={ logo }\n      alt=\"Kamenice logo\" />\n  )\n\n  const homeLink = () => {\n    return user !== null ? (\n      <Link to=\"/\">{ logoImage }</Link>\n    ) : logoImage\n  }\n\n  return (\n    <PageHeader>\n      { homeLink() }\n      <MenuItems\n        selectedPage={ selectedPage }\n        user={ user } />\n    </PageHeader>\n  )\n}","import { Button, Layout, Result } from \"antd\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\r\n\r\nexport const NotFound = withRouter(({ history }: RouteComponentProps) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return (\r\n    <Layout>\r\n      <Layout.Content>\r\n        <Result\r\n          status=\"404\"\r\n          title={ t(\"errors.oops\") }\r\n          subTitle={ t(\"errors.404\") }\r\n          extra={\r\n            <Button\r\n              onClick={ () => history.push(\"/\") }\r\n              type=\"primary\">\r\n              { t(\"go-home\") }\r\n            </Button>\r\n          } />\r\n      </Layout.Content>\r\n    </Layout>\r\n  )\r\n})","import { Popover } from \"antd\"\r\nimport { Moment } from \"moment\"\r\nimport { ReactCalendarItemRendererProps, TimelineItem } from \"react-calendar-timeline\"\r\nimport Text from \"antd/lib/typography/Text\"\r\nimport { CustomItemFields } from \"../../../../lib/Types\"\r\nimport { useTranslation } from \"react-i18next\"\r\n\r\nexport const ReservationItem = ({\r\n  item,\r\n  itemContext,\r\n  getItemProps,\r\n  getResizeProps\r\n}: ReactCalendarItemRendererProps<TimelineItem<CustomItemFields, Moment>>) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const { left: leftResizeProps, right: rightResizeProps } = getResizeProps()\r\n\r\n  return item.itemProps !== undefined ? (\r\n    <div { ...getItemProps(item.itemProps) }>\r\n      { itemContext.useResizeHandle ? <div { ...leftResizeProps } /> : '' }\r\n      <Popover title={ item.title } content={ (\r\n        <>\r\n          <div style={ { color: item.color, fontWeight: 700 } }>\r\n            { t(`reservation-types.${ item.type }`) }\r\n          </div>\r\n          <div>\r\n            { t(\"from\") }: <strong>{ item.start_time.format(\"DD MMM HH:mm\") }</strong>\r\n          </div>\r\n          <div>\r\n            { t(\"to\") }: <strong>{ item.end_time.format(\"DD MMM HH:mm\") }</strong>\r\n          </div>\r\n        </>\r\n      ) }>\r\n        <div\r\n          className=\"rct-item-content\"\r\n          style={ { maxHeight: `${ itemContext.dimensions.height }` } }>\r\n          <Text strong>{ item.title }</Text>\r\n        </div>\r\n      </Popover>\r\n      { itemContext.useResizeHandle ? <div { ...rightResizeProps } /> : '' }\r\n    </div>\r\n  ) : null\r\n}","import { Rule } from \"antd/lib/form\";\r\nimport { OptionsType, Reservation, ReservationTypeKey } from \"../Types\";\r\n\r\ninterface IReservationFormHelper {\r\n  getRequiredRule: (message: string) => Rule\r\n  mealOptions: OptionsType[]\r\n  reservationOptions: (OptionsType & { value: ReservationTypeKey })[]\r\n}\r\n\r\nexport const ReservationFormHelper: IReservationFormHelper = {\r\n  mealOptions: [\r\n    {\r\n      label: \"Bez Stravy\",\r\n      value: \"NOMEAL\"\r\n    },\r\n    {\r\n      label: \"Jen Snídaně\",\r\n      value: \"BREAKFAST\"\r\n    },\r\n    {\r\n      label: \"Polopenze\",\r\n      value: \"HALFBOARD\"\r\n    }\r\n  ],\r\n  reservationOptions: [\r\n    {\r\n      label: Reservation.getType(\"BINDING\"),\r\n      value: \"BINDING\"\r\n    },\r\n    {\r\n      label: Reservation.getType(\"NONBINDING\"),\r\n      value: \"NONBINDING\"\r\n    },\r\n    {\r\n      label: Reservation.getType(\"ACCOMMODATED\"),\r\n      value: \"ACCOMMODATED\"\r\n    },\r\n    {\r\n      label: Reservation.getType(\"INHABITED\"),\r\n      value: \"INHABITED\"\r\n    }\r\n  ],\r\n  getRequiredRule: (message: string): Rule => {\r\n    return { required: true, message }\r\n  }\r\n}","/* tslint:disable */\n/* eslint-disable */\n// @generated\n// This file was automatically generated and should not be edited.\n\n//==============================================================\n// START Enums and Input Objects\n//==============================================================\n\n/**\n * An enumeration.\n */\nexport enum GuestAge {\n  ADULT = \"ADULT\",\n  CHILD = \"CHILD\",\n  INFANT = \"INFANT\",\n  YOUNG = \"YOUNG\",\n}\n\n/**\n * An enumeration.\n */\nexport enum GuestGender {\n  F = \"F\",\n  M = \"M\",\n}\n\n/**\n * An enumeration.\n */\nexport enum ReservationMeal {\n  BREAKFAST = \"BREAKFAST\",\n  HALFBOARD = \"HALFBOARD\",\n  NOMEAL = \"NOMEAL\",\n}\n\n/**\n * An enumeration.\n */\nexport enum ReservationType {\n  ACCOMMODATED = \"ACCOMMODATED\",\n  BINDING = \"BINDING\",\n  INHABITED = \"INHABITED\",\n  NONBINDING = \"NONBINDING\",\n}\n\nexport interface ContactInput {\n  message?: string | null;\n}\n\nexport interface GuestInput {\n  age?: string | null;\n  addressMunicipality?: string | null;\n  addressPsc?: number | null;\n  addressStreet?: string | null;\n  citizenship?: string | null;\n  email?: string | null;\n  gender?: string | null;\n  id?: string | null;\n  identity?: string | null;\n  name?: string | null;\n  phoneNumber?: string | null;\n  surname?: string | null;\n  visaNumber?: string | null;\n}\n\nexport interface ReservationGuestInput {\n  age?: string | null;\n  addressMunicipality?: string | null;\n  addressPsc?: number | null;\n  addressStreet?: string | null;\n  citizenship?: string | null;\n  email?: string | null;\n  gender?: string | null;\n  id?: string | null;\n  identity?: string | null;\n  name?: string | null;\n  phoneNumber?: string | null;\n  surname?: string | null;\n  visaNumber?: string | null;\n  hash?: string | null;\n}\n\nexport interface ReservationInput {\n  fromDate?: string | null;\n  guestId?: number | null;\n  id?: string | null;\n  meal?: string | null;\n  notes?: string | null;\n  priceAccommodation?: any | null;\n  priceExtra?: any | null;\n  priceMeal?: any | null;\n  priceMunicipality?: any | null;\n  priceTotal?: any | null;\n  purpose?: string | null;\n  roommatesIds?: (number | null)[] | null;\n  suiteId?: number | null;\n  toDate?: string | null;\n  type?: string | null;\n}\n\nexport interface SuiteInput {\n  id?: string | null;\n  number?: number | null;\n  numberBeds?: number | null;\n  priceBase?: any | null;\n  priceChild?: any | null;\n  priceExtra?: any | null;\n  priceInfant?: any | null;\n  title?: string | null;\n}\n\n//==============================================================\n// END Enums and Input Objects\n//==============================================================\n","import { Rule } from \"antd/lib/form\"\r\n\r\ninterface IFormHelper {\r\n  requiredRule: (message: string) => Rule\r\n  trim: (value: string | undefined) => string | undefined\r\n}\r\nexport const FormHelper: IFormHelper = {\r\n  requiredRule: (message: string) => {\r\n    return {\r\n      required: true,\r\n      message: message\r\n    }\r\n  },\r\n  trim: (value: string | undefined): string | undefined => {\r\n    return value === undefined ? value : value.trim()\r\n  }\r\n}","import { Rule } from \"antd/lib/form\";\nimport { OptionsType } from \"../Types\";\nimport { FormHelper } from \"./FormHelper\";\n\ninterface IGuestFormHelper {\n  ageOptions: OptionsType[]\n  requiredAlphaRule: (message: string) => Rule\n}\n\nexport const GuestFormHelper: IGuestFormHelper = {\n  ageOptions: [\n    {\n      label: \"12+\",\n      value: \"YOUNG\"\n    },\n    {\n      label: \"3-12 let\",\n      value: \"CHILD\"\n    },\n    {\n      label: \"Do 3 let\",\n      value: \"INFANT\"\n    },\n    {\n      label: \"Dospělý\",\n      value: \"ADULT\"\n    }\n  ],\n  requiredAlphaRule: (message: string) => {\n    return {\n      message: message,\n      pattern: /^([A-Za-z\\sáÁčČďĎéÉěĚíÍňŇřŘšŠťŤúÚůŮýÝžŽóÓ])+$/,\n      transform: FormHelper.trim\n    }\n  }\n}","import { gql } from \"@apollo/client\"\n\nexport const CREATE_GUEST = gql`\n  mutation CreateGuest($data: GuestInput!) {\n    createGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n`\n\nexport const UPDATE_GUEST = gql`\n  mutation UpdateGuest($data: GuestInput!) {\n    updateGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n`\n\nexport const DELETE_GUEST = gql`\n  mutation DeleteGuest($guestId: ID!) {\n    deleteGuest(guestId: $guestId) {\n      guest {\n        id\n      }\n    }\n  }\n`","import { useState } from \"react\"\r\nimport { Button, Drawer, Form, Input, message, Popconfirm, Select, Skeleton } from \"antd\"\r\nimport { CloseOutlined, MailOutlined, WarningOutlined } from \"@ant-design/icons\"\r\nimport Title from \"antd/lib/typography/Title\"\r\nimport { Store } from \"rc-field-form/lib/interface\"\r\nimport { GuestForm } from \"../../lib/Types\"\r\nimport { GuestFormHelper } from \"../../lib/components/GuestFormHelper\"\r\nimport { FormHelper } from \"../../lib/components/FormHelper\"\r\nimport \"./styles.css\"\r\nimport { ApolloError, FetchResult, useMutation } from \"@apollo/client\"\r\nimport { CREATE_GUEST, DELETE_GUEST, UPDATE_GUEST } from \"../../lib/graphql/mutations/Guest\"\r\nimport { CreateGuest, CreateGuestVariables } from \"../../lib/graphql/mutations/Guest/__generated__/CreateGuest\"\r\nimport { GuestsFull_guests } from \"../../lib/graphql/queries/Guests/__generated__/GuestsFull\"\r\nimport { Guests_guests } from \"../../lib/graphql/queries/Guests/__generated__/Guests\"\r\nimport { UpdateGuest, UpdateGuestVariables } from \"../../lib/graphql/mutations/Guest/__generated__/UpdateGuest\"\r\nimport { useEffect } from \"react\"\r\nimport { DeleteGuest, DeleteGuestVariables } from \"../../lib/graphql/mutations/Guest/__generated__/DeleteGuest\"\r\nimport { useTranslation } from \"react-i18next\"\r\n\r\ninterface Props {\r\n  addGuest: (guest: Guests_guests) => void\r\n  close: () => void\r\n  guest?: GuestsFull_guests | null\r\n  removeGuest?: (guestId: string) => void\r\n  visible: boolean\r\n}\r\n\r\nexport const GuestDrawer = ({\r\n  addGuest,\r\n  close,\r\n  guest,\r\n  removeGuest,\r\n  visible\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const networkErrorHandler = (reason: ApolloError) => message.error(reason.message)\r\n\r\n  const [ createGuest, { loading: createLoading } ] = useMutation<CreateGuest, CreateGuestVariables>(CREATE_GUEST, {\r\n    onError: networkErrorHandler\r\n  })\r\n  const [ updateGuest, { loading: updateLoading } ] = useMutation<UpdateGuest, UpdateGuestVariables>(UPDATE_GUEST, {\r\n    onError: networkErrorHandler\r\n  })\r\n  const [ deleteGuest, { loading: deleteLoading } ] = useMutation<DeleteGuest, DeleteGuestVariables>(DELETE_GUEST, {\r\n    onError: networkErrorHandler\r\n  })\r\n\r\n  const [ confirmClose, setConfirmClose ] = useState<boolean>(false)\r\n\r\n  const initialValues: Store = {\r\n    age: guest?.age,\r\n    address: {\r\n      municipality: guest?.addressMunicipality,\r\n      psc: guest?.addressPsc,\r\n      street: guest?.addressStreet\r\n    },\r\n    citizenship: {\r\n      selected: guest?.citizenship\r\n    },\r\n    email: guest?.email,\r\n    gender: guest?.gender,\r\n    identity: guest?.identity,\r\n    name: guest?.name,\r\n    phone: guest?.phoneNumber,\r\n    surname: guest?.surname,\r\n    visa: guest?.visaNumber\r\n  }\r\n  const emailPrefixIcon = (\r\n    <Form.Item name=\"email-prefix\" noStyle>\r\n      <MailOutlined />\r\n    </Form.Item>\r\n  )\r\n\r\n  const submitForm = (): void => {\r\n    form.validateFields()\r\n      .then(() => {\r\n        const formData: GuestForm = form.getFieldsValue(true)\r\n        const variables = {\r\n          age: formData.age,\r\n          addressMunicipality: formData.address?.municipality,\r\n          addressPsc: formData.address?.psc,\r\n          addressStreet: formData.address?.street,\r\n          citizenship: formData.citizenship?.selected === undefined ? formData.citizenship?.new : formData.citizenship.selected,\r\n          email: formData.email,\r\n          gender: formData.gender,\r\n          identity: formData.identity,\r\n          name: formData.name,\r\n          phoneNumber: formData.phone,\r\n          surname: formData.surname,\r\n          visaNumber: formData.visa\r\n        }\r\n        if (guest === undefined || guest === null) {\r\n          createGuest({ variables: { data: { ...variables } } })\r\n            .then((value: FetchResult<CreateGuest>) => {\r\n              const guest = value.data?.createGuest?.guest\r\n              if (guest !== undefined && guest !== null) {\r\n                addGuest(guest)\r\n                message.success(t(\"guests.added\", { name: guest.name, surname: guest.surname }))\r\n              }\r\n              close()\r\n            })\r\n        } else {\r\n          updateGuest({ variables: { data: { id: String(guest.id), ...variables } } })\r\n            .then((value: FetchResult<UpdateGuest>) => {\r\n              const guest = value.data?.updateGuest?.guest\r\n              if (guest !== undefined && guest !== null) {\r\n                addGuest(guest)\r\n                message.success(t(\"guests.updated\", { name: guest.name, surname: guest.surname }))\r\n              }\r\n              close()\r\n            })\r\n        }\r\n      })\r\n      .catch(() => message.error(t(\"errors.invalid-form\")))\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (visible === true) {\r\n      form.resetFields()\r\n    }\r\n  }, [ form, visible ])\r\n\r\n  return (\r\n    <Drawer\r\n      closeIcon={ (\r\n        <Popconfirm\r\n          onCancel={ () => setConfirmClose(false) }\r\n          onConfirm={ () => {\r\n            setConfirmClose(false)\r\n            form.resetFields()\r\n            close()\r\n          } }\r\n          placement=\"rightTop\"\r\n          title={ t(\"forms.close-dirty\") }\r\n          visible={ confirmClose }>\r\n          <CloseOutlined onClick={ () => {\r\n            if (form.isFieldsTouched()) {\r\n              setConfirmClose(true)\r\n            } else {\r\n              close()\r\n            }\r\n          } } />\r\n        </Popconfirm>\r\n      ) }\r\n      placement=\"left\"\r\n      title={ t(\"guests.name\") }\r\n      width={ 500 }\r\n      visible={ visible }\r\n      footer={\r\n        <>\r\n          { guest !== undefined && guest !== null &&\r\n            <Popconfirm\r\n              cancelText={ t(\"no\") }\r\n              icon={ <WarningOutlined /> }\r\n              okText={ t(\"yes\") }\r\n              onConfirm={ () => {\r\n                deleteGuest({ variables: { guestId: guest.id } })\r\n                  .then((value: FetchResult<DeleteGuest>) => {\r\n                    const guest = value.data?.deleteGuest?.guest\r\n                    if (removeGuest !== undefined && guest !== undefined && guest !== null) {\r\n                      removeGuest(guest.id)\r\n                      message.success(t(\"guests.deleted\"))\r\n                      close()\r\n                    }\r\n                  })\r\n              } }\r\n              title={ t(\"forms.delete-confirm\") }>\r\n              <Button\r\n                danger\r\n                style={ {\r\n                  float: \"left\"\r\n                } }\r\n                type=\"primary\">\r\n                { t('forms.delete') }\r\n              </Button>\r\n            </Popconfirm>\r\n          }\r\n          <Button\r\n            onClick={ submitForm }\r\n            type=\"primary\">\r\n            { (guest === undefined || guest === null) ? t(\"forms.create\") : t(\"forms.update\") }\r\n          </Button>\r\n        </>\r\n      }\r\n      footerStyle={ {\r\n        padding: \"16px 20px\",\r\n        textAlign: \"right\"\r\n      } }>\r\n      <Skeleton\r\n        active\r\n        loading={ createLoading || updateLoading || deleteLoading }\r\n        paragraph={ { rows: 15 } }>\r\n        <Form\r\n          form={ form }\r\n          initialValues={ initialValues }\r\n          layout=\"vertical\"\r\n          name=\"guest\">\r\n          <Title level={ 5 }>\r\n            { t(\"forms.personal-data\") }\r\n          </Title>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"name\") }\r\n            name=\"name\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder={ t('forms.your-name') } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"surname\") }\r\n            name=\"surname\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder={ t(\"your-surname\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"email\") }\r\n            name=\"email\"\r\n            required\r\n            rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\r\n            <Input\r\n              addonBefore={ emailPrefixIcon }\r\n              placeholder={ t(\"email\") }\r\n              type=\"email\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"forms.id-number\") }\r\n            name=\"identity\">\r\n            <Input placeholder={ t(\"forms.id-number-full\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"phone-number\") }\r\n            name=\"phone\">\r\n            <Input placeholder={ t(\"number\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"age\") }\r\n            name=\"age\">\r\n            <Select\r\n              options={ GuestFormHelper.ageOptions }\r\n              placeholder={ t(\"forms.choose-from-list\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label={ t(\"sex\") }\r\n            name=\"gender\">\r\n            <Select\r\n              placeholder={ t(\"forms.choose-from-list\") }>\r\n              <Select.Option value=\"M\">{ t(\"man\") }</Select.Option>\r\n              <Select.Option value=\"F\">{ t(\"woman\") }</Select.Option>\r\n            </Select>\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label={ t(\"forms.visa-number\") }\r\n            name=\"visa\">\r\n            <Input placeholder={ t(\"forms.visa-number\") } />\r\n          </Form.Item>\r\n          <Title level={ 5 }>{ t(\"forms.address\") }</Title>\r\n          <Form.Item\r\n            label={ t(\"forms.street\") }\r\n            name={ [ \"address\", \"street\" ] }>\r\n            <Input placeholder={ t(\"forms.street\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label={ t(\"forms.psc-label\") }>\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"psc\" ] }>\r\n                <Input placeholder={ t(\"forms.psc\") } />\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"municipality\" ] }>\r\n                <Input placeholder={ t(\"forms.municipality\") } />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n          <Form.Item\r\n            label={ t(\"forms.citizenship\") }>\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"selected\" ] }>\r\n                <Select style={ { width: \"100%\" } } placeholder={ t(\"forms.from-list\") }>\r\n                  <Select.Option value=\"cze\">CZE</Select.Option>\r\n                  <Select.Option value=\"sk\">SK</Select.Option>\r\n                </Select>\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"new\" ] }>\r\n                <Input placeholder={ t(\"forms.by-hand\") } />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n        </Form>\r\n      </Skeleton>\r\n    </Drawer>\r\n  )\r\n}","import { gql } from \"@apollo/client\";\r\n\r\nexport const GUESTS = gql`\r\n  query Guests {\r\n    guests {\r\n      age\r\n      addressMunicipality\r\n      addressPsc\r\n      addressStreet\r\n      citizenship\r\n      email\r\n      gender\r\n      identity\r\n      id\r\n      name\r\n      phoneNumber\r\n      surname\r\n      visaNumber\r\n    }\r\n  }\r\n`","import { gql } from \"@apollo/client\";\r\n\r\nexport const CREATE_RESERVATION = gql`\r\n  mutation CreateReservation($data: ReservationInput!) {\r\n    createReservation(data: $data) {\r\n      reservation {\r\n        fromDate\r\n        id\r\n        guest {\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        meal\r\n        notes\r\n        priceAccommodation\r\n        priceExtra\r\n        priceMeal\r\n        priceMunicipality\r\n        priceTotal\r\n        purpose\r\n        roommates {\r\n          age\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        suite {\r\n          id\r\n          number\r\n          title\r\n        }\r\n        toDate\r\n        type\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const DELETE_RESERVATION = gql`\r\n  mutation DeleteReservation($reservationId: ID!) {\r\n    deleteReservation(reservationId: $reservationId) {\r\n      reservation {\r\n        id\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const UPDATE_RESERVATION = gql`\r\n  mutation UpdateReservation($data: ReservationInput!) {\r\n    updateReservation(data: $data) {\r\n      reservation {\r\n        fromDate\r\n        id\r\n        guest {\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        meal\r\n        notes\r\n        priceAccommodation\r\n        priceExtra\r\n        priceMeal\r\n        priceMunicipality\r\n        priceTotal\r\n        purpose\r\n        roommates {\r\n          age\r\n          id\r\n          name\r\n          surname\r\n        }\r\n        suite {\r\n          id\r\n          number\r\n          title\r\n        }\r\n        toDate\r\n        type\r\n      }\r\n    }\r\n  }\r\n`","import moment from \"moment\";\r\nimport { GuestAge, ReservationInput } from \"./graphql/globalTypes\";\r\nimport { Guests_guests } from \"./graphql/queries/Guests/__generated__/Guests\";\r\nimport { Suites_suites } from \"./graphql/queries/Suites/__generated__/Suites\";\r\nimport { PriceInfo, ReservationInputExtended, ReservationMeal } from \"./Types\";\r\n\r\ninterface IPrices {\r\n  calculatePrice: (reservationInput: ReservationInput & ReservationInputExtended) => PriceInfo\r\n  getAccomodationPrice: (numberOfDays: number, suite?: Suites_suites, guest?: Guests_guests | null, roommates?: Guests_guests[]) => number\r\n  getMealPrice: (mealOption?: ReservationMeal, guest?: Guests_guests | null, roommates?: Guests_guests[]) => number\r\n  getPriceExtra: (suite?: Suites_suites, roommates?: Guests_guests[]) => number\r\n  getMunicipalityFee: (guest?: Guests_guests | null, roommates?: Guests_guests[]) => number\r\n}\r\n\r\nexport const Prices: IPrices = {\r\n\r\n  getMealPrice: (mealOption?: ReservationMeal | null, guest?: Guests_guests | null, roommates?: Guests_guests[]) => {\r\n    let finalPrice: number = 0\r\n\r\n    const breakfastPrice: number = 80 // @TODO: make configurable\r\n    const halfBoardPrice: number = 200 // TODO: make configurable\r\n    const childDiscount: number = .40 // @TODO: 40%, make configurable\r\n    const getPrice = (guestPrice: number) => {\r\n      let roommatesPrice: number = 0\r\n      roommates?.forEach((roommate: Guests_guests) => {\r\n        switch (roommate.age) {\r\n          case GuestAge.INFANT: // Child has no meal option\r\n            break\r\n          case GuestAge.CHILD: // Apply discount\r\n            roommatesPrice = guestPrice - (guestPrice * childDiscount)\r\n            break\r\n          default: // 12+ and adults pay full price\r\n            roommatesPrice += guestPrice\r\n        }\r\n      })\r\n      if (guest !== undefined && guest !== null) {\r\n        return guestPrice + roommatesPrice\r\n      } else {\r\n        return roommatesPrice\r\n      }\r\n    }\r\n\r\n    switch (mealOption) {\r\n      case \"BREAKFAST\":\r\n        finalPrice = getPrice(breakfastPrice)\r\n        break\r\n      case \"HALFBOARD\":\r\n        finalPrice = getPrice(halfBoardPrice)\r\n        break\r\n    }\r\n\r\n    return finalPrice\r\n  },\r\n\r\n  getMunicipalityFee: (guest?: Guests_guests | null, roommates?: Guests_guests[]) => {\r\n    const municipalityFee = 21 // @TODO: make configurable\r\n    let numberOfGuests = 0\r\n\r\n    if (guest !== undefined && guest !== null) {\r\n      numberOfGuests++\r\n    }\r\n\r\n    if (roommates !== undefined) {\r\n      numberOfGuests += roommates.length\r\n    }\r\n\r\n    return municipalityFee * numberOfGuests\r\n  },\r\n\r\n  getAccomodationPrice: (numberOfDays: number, suite?: Suites_suites, guest?: Guests_guests | null, roommates?: Guests_guests[]) => {\r\n    let accomodationPrice: number = 0\r\n    if (suite !== undefined) {\r\n      const basePrice = Number(suite.priceBase)\r\n      accomodationPrice = basePrice\r\n\r\n      if (numberOfDays < 3) {\r\n        accomodationPrice = accomodationPrice * numberOfDays\r\n      } else {\r\n        accomodationPrice = (accomodationPrice * numberOfDays) - ((accomodationPrice * numberOfDays) * .12) // 12% discount. @TODO: make percent configurable\r\n      }\r\n    }\r\n    return accomodationPrice\r\n  },\r\n\r\n  getPriceExtra: (suite?: Suites_suites, roommates?: Guests_guests[]) => {\r\n    let price: number = 0\r\n\r\n    if (suite !== undefined) {\r\n      roommates?.forEach((roommate, index: number) => {\r\n        if ((index + 1) >= suite.numberBeds) { // Assuming +1 as roommate is an addition to a guest\r\n          price += Number(suite.priceExtra)\r\n        }\r\n      })\r\n    }\r\n\r\n    return price\r\n  },\r\n\r\n  // Basic formula:\r\n  // 1. Each room has price per day\r\n  // 2. Room price can be divided per number of guests, if all guests are 12+ of age\r\n  //    - Model: 2x room apartment is 1400 Kc, for 2 adult guests the price is 700 Kc each\r\n  // 3. If one of the guests in a child or infant, price is not halved, but 10% discount is given. @TODO make that percent configurable\r\n  // 4. If the stay is longer than 3 days, 12% discount is given for the price of the room. @TODO: make percent configurable \r\n  // 5. Meal:\r\n  //    - Breakfast: 80 Kc per person per day. @TODO make the price configurable\r\n  //    - Halfboard: 200 Kc per person per day. @TODO make the price configurable\r\n  //    - No meal. Free. Children under 3 cannot have meal ordered\r\n  //    - Discount: 40% for children 3-12 years of age. @TODO make the percent configurable\r\n  // 6. Municipality fee: 21 Kc per day per person\r\n  // Questions:\r\n  // 1. Model calculation:\r\n  //    - 4x room apartment, 2x adults, 1x child/infant?\r\n  //    - 2x room apartment, 2x adults, 1child/infant, 1 extra bed?\r\n  //    - 4x room apartment, 3 adults, 1 child/infant?\r\n  //    - 4x room apartment, 1 adult, 1 child/infant?\r\n  calculatePrice: (reservationInput: ReservationInput & ReservationInputExtended) => {\r\n\r\n    let priceAccommodation: number = 0\r\n    let priceMeal: number = 0\r\n    let priceExtra: number = 0\r\n    let priceMunicipality: number = 0\r\n    let priceTotal: number = 0\r\n    let numberOfDays: number = 0\r\n\r\n    if (reservationInput.toDate !== undefined && reservationInput.toDate !== null) {\r\n      const endDate = moment(reservationInput.toDate)\r\n      const startDate = moment(reservationInput.fromDate)\r\n      numberOfDays = Math.ceil(moment.duration(endDate.diff(startDate)).asDays())\r\n    }\r\n\r\n    priceAccommodation = Prices.getAccomodationPrice(numberOfDays, reservationInput.suite, reservationInput.guest, reservationInput.roommates)\r\n    priceMeal = Prices.getMealPrice(reservationInput.meal as ReservationMeal, reservationInput.guest, reservationInput.roommates)\r\n    priceExtra = Prices.getPriceExtra(reservationInput.suite, reservationInput.roommates)\r\n    priceTotal = priceAccommodation\r\n\r\n    // Calculate meal price only if guest or roommates were selected\r\n    if (\r\n      (reservationInput.guest !== undefined && reservationInput.guest !== undefined)\r\n      || (reservationInput.roommates !== undefined && reservationInput.roommates.length > 0)) {\r\n      priceMeal *= numberOfDays\r\n      priceTotal += priceMeal\r\n    }\r\n\r\n    if (priceExtra > 0) {\r\n      priceExtra *= numberOfDays\r\n    }\r\n\r\n    if (numberOfDays > 0) {\r\n      priceMunicipality = Prices.getMunicipalityFee(reservationInput.guest, reservationInput.roommates)\r\n    }\r\n\r\n    priceTotal += (priceExtra + priceMunicipality)\r\n\r\n    // Steps:\r\n    // 1. Calculate base price for a room.\r\n    // 2. Loop through roommates, apply formula:\r\n    //    - If room capacity is 2 and \r\n    //    - Figure out the rest\r\n    // 3. Apply discount if stay is longer than 3 days\r\n    // 4. Add meal price\r\n    // 5. Add municipality fee. For children also? ask\r\n\r\n    // @TODO\r\n    // 1. Calculate price per roommate with scenarios:\r\n    //    - 2x bed room with base price 1400\r\n    //      2x adults = full price\r\n    //      1x adult + 1x child = full price - 10%\r\n    //      2x adults + 1x child = ???\r\n    //    - 4x bed room with base price 2600\r\n    //      1x adult + 1x child = ???\r\n    //      2x adults + 1 child = ???\r\n    //      2x adults + 2x child = ???\r\n    //      extra bed calculation = ???\r\n    // 2. Calculate prices permeal:\r\n    //    - Just breakfast - + 80 Kc per person\r\n    //    - Polopenze - 200 Kc per person\r\n    //    - Deti - 40% sleva\r\n\r\n    return { priceAccommodation, priceExtra, priceMeal, priceMunicipality, priceTotal }\r\n  }\r\n}","import { useCallback, useEffect, useState } from \"react\"\nimport { Button, DatePicker, Form, Input, message, Modal, Popconfirm, Select, Space, Spin, Typography } from \"antd\"\nimport { Moment } from \"moment\"\nimport { ApolloError, useLazyQuery, useMutation } from \"@apollo/client\"\nimport { Store } from \"rc-field-form/lib/interface\"\nimport { CloseCircleOutlined, CloseOutlined, EditOutlined, EyeInvisibleOutlined, EyeOutlined, MinusCircleOutlined, PlusCircleOutlined, PlusOutlined } from \"@ant-design/icons\"\nimport \"./styles.css\"\nimport { IReservation, OptionsType, ReservationInputExtended, ReservationTypeKey } from \"../../../../lib/Types\"\nimport { ReservationFormHelper } from \"../../../../lib/components/ReservationFormHelper\"\nimport { FormHelper } from \"../../../../lib/components/FormHelper\"\nimport { ReservationInput } from \"../../../../lib/graphql/globalTypes\"\nimport { dateFormat } from \"../../../../lib/Constants\"\nimport { GuestDrawer } from \"../../../GuestDrawer\"\nimport { Guests, Guests_guests } from \"../../../../lib/graphql/queries/Guests/__generated__/Guests\"\nimport { GUESTS } from \"../../../../lib/graphql/queries/Guests\"\nimport { CreateReservation, CreateReservationVariables } from \"../../../../lib/graphql/mutations/Reservation/__generated__/CreateReservation\"\nimport { CREATE_RESERVATION, DELETE_RESERVATION, UPDATE_RESERVATION } from \"../../../../lib/graphql/mutations/Reservation\"\nimport { UpdateReservation, UpdateReservationVariables } from \"../../../../lib/graphql/mutations/Reservation/__generated__/UpdateReservation\"\nimport { DeleteReservation, DeleteReservationVariables } from \"../../../../lib/graphql/mutations/Reservation/__generated__/DeleteReservation\"\nimport { SuitesWithReservations_reservations } from \"../../../../lib/graphql/queries/Suites/__generated__/SuitesWithReservations\"\nimport { useTranslation } from \"react-i18next\"\nimport { Suites_suites } from \"../../../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport { Prices } from \"../../../../lib/Prices\"\nimport moment from \"moment\"\n\ninterface Props {\n  addOrUpdateReservation: (reservation?: SuitesWithReservations_reservations | null) => void\n  close: () => void\n  isOpen: boolean\n  clearReservation: (reservationId?: string | null) => void\n  reservation?: IReservation\n  suite?: Suites_suites\n}\n\nexport const ReservationModal = ({\n  addOrUpdateReservation,\n  close,\n  isOpen,\n  clearReservation,\n  reservation,\n  suite\n}: Props) => {\n\n  const { t } = useTranslation()\n\n  const networkErrorHandler = (reason: ApolloError) => message.error(reason.message)\n\n  const [ createReservation, { loading: createLoading } ] = useMutation<CreateReservation, CreateReservationVariables>(CREATE_RESERVATION, {\n    onCompleted: (data: CreateReservation) => {\n      addOrUpdateReservation(data.createReservation?.reservation)\n      message.success(t(\"reservations.created\"))\n      close()\n    },\n    onError: networkErrorHandler\n  })\n  const [ deleteReservation, { loading: deleteLoading } ] = useMutation<DeleteReservation, DeleteReservationVariables>(DELETE_RESERVATION, {\n    onCompleted: (data: DeleteReservation) => {\n      clearReservation(data.deleteReservation?.reservation?.id)\n      message.success(t(\"reservations.deleted\"))\n      close()\n    },\n    onError: networkErrorHandler\n  })\n  const [ updateReservation, { loading: updateLoading } ] = useMutation<UpdateReservation, UpdateReservationVariables>(UPDATE_RESERVATION, {\n    onCompleted: (data: UpdateReservation) => {\n      addOrUpdateReservation(data.updateReservation?.reservation)\n      message.success(t(\"reservations.updated\"))\n      close()\n    },\n    onError: networkErrorHandler\n  })\n  const [ getGuests, { loading: guestsLoading, data: guestsData } ] = useLazyQuery<Guests>(GUESTS, {\n    onError: networkErrorHandler\n  })\n\n  const [ deleteConfirmVisible, setDeleteConfirmVisible ] = useState<boolean>(false)\n  const [ guestDrawerOpen, setGuestDrawerOpen ] = useState<boolean>(false)\n  const [ guestOptions, setGuestOptions ] = useState<OptionsType[]>([])\n  const [ additionalInfoVisible, setAdditionalInfoVisible ] = useState<boolean>(false)\n  const [ pricesVisible, setPricesVisible ] = useState<boolean>(false)\n\n  const [ form ] = Form.useForm()\n\n  const getGuestOption = (guest: Guests_guests) => {\n    return {\n      label: `${ guest.name } ${ guest.surname }`,\n      value: guest.id\n    }\n  }\n\n  const addGuestOption = (guest: Guests_guests) => {\n    setGuestOptions(guestOptions.concat(getGuestOption(guest)))\n  }\n\n  const initialValues: Store & { type?: ReservationTypeKey } = reservation !== undefined ? {\n    dates: [ reservation.fromDate, reservation.toDate ],\n    guest: reservation.guest === undefined ? null : reservation.guest.id,\n    meal: reservation.meal,\n    notes: reservation.notes,\n    priceAccommodation: \"0.00\", // @TODO: calculate\n    priceExtra: \"0.00\", // @TODO: calculate\n    priceMeal: \"0.00\", // @TODO: calculate\n    priceMunicipality: \"0.00\", // @TODO: calculate\n    priceTotal: reservation.priceTotal,\n    purpose: reservation.purpose,\n    roommates: Array.from(reservation.roommates, roommate => {\n      return { id: roommate.id }\n    }),\n    type: reservation.type\n  } : { type: \"NONBINDING\" }\n\n  const getReservationInput = useCallback((): ReservationInput => {\n    const formData = form.getFieldsValue(true)\n    const formDates: Array<Moment> = form.getFieldValue(\"dates\")\n    let from, to: Moment\n\n    if (formDates === null) {\n      from = moment()\n      to = moment()\n    } else {\n      from = formDates[ 0 ]\n      to = formDates[ 1 ]\n    }\n\n    const roommates = formData.roommates === undefined ? [] :\n      Array.from(formData.roommates, (data: { id: number }) => data.id)\n    return {\n      fromDate: from.format(dateFormat),\n      guestId: formData.guest,\n      meal: formData.meal,\n      notes: formData.notes,\n      priceAccommodation: formData.priceAccommodation,\n      priceExtra: formData.priceExtra,\n      priceMeal: formData.priceMeal,\n      priceMunicipality: formData.priceMunicipality,\n      priceTotal: formData.priceTotal,\n      purpose: formData.purpose,\n      roommatesIds: roommates,\n      suiteId: reservation !== undefined ? +reservation.suite.id : null,\n      toDate: to.format(dateFormat),\n      type: formData.type\n    }\n  }, [ form, reservation ])\n\n  const submitForm = (): void => {\n    const variables: ReservationInput = getReservationInput()\n    if (reservation !== undefined && reservation.id !== undefined) {\n      updateReservation({ variables: { data: { id: String(reservation.id), ...variables } } })\n    } else {\n      createReservation({ variables: { data: { ...variables } } })\n    }\n  }\n\n  const guestValidator = [\n    {\n      message: t(\"forms.guest-duplicate\"),\n      validator: (_rule: any, value: number): Promise<void | Error> => {\n        const roommates: Array<{ id: number }> = form.getFieldValue(\"roommates\")\n        if (roommates === undefined || roommates.length === 0) {\n          return Promise.resolve()\n        }\n        const duplicate = roommates.filter((id: { id: number } | undefined) => {\n          return id !== undefined && id.id === value\n        })\n        if (duplicate === undefined || duplicate.length === 0) {\n          return Promise.resolve()\n        }\n        return Promise.reject(new Error(\"Fail guest validation, equals to roommate\"))\n      }\n    },\n    {\n      message: t(\"forms.choose-guest\"),\n      required: true\n    }\n  ]\n\n  const roommateValidator = [\n    {\n      message: t(\"forms.guest-selected\"),\n      validator: (_rule: any, value: number): Promise<void | Error> => {\n        const duplicates: Array<{ id: number }> = form.getFieldValue(\"roommates\").filter((id: { id: number } | undefined) => {\n          return id !== undefined && id.id === value\n        })\n        if (duplicates === undefined || duplicates.length <= 1) {\n          return Promise.resolve()\n        }\n        return Promise.reject(new Error(\"Fail roommate validation, duplicate value\"))\n      }\n    },\n    {\n      message: t(\"forms.guest-equals-roommate\"),\n      validator: (_rule: any, value: number): Promise<void | Error> => {\n        if (form.getFieldValue(\"guest\") !== value) {\n          return Promise.resolve()\n        }\n        return Promise.reject(new Error(\"Fail roommate validation, equals to guest\"))\n      }\n    }\n  ]\n\n  const getRemoveButton = () => {\n    return reservation !== undefined && reservation.id !== undefined ? (\n      <Popconfirm\n        cancelText={ t(\"no\") }\n        key=\"remove\"\n        okText={ t(\"yes\") }\n        onConfirm={ () => {\n          if (reservation.id !== undefined) {\n            deleteReservation({ variables: { reservationId: String(reservation.id) } })\n          }\n        } }\n        title={ `${ t(\"reservations.remove\") }?` }>\n        <Button\n          className=\"cancel-button\"\n          danger\n          icon={ <CloseCircleOutlined /> }>\n          { t(\"forms.delete\") }\n        </Button>\n      </Popconfirm>\n    ) : null\n  }\n\n  const footerButtons = [\n    getRemoveButton(),\n    <Button\n      key=\"guest\"\n      onClick={ () => setGuestDrawerOpen(true) }>\n      { t(\"guests.add\") }\n    </Button>,\n    <Button\n      key=\"create\"\n      icon={ reservation === undefined ? <PlusCircleOutlined /> : <EditOutlined /> }\n      onClick={ () => {\n        form.validateFields()\n          .then(submitForm)\n      } }\n      type=\"primary\">\n      { (reservation !== undefined && reservation.id !== undefined) ? t(\"forms.update\") : t(\"forms.save\") }\n    </Button>\n  ]\n\n  const updatePrice = useCallback(() => {\n    if (suite !== undefined && reservation !== undefined) {\n      const input: ReservationInput & ReservationInputExtended = getReservationInput()\n      input.suite = suite\n      input.roommates = []\n      if (input.guestId !== undefined && input.guestId !== null) {\n        input.guest = guestsData?.guests?.find(guest => guest?.id === input.guestId)\n      }\n      if (input.roommatesIds !== undefined && input.roommatesIds !== null && input.roommatesIds.length > 0) {\n        input.roommatesIds.forEach(id => {\n          const roommate = guestsData?.guests?.find(guest => guest?.id === String(id))\n          if (roommate !== undefined && roommate !== null) {\n            input.roommates?.push(roommate)\n          }\n        })\n      }\n      form.setFieldsValue(Prices.calculatePrice(input))\n    }\n  }, [ form, getReservationInput, guestsData, reservation, suite ])\n\n  useEffect(() => {\n    // Form instance is created on page load (before modal is open),\n    // but the component is rendered only when modal is opened\n    if (isOpen === true) {\n      form.resetFields()\n      getGuests()\n      updatePrice()\n    }\n  }, [ form, getGuests, isOpen, reservation, updatePrice ])\n\n  useEffect(() => {\n    if (guestsData !== undefined && guestsData.guests !== null) {\n      const options: OptionsType[] = []\n      guestsData.guests.forEach((guest: Guests_guests | null) => {\n        if (guest !== null) {\n          options.push(getGuestOption(guest))\n        }\n      })\n      setGuestOptions(options)\n    }\n  }, [ guestsData ])\n\n  const formLayout = {\n    labelCol: {\n      span: 8\n    },\n    wrapperCol: {\n      span: 16\n    }\n  }\n\n  return (\n    <>\n      <Modal\n        className=\"reservation-modal\"\n        closeIcon={ (\n          <Popconfirm\n            onCancel={ () => setDeleteConfirmVisible(false) }\n            onConfirm={ () => {\n              setDeleteConfirmVisible(false)\n              setTimeout(close)\n            } }\n            title={ t(\"forms.close-dirty\") }\n            visible={ deleteConfirmVisible }>\n            <CloseOutlined onClick={ () => {\n              if (form.isFieldsTouched()) {\n                setDeleteConfirmVisible(true)\n              } else {\n                close()\n              }\n            } } />\n          </Popconfirm>\n        ) }\n        footer={ footerButtons }\n        title={ t(\"reservations.form\") }\n        visible={ isOpen }>\n        <Spin\n          spinning={ guestsLoading || createLoading || deleteLoading || updateLoading }\n          tip={ `${ t(\"loading\") }...` }>\n          <Form\n            form={ form }\n            initialValues={ initialValues }\n            { ...formLayout }>\n            <Form.Item\n              label={ t(\"reservations.date\") }\n              name=\"dates\"\n              required>\n              <DatePicker.RangePicker\n                format={ dateFormat }\n                onChange={ updatePrice }\n                showTime />\n            </Form.Item>\n            <Form.Item\n              hasFeedback\n              label={ t(\"guests.name\") }\n              name=\"guest\"\n              required\n              rules={ guestValidator }>\n              <Select\n                filterOption={ (input, option): boolean => {\n                  const match = option?.label?.toString().toLowerCase().indexOf(input.toLowerCase())\n                  return match !== undefined && match >= 0\n                } }\n                onChange={ updatePrice }\n                options={ guestOptions }\n                showSearch />\n            </Form.Item>\n            <Form.List name=\"roommates\">\n              { (fields, { add, remove }) => (\n                <>\n                  { fields.map(({ key, name, fieldKey, ...restField }) => (\n                    <Space\n                      align=\"baseline\"\n                      className=\"roommate-list\"\n                      key={ key }>\n                      <Form.Item\n                        hasFeedback\n                        { ...restField }\n                        fieldKey={ [ fieldKey, 'first' ] }\n                        label={ t(\"reservations.roommate\") }\n                        name={ [ name, \"id\" ] }\n                        rules={ roommateValidator }>\n                        <Select\n                          onChange={ updatePrice }\n                          options={ guestOptions }\n                          showSearch />\n                      </Form.Item>\n                      <MinusCircleOutlined onClick={ () => {\n                        remove(name)\n                        form.validateFields()\n                        updatePrice()\n                      } } />\n                    </Space>\n                  )) }\n                  <Form.Item wrapperCol={ { offset: 8, span: 16 } }>\n                    <Button\n                      disabled={ fields.length >= guestOptions.length }\n                      type=\"dashed\"\n                      onClick={ () => add() }\n                      block\n                      icon={ <PlusOutlined /> }>\n                      { t(\"reservations.add-roommate\") }\n                    </Button>\n                  </Form.Item>\n                </>\n              ) }\n            </Form.List>\n            <Form.Item\n              hasFeedback\n              label={ t(\"reservations.type\") }\n              name=\"type\"\n              required\n              rules={ [ ReservationFormHelper.getRequiredRule(t(\"reservations.choose-type\")) ] }>\n              <Select\n                options={ ReservationFormHelper.reservationOptions } />\n            </Form.Item>\n            <Form.Item\n              hasFeedback\n              label={ t(\"reservations.meal\") }\n              name=\"meal\"\n              required\n              rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\n              <Select\n                onChange={ updatePrice }\n                options={ ReservationFormHelper.mealOptions } />\n            </Form.Item>\n            <Form.Item\n              hidden={ !additionalInfoVisible }\n              label={ t(\"reservations.purpose\") }\n              name=\"purpose\">\n              <Input placeholder={ t(\"reservations.purpose\") } />\n            </Form.Item>\n            <Form.Item\n              hidden={ !additionalInfoVisible }\n              label={ t(\"reservations.notes\") }\n              name=\"notes\">\n              <Input.TextArea\n                placeholder={ t(\"forms.enter-text\") }\n                allowClear />\n            </Form.Item>\n            <Form.Item wrapperCol={ { offset: 8, span: 16 } }>\n              <Button\n                block\n                onClick={ () => setAdditionalInfoVisible(!additionalInfoVisible) }\n                type=\"dashed\"\n                icon={ additionalInfoVisible ? <EyeInvisibleOutlined /> : <EyeOutlined /> }>\n                { additionalInfoVisible ? t(\"reservations.hide-info\") : t(\"reservations.show-info\") }\n              </Button>\n            </Form.Item>\n            {/* @TODO: add tooltips explaining price calculation */ }\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-room\") }>\n              <Typography.Text>\n                <strong>\n                  { suite?.priceBase } { t(\"rooms.currency\") }\n                </strong>\n              </Typography.Text>\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-accommodation\") }\n              name=\"priceAccommodation\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-extra\") }\n              name=\"priceExtra\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-meal\") }\n              name=\"priceMeal\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ t(\"reservations.price-municipality\") }\n              name=\"priceMunicipality\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item\n              hidden={ !pricesVisible }\n              label={ <strong>{ t(\"reservations.price-total\") }</strong> }\n              name=\"priceTotal\">\n              <Input addonBefore={ t(\"rooms.currency\") } type=\"number\" />\n            </Form.Item>\n            <Form.Item wrapperCol={ { offset: 8, span: 16 } }>\n              <Button\n                block\n                onClick={ () => setPricesVisible(!pricesVisible) }\n                type=\"dashed\"\n                icon={ pricesVisible ? <EyeInvisibleOutlined /> : <EyeOutlined /> }>\n                { pricesVisible ? t(\"reservations.hide-prices\") : t(\"reservations.show-prices\") }\n              </Button>\n            </Form.Item>\n          </Form>\n        </Spin>\n      </Modal>\n      <GuestDrawer\n        close={ () => setGuestDrawerOpen(false) }\n        addGuest={ addGuestOption }\n        visible={ guestDrawerOpen } />\n    </>\n  )\n}","import { gql } from \"@apollo/client\";\r\n\r\nexport const SUITES = gql`\r\n  query Suites {\r\n    suites {\r\n      id\r\n      number\r\n      numberBeds\r\n      priceBase\r\n      priceChild\r\n      priceExtra\r\n      priceInfant\r\n      title\r\n    }\r\n  }\r\n`\r\n\r\nexport const SUITES_WITH_RESERVATIONS = gql`\r\n  query SuitesWithReservations {\r\n    guests {\r\n      id\r\n      name\r\n      surname\r\n    }\r\n    suites {\r\n      id\r\n      number\r\n      numberBeds\r\n      priceBase\r\n      priceChild\r\n      priceExtra\r\n      priceInfant\r\n      title\r\n    }\r\n    reservations {\r\n      fromDate\r\n      id\r\n      guest {\r\n        id\r\n        name\r\n        surname\r\n      }\r\n      meal\r\n      notes\r\n      priceAccommodation\r\n      priceExtra\r\n      priceMeal\r\n      priceMunicipality\r\n      priceTotal\r\n      purpose\r\n      roommates {\r\n        age\r\n        id\r\n        name\r\n        surname\r\n      }\r\n      suite {\r\n        id\r\n      }\r\n      toDate\r\n      type\r\n    }\r\n  }\r\n`","import { RouteComponentProps, withRouter } from \"react-router-dom\"\nimport Title from \"antd/lib/typography/Title\"\nimport Timeline, { CursorMarker, DateHeader, SidebarHeader, TimelineGroup, TimelineHeaders, TimelineItem } from \"react-calendar-timeline\"\nimport { useEffect, useState } from \"react\"\nimport \"react-calendar-timeline/lib/Timeline.css\"\nimport \"./styles.css\"\nimport moment, { Moment } from \"moment\"\nimport { CustomGroupFields, CustomItemFields, IReservation, MenuItemKey } from \"../../lib/Types\"\nimport { Colors } from \"../../lib/components/Colors\"\nimport { ReservationItem } from \"./components/ReservationItem\"\nimport { ReservationModal } from \"./components/ReservationModal\"\nimport { ApolloError, useQuery } from \"@apollo/client\"\nimport { Suites_suites } from \"../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport { SUITES_WITH_RESERVATIONS } from \"../../lib/graphql/queries/Suites\"\nimport { SuitesWithReservations, SuitesWithReservations_reservations } from \"../../lib/graphql/queries/Suites/__generated__/SuitesWithReservations\"\nimport { message, Skeleton } from \"antd\"\nimport { useTranslation } from \"react-i18next\"\n\ninterface Props {\n  setPageTitle: (title: string) => void\n  setSelectedPage: (page: MenuItemKey) => void\n}\n\n// https://github.com/namespace-ee/react-calendar-timeline\nexport const Reservations = withRouter(({\n  setPageTitle,\n  setSelectedPage\n}: RouteComponentProps & Props) => {\n\n  const { t } = useTranslation()\n\n  const [ dataLoading, setDataLoading ] = useState<boolean>(true)\n  const [ groups, setGroups ] = useState<TimelineGroup<CustomGroupFields>[]>([])\n  const [ items, setItems ] = useState<TimelineItem<CustomItemFields, Moment>[]>([])\n  const [ reservation, setReservation ] = useState<IReservation>()\n  const [ reservationModalOpen, setReservationModalOpen ] = useState<boolean>(false)\n  const [ selectedSuite, setSelectedSuite ] = useState<Suites_suites>()\n\n  const { data: reservationsData } = useQuery<SuitesWithReservations>(SUITES_WITH_RESERVATIONS, {\n    onCompleted: () => {\n      setDataLoading(false)\n    },\n    onError: (reason: ApolloError) => message.error(reason.message)\n  })\n\n  const getTimelineReservationItem = (reservation: SuitesWithReservations_reservations): TimelineItem<CustomItemFields, Moment> => {\n    return {\n      color: Colors.getReservationColor(reservation.type),\n      end_time: moment(reservation.toDate),\n      group: reservation.suite.id,\n      guest: reservation.guest,\n      id: reservation.id,\n      itemProps: {\n        className: 'reservation-item',\n        style: {\n          background: Colors.getReservationColor(reservation.type),\n          border: \"none\"\n        }\n      },\n      meal: reservation.meal,\n      notes: reservation.notes,\n      priceAccommodation: reservation.priceAccommodation,\n      priceExtra: reservation.priceExtra,\n      priceMeal: reservation.priceMeal,\n      priceMunicipality: reservation.priceMunicipality,\n      priceTotal: reservation.priceTotal,\n      purpose: reservation.purpose,\n      roommates: reservation.roommates,\n      start_time: moment(reservation.fromDate),\n      suite: reservation.suite,\n      title: `${ reservation.guest.name } ${ reservation.guest.surname }`,\n      type: reservation.type\n    }\n  }\n\n  const addOrUpdateReservation = (reservation?: SuitesWithReservations_reservations | null) => {\n    if (reservation !== undefined && reservation !== null) {\n      const existingReservations = items.filter(item => item.id !== reservation.id)\n      setItems(existingReservations.concat(getTimelineReservationItem(reservation)))\n    }\n  }\n\n  const clearReservation = (reservationId?: string | null) => {\n    if (reservationId !== undefined && reservationId !== null) {\n      setItems(items.filter(item => item.id !== reservationId))\n    }\n    setReservation(undefined)\n  }\n\n  useEffect(() => {\n    const reservationList: TimelineItem<CustomItemFields, Moment>[] = []\n    const suiteList: TimelineGroup<CustomGroupFields>[] = []\n    reservationsData?.suites?.forEach((suite: Suites_suites | null) => {\n      if (suite !== null) {\n        suiteList.push(suite)\n      }\n    })\n    reservationsData?.reservations?.forEach((reservation: SuitesWithReservations_reservations | null) => {\n      if (reservation !== null) {\n        reservationList.push(getTimelineReservationItem(reservation))\n      }\n    })\n    setItems(reservationList)\n    setGroups(suiteList)\n  }, [ reservationsData ])\n\n  useEffect(() => {\n    setPageTitle(t(\"home-title\"))\n    setSelectedPage(\"reservation\")\n  }, [ setPageTitle, setSelectedPage, t ])\n\n  // Click on timeline outside of any reservation, \n  // opens modal for new reservation\n  const onCanvasClick = (groupId: number, time: number) => {\n    const selectedGroup = groups.find(group => group.id === groupId)\n    if (selectedGroup !== undefined) {\n      const suite = reservationsData?.suites?.find(suite => suite?.id === selectedGroup.id)\n      if (suite !== null) {\n        setSelectedSuite(suite)\n      }\n      setReservation({\n        fromDate: moment(time),\n        meal: \"NOMEAL\",\n        roommates: [],\n        suite: { ...selectedGroup },\n        priceAccommodation: \"0.00\",\n        priceExtra: \"0.00\",\n        priceMeal: \"0.00\",\n        priceMunicipality: \"0.00\",\n        priceTotal: \"0.00\",\n        toDate: moment(time).add(1, \"day\"),\n        type: \"NONBINDING\"\n      })\n      setReservationModalOpen(true)\n    }\n  }\n\n  // Click on item on the timeline opens modal\n  // with existing reservation for editing\n  const onItemClick = (itemId: number) => {\n    const timelineItem = items.find(item => item.id === itemId)\n    if (timelineItem !== undefined) {\n      const suite = reservationsData?.suites?.find(suite => suite?.id === timelineItem.suite.id)\n      if (suite !== null) {\n        setSelectedSuite(suite)\n      }\n      setReservation({\n        fromDate: moment(timelineItem.start_time),\n        guest: timelineItem.guest,\n        id: timelineItem.id,\n        meal: timelineItem.meal,\n        notes: timelineItem.notes,\n        priceAccommodation: timelineItem.priceAccommodation,\n        priceExtra: timelineItem.priceExtra,\n        priceMeal: timelineItem.priceMeal,\n        priceMunicipality: timelineItem.priceMunicipality,\n        priceTotal: timelineItem.priceTotal,\n        purpose: timelineItem.purpose,\n        roommates: timelineItem.roommates,\n        suite: timelineItem.suite,\n        toDate: moment(timelineItem.end_time),\n        type: timelineItem.type\n      })\n      setReservationModalOpen(true)\n    }\n  }\n\n  return (\n    <>\n      <Skeleton\n        active\n        loading={ dataLoading }\n        paragraph={ { rows: 5 } }>\n        <Timeline\n          canChangeGroup={ false }\n          canMove={ false }\n          canResize={ false }\n          defaultTimeEnd={ moment().add(12, \"day\") }\n          defaultTimeStart={ moment().add(-12, \"day\") }\n          groupRenderer={ ({ group }) => {\n            return (\n              <>\n                <Title level={ 5 }>{ group.title }</Title>\n              </>\n            )\n          } }\n          groups={ groups }\n          itemRenderer={ props => <ReservationItem { ...props } /> }\n          items={ items }\n          lineHeight={ 60 }\n          onCanvasClick={ onCanvasClick }\n          onItemClick={ onItemClick }>\n          <TimelineHeaders>\n            <SidebarHeader>\n              { ({ getRootProps }) => {\n                return (\n                  <div\n                    { ...getRootProps() }\n                    className=\"side-header\">\n                    { t(\"living-units\") }\n                  </div>\n                )\n              } }\n            </SidebarHeader>\n            <DateHeader unit=\"primaryHeader\" />\n            <DateHeader\n              className=\"days\"\n              unit=\"day\" />\n          </TimelineHeaders>\n          <CursorMarker>\n            {\n              ({ styles, date }) => {\n                return (\n                  <div style={ { ...styles, backgroundColor: \"rgba(136, 136, 136, 0.5)\", color: \"#888\" } }>\n                    <div className=\"rt-marker__label\">\n                      <div className=\"rt-marker__content\">\n                        { moment(date).format(\"DD MMM HH:mm\") }\n                      </div>\n                    </div>\n                  </div>\n                )\n              }\n            }\n          </CursorMarker>\n        </Timeline>\n      </Skeleton>\n      <ReservationModal\n        addOrUpdateReservation={ addOrUpdateReservation }\n        close={ () => {\n          setReservation(undefined)\n          setReservationModalOpen(false)\n        } }\n        isOpen={ reservationModalOpen }\n        clearReservation={ clearReservation }\n        reservation={ reservation }\n        suite={ selectedSuite } />\n    </>\n  )\n})","import { Avatar, Button, List } from \"antd\"\r\nimport { Colors } from \"../../../lib/components/Colors\"\r\nimport { Guests_guests } from \"../../../lib/graphql/queries/Guests/__generated__/Guests\"\r\n\r\ninterface Props {\r\n  guest: Guests_guests\r\n  openGuestDrawer: () => void\r\n  selectGuest: (guest: Guests_guests) => void\r\n}\r\n\r\nexport const GuestItem = ({\r\n  guest,\r\n  openGuestDrawer,\r\n  selectGuest\r\n}: Props) => {\r\n  return (\r\n    <List.Item\r\n      actions={ [\r\n        <Button\r\n          key=\"edit\"\r\n          onClick={ () => {\r\n            selectGuest(guest)\r\n            openGuestDrawer()\r\n          } }\r\n          type=\"link\">\r\n          upravit\r\n        </Button>,\r\n      ] }>\r\n      <List.Item.Meta\r\n        avatar={\r\n          <Avatar\r\n            gap={ 4 }\r\n            size=\"large\"\r\n            style={ {\r\n              backgroundColor: Colors.getRandomColor()\r\n            } }>\r\n            { guest.name.substring(0, 1).toUpperCase() }\r\n          </Avatar>\r\n        }\r\n        description={ guest.email }\r\n        title={ `${ guest.name } ${ guest.surname }` } />\r\n    </List.Item>\r\n  )\r\n}","import { useState } from \"react\"\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\nimport { Button, List, message, Skeleton } from \"antd\"\nimport { GUESTS } from \"../../lib/graphql/queries/Guests\"\nimport { Guests as GuestsData, Guests_guests } from \"../../lib/graphql/queries/Guests/__generated__/Guests\"\nimport { PlusCircleOutlined } from \"@ant-design/icons\"\nimport { ApolloError, useQuery } from \"@apollo/client\"\nimport { useEffect } from \"react\"\nimport { GuestDrawer } from \"../GuestDrawer\"\nimport \"./styles.css\"\nimport { GuestItem } from \"./components/GuestItem\"\nimport { useTranslation } from \"react-i18next\"\nimport { MenuItemKey } from \"../../lib/Types\"\n\ninterface Props {\n  setPageTitle: (title: string) => void\n  setSelectedPage: (page: MenuItemKey) => void\n}\n\nexport const Guests = withRouter(({\n  setPageTitle,\n  setSelectedPage\n}: RouteComponentProps & Props) => {\n\n  const { t } = useTranslation()\n\n  const [ dataLoading, setDataLoading ] = useState<boolean>(true)\n  const [ drawerVisible, setDrawerVisible ] = useState<boolean>(false)\n  const [ guests, setGuests ] = useState<Guests_guests[]>([])\n  const [ selectedGuest, setSelectedGuest ] = useState<Guests_guests | null>(null)\n\n  const { data: guestsData } = useQuery<GuestsData>(GUESTS, {\n    onCompleted: () => {\n      setDataLoading(false)\n    },\n    onError: (reason: ApolloError) => message.error(reason.message)\n  })\n\n  const addOrRemoveGuest = (guest: Guests_guests) => {\n    const existingGuests = guests.filter(cachedGuest => cachedGuest.id !== guest.id)\n    setGuests(existingGuests.concat(guest))\n  }\n\n  const removeGuest = (guestId: string) =>\n    setGuests(guests.filter(cachedGuest => cachedGuest.id !== guestId))\n\n  useEffect(() => {\n    const guestsList: Guests_guests[] = []\n    if (guestsData !== undefined && guestsData?.guests !== null) {\n      guestsData.guests.forEach((guest: Guests_guests | null) => {\n        if (guest !== null) {\n          guestsList.push(guest)\n        }\n      })\n      setGuests(guestsList)\n    }\n  }, [ guestsData ])\n\n  useEffect(() => {\n    setPageTitle(t(\"guests.page-title\"))\n    setSelectedPage(\"guests\")\n  }, [ setPageTitle, setSelectedPage, t ])\n\n  return (\n    <>\n      <Skeleton\n        active\n        loading={ dataLoading }\n        paragraph={ { rows: 5 } }>\n        <List\n          bordered={ true }\n          className=\"guests-list\"\n          dataSource={ guests }\n          footer={\n            <Button\n              icon={ <PlusCircleOutlined /> }\n              onClick={ () => {\n                setSelectedGuest(null)\n                setDrawerVisible(true)\n              } }\n              type=\"primary\">\n              { t(\"guests.add\") }\n            </Button>\n          }\n          header={ <h4>{ t(\"guests.list\") }</h4> }\n          itemLayout=\"horizontal\"\n          renderItem={ (guest: Guests_guests) => (\n            <GuestItem\n              guest={ guest }\n              openGuestDrawer={ () => setDrawerVisible(true) }\n              selectGuest={ setSelectedGuest } />\n          ) } />\n      </Skeleton>\n      <GuestDrawer\n        addGuest={ addOrRemoveGuest }\n        close={ () => setDrawerVisible(false) }\n        guest={ selectedGuest }\n        removeGuest={ removeGuest }\n        visible={ drawerVisible } />\n    </>\n  )\n})","import { gql } from \"@apollo/client\";\r\n\r\nexport const CREATE_SUITE = gql`\r\n  mutation CreateSuite($data: SuiteInput!) {\r\n    createSuite(data: $data) {\r\n      suite {\r\n        id\r\n        number\r\n        numberBeds\r\n        priceBase\r\n        priceChild\r\n        priceExtra\r\n        priceInfant\r\n        title\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const UPDATE_SUITE = gql`\r\n  mutation UpdateSuite($data: SuiteInput!) {\r\n    updateSuite(data: $data) {\r\n      suite {\r\n        id\r\n        number\r\n        numberBeds\r\n        priceBase\r\n        priceChild\r\n        priceExtra\r\n        priceInfant\r\n        title\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nexport const DELETE_SUITE = gql`\r\n  mutation DeleteSuite($suiteId: ID!) {\r\n    deleteSuite(suiteId: $suiteId) {\r\n      suite {\r\n        id\r\n      }\r\n    }\r\n  }\r\n`","import { WarningOutlined } from \"@ant-design/icons\"\r\nimport { Button, Popconfirm } from \"antd\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { Suites_suites } from \"../../../../../../lib/graphql/queries/Suites/__generated__/Suites\"\r\n\r\ninterface Props {\r\n  deleteSuite: (suiteId: string) => void\r\n  submitForm: () => void\r\n  suite?: Suites_suites\r\n}\r\n\r\nexport const RoomActions = ({\r\n  deleteSuite,\r\n  submitForm,\r\n  suite\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return (\r\n    <>\r\n      { suite !== undefined &&\r\n        <Popconfirm\r\n          cancelText={ t(\"no\") }\r\n          icon={ <WarningOutlined /> }\r\n          okText={ t(\"yes\") }\r\n          onConfirm={ () => {\r\n            deleteSuite(suite.id)\r\n          } }\r\n          title={ t(\"forms.delete-confirm\") }>\r\n          <Button\r\n            danger\r\n            style={ {\r\n              float: \"left\"\r\n            } }\r\n            type=\"primary\">\r\n            { t(\"forms.delete\") }\r\n          </Button>\r\n        </Popconfirm>\r\n      }\r\n      <Button\r\n        onClick={ submitForm }\r\n        type=\"primary\">\r\n        { suite === undefined ? t(\"forms.create\") : t(\"forms.update\") }\r\n      </Button>\r\n    </>\r\n  )\r\n}","import { useEffect, useState } from \"react\"\nimport { Drawer, Form, Input, message, Popconfirm, Spin } from \"antd\"\nimport { FormHelper } from \"../../../../lib/components/FormHelper\"\nimport { CloseOutlined } from \"@ant-design/icons\"\nimport { Suites_suites } from \"../../../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport { Store } from \"antd/lib/form/interface\"\nimport { SuiteForm } from \"../../../../lib/Types\"\nimport { ApolloError, FetchResult, useMutation } from \"@apollo/client\"\nimport { CreateSuite, CreateSuiteVariables } from \"../../../../lib/graphql/mutations/Suite/__generated__/CreateSuite\"\nimport { CREATE_SUITE, DELETE_SUITE, UPDATE_SUITE } from \"../../../../lib/graphql/mutations/Suite\"\nimport { UpdateSuite, UpdateSuiteVariables } from \"../../../../lib/graphql/mutations/Suite/__generated__/UpdateSuite\"\nimport { DeleteSuite, DeleteSuiteVariables } from \"../../../../lib/graphql/mutations/Suite/__generated__/DeleteSuite\"\nimport { useTranslation } from \"react-i18next\"\nimport { RoomActions } from \"./components/RoomActions\"\nimport Title from \"antd/lib/typography/Title\"\n\ninterface Props {\n  addOrUpdateSuite: (suite: Suites_suites) => void\n  clearSuite: (suiteId: string) => void\n  close: () => void\n  suite?: Suites_suites\n  visible: boolean\n}\n\nexport const SuiteDrawer = ({\n  addOrUpdateSuite,\n  clearSuite,\n  close,\n  suite,\n  visible\n}: Props) => {\n\n  const { t } = useTranslation()\n\n  const networkErrorHandler = (reason: ApolloError) => message.error(reason.message)\n\n  const [ createSuite, { loading: createLoading } ] = useMutation<CreateSuite, CreateSuiteVariables>(CREATE_SUITE, {\n    onError: networkErrorHandler\n  })\n  const [ deleteSuite, { loading: deleteLoading } ] = useMutation<DeleteSuite, DeleteSuiteVariables>(DELETE_SUITE, {\n    onError: networkErrorHandler\n  })\n  const [ updateSuite, { loading: updateLoading } ] = useMutation<UpdateSuite, UpdateSuiteVariables>(UPDATE_SUITE, {\n    onError: networkErrorHandler\n  })\n\n  const [ form ] = Form.useForm()\n\n  const [ confirmClose, setConfirmClose ] = useState<boolean>(false)\n\n  const initialValues: Store = {\n    beds: suite?.numberBeds,\n    number: suite?.number,\n    price_base: suite?.priceBase,\n    price_child: suite?.priceChild,\n    price_extra: suite?.priceExtra,\n    price_infant: suite?.priceInfant,\n    title: suite?.title\n  }\n\n  const submitForm = () => {\n    form.validateFields()\n      .then(() => {\n        const formData: SuiteForm = form.getFieldsValue(true)\n        const variables = {\n          number: formData.number,\n          numberBeds: formData.beds,\n          priceBase: formData.price_base,\n          priceChild: formData.price_child,\n          priceExtra: formData.price_extra,\n          priceInfant: formData.price_infant,\n          title: formData.title\n        }\n        if (suite === undefined) {\n          createSuite({ variables: { data: { ...variables } } })\n            .then((value: FetchResult<CreateSuite>) => {\n              const suite = value.data?.createSuite?.suite\n              if (suite !== undefined && suite !== null) {\n                addOrUpdateSuite(suite)\n                message.success(t(\"rooms.created\"))\n                close()\n              }\n            })\n        } else {\n          updateSuite({ variables: { data: { id: suite.id, ...variables } } })\n            .then((value: FetchResult<UpdateSuite>) => {\n              const suite = value.data?.updateSuite?.suite\n              if (suite !== undefined && suite !== null) {\n                addOrUpdateSuite(suite)\n                message.success(t(\"rooms.updated\"))\n                close()\n              }\n            })\n        }\n      })\n      .catch(() => {\n        console.error(\"Form validation failed\");\n      })\n  }\n\n  const deleteSuiteHandle = (suiteId: string) => {\n    deleteSuite({ variables: { suiteId } })\n      .then((value: FetchResult<DeleteSuite>) => {\n        const suiteId = value.data?.deleteSuite?.suite?.id\n        if (suiteId !== undefined) {\n          clearSuite(suiteId)\n          message.success(t(\"rooms.deleted\"))\n          close()\n        }\n      })\n  }\n\n  const closeDrawer = (): void => {\n    if (form.isFieldsTouched()) {\n      setConfirmClose(true)\n    } else {\n      close()\n    }\n  }\n\n  useEffect(() => {\n    if (visible === true) {\n      form.resetFields()\n    }\n  }, [ form, visible ])\n\n  return (\n    <Drawer\n      closeIcon={ (\n        <Popconfirm\n          onCancel={ () => setConfirmClose(false) }\n          onConfirm={ () => {\n            setConfirmClose(false)\n            close()\n          } }\n          placement=\"rightTop\"\n          title={ t(\"forms.close-dirty\") }\n          visible={ confirmClose }>\n          <CloseOutlined onClick={ closeDrawer } />\n        </Popconfirm>\n      ) }\n      footer={\n        <RoomActions\n          deleteSuite={ deleteSuiteHandle }\n          submitForm={ submitForm }\n          suite={ suite } />\n      }\n      footerStyle={ {\n        textAlign: \"right\"\n      } }\n      placement=\"left\"\n      title={ t(\"rooms.new\") }\n      visible={ visible }\n      width={ 500 }>\n      <Spin\n        size=\"large\"\n        spinning={\n          createLoading\n          || deleteLoading\n          || updateLoading\n        }\n        tip={ `${ t(\"loading\") }...` }>\n        <Form\n          form={ form }\n          initialValues={ initialValues }\n          layout=\"vertical\"\n          name=\"suite\">\n          <Form.Item\n            hasFeedback\n            label={ t(\"forms.name\") }\n            name=\"title\"\n            required\n            rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\n            <Input placeholder={ t(\"rooms.name\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.number-beds\") }\n            name=\"beds\"\n            required\n            rules={ [\n              FormHelper.requiredRule(t(\"forms.field-required\")),\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]+$/\n              }\n            ] }>\n            <Input placeholder={ t(\"rooms.number-beds\") } type=\"number\" />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"number\") }\n            name=\"number\"\n            required\n            rules={ [\n              FormHelper.requiredRule(t(\"forms.field-required\")),\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]+$/\n              }\n            ] }>\n            <Input placeholder={ t(\"rooms.number\") } type=\"number\" />\n          </Form.Item>\n          <Title level={ 5 }>{ t(\"rooms.prices-title\") }</Title>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-base\") }\n            name=\"price_base\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-child\") }\n            name=\"price_child\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-infant\") }\n            name=\"price_infant\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n          <Form.Item\n            hasFeedback\n            label={ t(\"rooms.price-extra\") }\n            name=\"price_extra\"\n            rules={ [\n              {\n                message: t(\"forms.enter-number\"),\n                pattern: /^[0-9]{1,4}(\\.[0-9]{1,2})?$/\n              }\n            ] }>\n            <Input addonBefore={ t(\"rooms.currency\") } />\n          </Form.Item>\n        </Form>\n      </Spin>\n    </Drawer>\n  )\n}","import { PlusCircleOutlined } from \"@ant-design/icons\";\r\nimport { Button } from \"antd\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\ninterface Props {\r\n  hasAccess: boolean\r\n  onAdd: () => void\r\n}\r\n\r\nexport const AddSuite = ({\r\n  hasAccess,\r\n  onAdd\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return hasAccess === true ? (\r\n    <Button\r\n      icon={ <PlusCircleOutlined /> }\r\n      onClick={ onAdd }\r\n      type=\"primary\">\r\n      { t(\"living-unit-add\") }\r\n    </Button>\r\n  ) : null\r\n}","import { HomeOutlined } from \"@ant-design/icons\"\r\nimport { Avatar, Button, List } from \"antd\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { Suites_suites } from \"../../../../lib/graphql/queries/Suites/__generated__/Suites\"\r\n\r\ninterface Props {\r\n  openSuite: (suite: Suites_suites) => void\r\n  suite: Suites_suites\r\n}\r\n\r\nexport const SuiteItem = ({\r\n  openSuite,\r\n  suite\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  return (\r\n    <List.Item\r\n      actions={ [\r\n        <Button\r\n          className=\"low-case\"\r\n          key=\"edit\"\r\n          onClick={ () => openSuite(suite) }\r\n          type=\"link\">\r\n          { t(\"forms.update\") }\r\n        </Button>\r\n      ] }\r\n      className=\"suite-item\"\r\n      onClick={ () => openSuite(suite) }>\r\n      <List.Item.Meta\r\n        avatar={\r\n          <Avatar gap={ 4 } size=\"large\">\r\n            <HomeOutlined />\r\n          </Avatar>\r\n        }\r\n        description={ `${ t(\"rooms.number\") } - ${ suite.number }` }\r\n        title={ suite.title } />\r\n    </List.Item>\r\n  )\r\n}","import { useEffect, useState } from \"react\"\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\nimport { List, message, Skeleton } from \"antd\"\nimport { SuiteDrawer } from \"./components/SuiteDrawer\"\nimport { Suites as SuitesData, Suites_suites } from \"../../lib/graphql/queries/Suites/__generated__/Suites\"\nimport \"./styles.css\"\nimport { AddSuite } from \"./components/AddSuite\"\nimport { ApolloError, useQuery } from \"@apollo/client\"\nimport { SUITES } from \"../../lib/graphql/queries/Suites\"\nimport { useTranslation } from \"react-i18next\"\nimport { MenuItemKey } from \"../../lib/Types\"\nimport { SuiteItem } from \"./components/SuiteItem\"\n\ninterface Props {\n  setPageTitle: (title: string) => void\n  setSelectedPage: (page: MenuItemKey) => void\n}\n\nexport const Suites = withRouter(({\n  setPageTitle,\n  setSelectedPage\n}: RouteComponentProps & Props) => {\n\n  const { t } = useTranslation()\n\n  const [ dataLoading, setDataLoading ] = useState<boolean>(true)\n  const [ drawerVisible, setDrawerVisible ] = useState<boolean>(false)\n  const [ activeSuite, setActiveSuite ] = useState<Suites_suites>()\n  const [ suites, setSuites ] = useState<Suites_suites[]>([])\n  const [ hasAccess, setHasAccess ] = useState<boolean>(false)\n\n  const { data: suitesData } = useQuery<SuitesData>(SUITES, {\n    onCompleted: () => {\n      setHasAccess(true)\n      setDataLoading(false)\n    },\n    onError: (reason: ApolloError) => {\n      message.error(reason.message)\n      setHasAccess(false)\n      setDataLoading(false)\n    }\n  })\n\n  const addOrUpdateSuite = (suite: Suites_suites) => {\n    setSuites(suites.filter(cachedSuite => cachedSuite.id !== suite.id).concat(suite))\n  }\n\n  const clearSuite = (suiteId: string) => {\n    setSuites(suites.filter(suite => suite.id !== suiteId))\n  }\n\n  const openSuite = (suite: Suites_suites | undefined) => {\n    setActiveSuite(suite)\n    setDrawerVisible(true)\n  }\n\n  useEffect(() => {\n    const suitesList: Suites_suites[] = []\n    suitesData?.suites?.forEach((suite: Suites_suites | null) => {\n      if (suite !== null) {\n        suitesList.push(suite)\n      }\n    })\n    setSuites(suitesList)\n  }, [ suitesData ])\n\n  useEffect(() => {\n    setPageTitle(t(\"living-units\"))\n    setSelectedPage(\"suites\")\n  }, [ setPageTitle, setSelectedPage, t ])\n\n  return (\n    <>\n      <Skeleton\n        active\n        loading={ dataLoading }\n        paragraph={ { rows: 5 } }>\n        <List\n          bordered={ true }\n          className=\"suites-list\"\n          dataSource={ suites }\n          footer={\n            <AddSuite\n              hasAccess={ hasAccess }\n              onAdd={ () => openSuite(undefined) } />\n          }\n          header={ <h4>{ t(\"living-units-list\") }</h4> }\n          itemLayout=\"horizontal\"\n          renderItem={ suite => (\n            <SuiteItem\n              openSuite={ openSuite }\n              suite={ suite } />\n          ) } />\n      </Skeleton>\n      <SuiteDrawer\n        addOrUpdateSuite={ addOrUpdateSuite }\n        clearSuite={ clearSuite }\n        close={ () => setDrawerVisible(false) }\n        suite={ activeSuite }\n        visible={ drawerVisible } />\n    </>\n  )\n})","import { ApolloError, useMutation } from \"@apollo/client\"\r\nimport { Button, Form, FormProps, Input, Layout, message, Spin } from \"antd\"\r\nimport { useEffect } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { RouteComponentProps, withRouter } from \"react-router-dom\"\r\nimport { UrlHelper } from \"../../lib/components/UrlHelper\"\r\nimport { errorMessages, refreshTokenName, tokenName, usernameKey } from \"../../lib/Constants\"\r\nimport { TOKEN_AUTH } from \"../../lib/graphql/mutations/Token\"\r\nimport { TokenAuth, TokenAuthVariables } from \"../../lib/graphql/mutations/Token/__generated__/TokenAuth\"\r\nimport \"./styles.css\"\r\n\r\ninterface Props {\r\n  setPageTitle: (title: string) => void\r\n}\r\n\r\nconst layout: FormProps = {\r\n  labelCol: {\r\n    lg: 8,\r\n    md: 8,\r\n    sm: 8\r\n  },\r\n  wrapperCol: {\r\n    lg: 16,\r\n    md: 16,\r\n    sm: 16,\r\n  },\r\n};\r\nconst tailLayout = {\r\n  wrapperCol: {\r\n    lg: {\r\n      offset: 8,\r\n      span: 16,\r\n    },\r\n    xs: {\r\n      offset: 0,\r\n      span: 24\r\n    }\r\n  },\r\n};\r\n\r\nexport const Login = withRouter(({\r\n  history,\r\n  setPageTitle\r\n}: RouteComponentProps & Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ getToken, { loading: loginLoading } ] = useMutation<TokenAuth, TokenAuthVariables>(TOKEN_AUTH, {\r\n    onCompleted: (token: TokenAuth) => {\r\n      if (token.tokenAuth !== null) {\r\n        localStorage.setItem(tokenName, token.tokenAuth.token)\r\n        localStorage.setItem(refreshTokenName, token.tokenAuth.refreshToken)\r\n        localStorage.setItem(usernameKey, token.tokenAuth.payload.username)\r\n        history.push(UrlHelper.getReferrer())\r\n      }\r\n    },\r\n    onError: (reason: ApolloError) => {\r\n      switch (reason.message) {\r\n        case errorMessages.invalidCredentials:\r\n          message.error(t(\"login.invalid-login\"))\r\n          break\r\n        default:\r\n          message.error(t(\"generic-error\"))\r\n      }\r\n    }\r\n  })\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const login = (data: { password: string, username: string }): void => {\r\n    getToken({\r\n      variables: {\r\n        password: data.password.trim(),\r\n        username: data.username.trim()\r\n      }\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    setPageTitle(t(\"pages.login\"))\r\n  }, [ setPageTitle, t ])\r\n\r\n  return (\r\n    <Layout.Content>\r\n      <Spin\r\n        spinning={ loginLoading }\r\n        tip={ `${ t(\"login.in-progress\") }...` }>\r\n        <Form\r\n          { ...layout }\r\n          className=\"login\"\r\n          form={ form }\r\n          name=\"login\"\r\n          onFinish={ login }>\r\n          <Form.Item\r\n            label={ t(\"name\") }\r\n            name=\"username\"\r\n            rules={ [ {\r\n              required: true,\r\n              message: t(\"forms.field-required\")\r\n            } ] }>\r\n            <Input type=\"text\" placeholder={ t(\"forms.user-name\") } />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"Heslo\"\r\n            name=\"password\"\r\n            rules={ [ {\r\n              required: true,\r\n              message: t(\"forms.field-required\")\r\n            } ] }>\r\n            <Input type=\"password\" placeholder={ t(\"forms.password\") } />\r\n          </Form.Item>\r\n          <Form.Item { ...tailLayout }>\r\n            <Button type=\"default\" htmlType=\"button\" onClick={ () => form.resetFields() }>\r\n              { t(\"forms.reset\") }\r\n            </Button>\r\n            <Button type=\"primary\" htmlType=\"submit\">\r\n              { t(\"forms.login\") }\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </Spin>\r\n    </Layout.Content>\r\n  )\r\n})","import { gql } from \"@apollo/client\";\r\n\r\nexport const RESERVATION_GUESTS = gql`\r\n  query ReservationGuests($reservationHash: String!) {\r\n    reservationGuests(reservationHash: $reservationHash) {\r\n      guest {\r\n        addressMunicipality\r\n        addressPsc\r\n        addressStreet\r\n        age\r\n        citizenship\r\n        email\r\n        gender\r\n        identity\r\n        id\r\n        name\r\n        phoneNumber\r\n        surname\r\n        visaNumber\r\n      }\r\n      roommates {\r\n        addressMunicipality\r\n        addressPsc\r\n        addressStreet\r\n        age\r\n        citizenship\r\n        email\r\n        gender\r\n        identity\r\n        id\r\n        name\r\n        phoneNumber\r\n        surname\r\n        visaNumber\r\n      }\r\n    }\r\n  }\r\n`","import { gql } from \"@apollo/client\";\r\n\r\nexport const CONTACT_MESSAGE = gql`\r\n  mutation CreateContactMessage($data: ContactInput!) {\r\n    createContactMessage(data: $data) {\r\n      contact {\r\n        message\r\n      }\r\n    }\r\n  }\r\n`","import { useMutation } from \"@apollo/client\"\r\nimport { Button, Form, Input, message, Result, Spin } from \"antd\"\r\nimport { CONTACT_MESSAGE } from \"../../../../lib/graphql/mutations/Contact\"\r\nimport { CreateContactMessage, CreateContactMessageVariables } from \"../../../../lib/graphql/mutations/Contact/__generated__/CreateContactMessage\"\r\n\r\ninterface Props {\r\n  show: boolean\r\n}\r\n\r\nexport const Error = ({\r\n  show\r\n}: Props) => {\r\n\r\n  const [ createContactMessage, { loading: creatingMessage } ] = useMutation<CreateContactMessage, CreateContactMessageVariables>(CONTACT_MESSAGE)\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const submitForm = () => {\r\n    form.validateFields()\r\n      .then(() => {\r\n        createContactMessage({ variables: { data: { message: form.getFieldValue(\"message\") } } })\r\n        .then(() => {\r\n          message.success(\"Vaše zpráva byla odeslána, děkujeme!\")\r\n          form.resetFields()\r\n        })\r\n      })\r\n      .catch(() => message.error(\"Formulář nelze odeslat, opravte prosím chyby\"))\r\n  }\r\n\r\n  return show === true ? (\r\n    <Spin\r\n      spinning={ creatingMessage }\r\n      tip=\"Posílám zprávu\">\r\n      <Result\r\n        status=\"error\"\r\n        title=\"Rezervace nenalezena\"\r\n        subTitle=\"Zanechte nám prosím zprávu, nebo nám zavolejte na +420 XXX XXX XXX\"\r\n        extra={\r\n          <Form\r\n            form={ form }\r\n            name=\"contact\"\r\n            onFinish={ submitForm }\r\n            wrapperCol={ {\r\n              offset: 6,\r\n              span: 12\r\n            } }>\r\n            <Form.Item\r\n              name=\"message\"\r\n              rules={ [\r\n                {\r\n                  required: true,\r\n                  message: \"Zadejte text zprávy\"\r\n                }\r\n              ] }>\r\n              <Input.TextArea rows={ 4 } />\r\n            </Form.Item>\r\n            <Form.Item>\r\n              <Button type=\"primary\" htmlType=\"submit\">\r\n                Odeslat\r\n              </Button>\r\n            </Form.Item>\r\n          </Form>\r\n        } />\r\n    </Spin>\r\n  ) : null\r\n}","import { Avatar, Button, List } from \"antd\"\r\nimport { Colors } from \"../../../../lib/components/Colors\"\r\nimport { ReservationGuest } from \"../../../../lib/Types\"\r\n\r\ninterface Props {\r\n  guest?: ReservationGuest[]\r\n  loading: boolean\r\n  openDrawer: (guest: ReservationGuest) => void\r\n}\r\n\r\nexport const Host = ({\r\n  guest,\r\n  loading,\r\n  openDrawer\r\n}: Props) => {\r\n  return guest === undefined ? null : (\r\n    <List\r\n      bordered={ true }\r\n      className=\"guests-list\"\r\n      dataSource={ guest }\r\n      header={ <h4>Host</h4> }\r\n      itemLayout=\"horizontal\"\r\n      renderItem={ (guest: ReservationGuest) => (\r\n        <List.Item\r\n          key={ guest.id }\r\n          actions={\r\n            loading ? [] : [\r\n              <Button\r\n                key=\"edit\"\r\n                onClick={ () => {\r\n                  openDrawer(guest)\r\n                  // setSelectedGuest(guest)\r\n                  // setDrawerVisible(true)\r\n                } }\r\n                type=\"link\">\r\n                upravit\r\n              </Button>,\r\n            ]\r\n          }>\r\n          <List.Item.Meta\r\n            avatar={\r\n              <Avatar\r\n                gap={ 4 }\r\n                size=\"large\"\r\n                style={ {\r\n                  backgroundColor: Colors.getRandomColor()\r\n                } }>\r\n                { guest.name.substring(0, 1).toUpperCase() }\r\n              </Avatar>\r\n            }\r\n            description={ guest.email }\r\n            title={ `${ guest.name } ${ guest.surname }` } />\r\n        </List.Item>\r\n      ) } />\r\n  )\r\n}","import { gql } from \"@apollo/client\";\r\n\r\nexport const UPDATE_RESERVATON_GUEST = gql`\r\n  mutation UpdateReservationGuest($data: ReservationGuestInput!) {\r\n    updateReservationGuest(data: $data) {\r\n      guest {\r\n        addressMunicipality\r\n        addressPsc\r\n        addressStreet\r\n        age\r\n        citizenship\r\n        email\r\n        gender\r\n        identity\r\n        id\r\n        name\r\n        phoneNumber\r\n        surname\r\n        visaNumber\r\n      }\r\n    }\r\n  }\r\n`","import { CloseOutlined, MailOutlined } from \"@ant-design/icons\"\r\nimport { ApolloError, FetchResult, useMutation } from \"@apollo/client\"\r\nimport { Button, Drawer, Form, Input, message, Popconfirm, Select, Skeleton } from \"antd\"\r\nimport { Store } from \"antd/lib/form/interface\"\r\nimport Title from \"antd/lib/typography/Title\"\r\nimport { useEffect } from \"react\"\r\nimport { useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { FormHelper } from \"../../../../lib/components/FormHelper\"\r\nimport { GuestFormHelper } from \"../../../../lib/components/GuestFormHelper\"\r\nimport { UPDATE_RESERVATON_GUEST } from \"../../../../lib/graphql/mutations/ReservationGuest\"\r\nimport { UpdateReservationGuest, UpdateReservationGuestVariables } from \"../../../../lib/graphql/mutations/ReservationGuest/__generated__/UpdateReservationGuest\"\r\nimport { GuestForm, ReservationGuest } from \"../../../../lib/Types\"\r\n\r\ninterface Props {\r\n  close: () => void\r\n  guest?: ReservationGuest\r\n  reservationHash: string\r\n  visible: boolean\r\n}\r\n\r\nexport const ReservationGuestDrawer = ({\r\n  close,\r\n  guest,\r\n  reservationHash,\r\n  visible\r\n}: Props) => {\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ updateGuest, { loading: updateLoading } ] = useMutation<UpdateReservationGuest, UpdateReservationGuestVariables>(UPDATE_RESERVATON_GUEST)\r\n\r\n  const [ confirmClose, setConfirmClose ] = useState<boolean>(false)\r\n\r\n  const [ form ] = Form.useForm()\r\n\r\n  const initialValues: Store = {\r\n    age: guest?.age,\r\n    address: {\r\n      municipality: guest?.addressMunicipality,\r\n      psc: guest?.addressPsc,\r\n      street: guest?.addressStreet\r\n    },\r\n    citizenship: {\r\n      selected: guest?.citizenship\r\n    },\r\n    email: guest?.email,\r\n    gender: guest?.gender,\r\n    identity: guest?.identity,\r\n    name: guest?.name,\r\n    phone: guest?.phoneNumber,\r\n    surname: guest?.surname,\r\n    visa: guest?.visaNumber\r\n  }\r\n  const emailPrefixIcon = (\r\n    <Form.Item name=\"email-prefix\" noStyle>\r\n      <MailOutlined />\r\n    </Form.Item>\r\n  )\r\n\r\n  const submitForm = (): void => {\r\n    form.validateFields()\r\n      .then(() => {\r\n        const formData: GuestForm = form.getFieldsValue(true)\r\n        const variables = {\r\n          age: formData.age,\r\n          addressMunicipality: formData.address?.municipality,\r\n          addressPsc: formData.address?.psc,\r\n          addressStreet: formData.address?.street,\r\n          citizenship: formData.citizenship?.selected === undefined ? formData.citizenship?.new : formData.citizenship.selected,\r\n          email: formData.email,\r\n          gender: formData.gender,\r\n          identity: formData.identity,\r\n          name: formData.name,\r\n          phoneNumber: formData.phone,\r\n          surname: formData.surname,\r\n          visaNumber: formData.visa\r\n        }\r\n        updateGuest({ variables: { data: { id: String(guest?.id), hash: reservationHash, ...variables } } })\r\n          .then((value: FetchResult<UpdateReservationGuest>) => {\r\n            const guest = value.data?.updateReservationGuest?.guest\r\n            if (guest !== undefined && guest !== null) {\r\n              message.success(`Host ${ guest.name } ${ guest.surname } aktualizován!`)\r\n            }\r\n            close()\r\n          })\r\n          .catch((reason: ApolloError) => message.error(reason.message))\r\n      })\r\n      .catch(() => message.error(\"Formulář nelze odeslat, opravte prosím chyby\"))\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (visible === true) {\r\n      form.resetFields()\r\n    }\r\n  }, [ form, visible ])\r\n\r\n  return guest === undefined ? null : (\r\n    <Drawer\r\n      closeIcon={ (\r\n        <Popconfirm\r\n          onCancel={ () => setConfirmClose(false) }\r\n          onConfirm={ () => {\r\n            setConfirmClose(false)\r\n            form.resetFields()\r\n            close()\r\n          } }\r\n          placement=\"rightTop\"\r\n          title=\"Zavřít formulář? Data ve formuláři budou ztracena\"\r\n          visible={ confirmClose }>\r\n          <CloseOutlined onClick={ () => {\r\n            if (form.isFieldsTouched()) {\r\n              setConfirmClose(true)\r\n            } else {\r\n              close()\r\n            }\r\n          } } />\r\n        </Popconfirm>\r\n      ) }\r\n      placement=\"left\"\r\n      title=\"Nový host\"\r\n      width={ 500 }\r\n      visible={ visible }\r\n      footer={\r\n        <Button\r\n          onClick={ submitForm }\r\n          type=\"primary\">\r\n          Uložit\r\n        </Button>\r\n      }\r\n      footerStyle={ {\r\n        padding: \"16px 20px\",\r\n        textAlign: \"right\"\r\n      } }>\r\n      <Skeleton\r\n        active\r\n        loading={ updateLoading }\r\n        paragraph={ { rows: 15 } }>\r\n        <Form\r\n          form={ form }\r\n          initialValues={ initialValues }\r\n          layout=\"vertical\"\r\n          name=\"guest\">\r\n          <Title level={ 5 }>Osobní údaje</Title>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Jméno\"\r\n            name=\"name\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder=\"Vaše Jméno\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Příjmení\"\r\n            name=\"surname\"\r\n            required\r\n            rules={ [\r\n              FormHelper.requiredRule(t(\"forms.field-required\")),\r\n              GuestFormHelper.requiredAlphaRule(t(\"forms.enter-text\"))\r\n            ] }>\r\n            <Input placeholder=\"Vaše Příjmení\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"E-Mail\"\r\n            name=\"email\"\r\n            required\r\n            rules={ [ FormHelper.requiredRule(t(\"forms.field-required\")) ] }>\r\n            <Input\r\n              addonBefore={ emailPrefixIcon }\r\n              placeholder=\"e-mail\"\r\n              type=\"email\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Číslo OP\"\r\n            name=\"identity\">\r\n            <Input placeholder=\"číslo občanského průkazu\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Telefonní Číslo\"\r\n            name=\"phone\">\r\n            <Input placeholder=\"číslo\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Věk\"\r\n            name=\"age\">\r\n            <Select\r\n              options={ GuestFormHelper.ageOptions }\r\n              placeholder=\"vyberte ze seznamu\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"Pohlaví\"\r\n            name=\"gender\">\r\n            <Select\r\n              placeholder=\"vyberte ze seznamu\">\r\n              <Select.Option value=\"M\">Muž</Select.Option>\r\n              <Select.Option value=\"F\">Žena</Select.Option>\r\n            </Select>\r\n          </Form.Item>\r\n          <Form.Item\r\n            hasFeedback\r\n            label=\"Číslo viza\"\r\n            name=\"visa\">\r\n            <Input placeholder=\"číslo visa\" />\r\n          </Form.Item>\r\n          <Title level={ 5 }>Trvalé bydliště</Title>\r\n          <Form.Item\r\n            label=\"Ulice\"\r\n            name={ [ \"address\", \"street\" ] }>\r\n            <Input placeholder=\"ulice\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"PSČ/Obec\">\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"psc\" ] }>\r\n                <Input placeholder=\"PSČ\" />\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { marginBottom: 0, width: \"50%\" } }\r\n                name={ [ \"address\", \"municipality\" ] }>\r\n                <Input placeholder=\"Obec\" />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n          <Form.Item\r\n            label=\"Občanství\">\r\n            <Input.Group compact>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"selected\" ] }>\r\n                <Select style={ { width: \"100%\" } } placeholder=\"ze seznamu\">\r\n                  <Select.Option value=\"cze\">CZE</Select.Option>\r\n                  <Select.Option value=\"sk\">SK</Select.Option>\r\n                </Select>\r\n              </Form.Item>\r\n              <Form.Item\r\n                style={ { width: \"50%\" } }\r\n                name={ [ \"citizenship\", \"new\" ] }>\r\n                <Input placeholder=\"ručně\" />\r\n              </Form.Item>\r\n            </Input.Group>\r\n          </Form.Item>\r\n        </Form>\r\n      </Skeleton>\r\n    </Drawer>\r\n  )\r\n}","import { Avatar, Button, List } from \"antd\"\r\nimport { Colors } from \"../../../../lib/components/Colors\"\r\nimport { ReservationGuest } from \"../../../../lib/Types\"\r\n\r\ninterface Props {\r\n  loading: boolean\r\n  openDrawer: (guest: ReservationGuest) => void\r\n  roommates?: ReservationGuest[]\r\n}\r\n\r\nexport const Roommates = ({\r\n  loading,\r\n  openDrawer,\r\n  roommates\r\n}: Props) => {\r\n  return roommates === undefined || roommates.length === 0 ? null : (\r\n    <List\r\n      bordered={ true }\r\n      className=\"guests-list\"\r\n      dataSource={ roommates }\r\n      header={ <h4>Spolubydlící</h4> }\r\n      itemLayout=\"horizontal\"\r\n      renderItem={ (roommate: ReservationGuest) => (\r\n        <List.Item\r\n          key={ roommate.id }\r\n          actions={\r\n            loading ? [] : [\r\n              <Button\r\n                key=\"edit\"\r\n                onClick={ () => {\r\n                  openDrawer(roommate)\r\n                  // setSelectedGuest(roommate)\r\n                  // setDrawerVisible(true)\r\n                } }\r\n                type=\"link\">\r\n                upravit\r\n              </Button>,\r\n            ]\r\n          }>\r\n          <List.Item.Meta\r\n            avatar={\r\n              <Avatar\r\n                gap={ 4 }\r\n                size=\"large\"\r\n                style={ {\r\n                  backgroundColor: Colors.getRandomColor()\r\n                } }>\r\n                { roommate.name.substring(0, 1).toUpperCase() }\r\n              </Avatar>\r\n            }\r\n            description={ roommate.email }\r\n            title={ `${ roommate.name } ${ roommate.surname }` } />\r\n        </List.Item>\r\n      ) } />\r\n  )\r\n}","import { useQuery } from \"@apollo/client\"\r\nimport { Spin } from \"antd\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { useParams } from \"react-router-dom\"\r\nimport { Guests_guests } from \"../../lib/graphql/queries/Guests/__generated__/Guests\"\r\nimport { RESERVATION_GUESTS } from \"../../lib/graphql/queries/ReservationGuests\"\r\nimport { ReservationGuests as ReservationGuestsData, ReservationGuestsVariables, ReservationGuests_reservationGuests_roommates } from \"../../lib/graphql/queries/ReservationGuests/__generated__/ReservationGuests\"\r\nimport { ReservationGuest } from \"../../lib/Types\"\r\nimport { Error } from \"./components/Error\"\r\nimport { Host } from \"./components/Host\"\r\nimport { ReservationGuestDrawer } from \"./components/ReservationGuestDrawer\"\r\nimport { Roommates } from \"./components/Roommates\"\r\n\r\ninterface Props {\r\n  setPageTitle: (title: string | null) => void\r\n}\r\n\r\nexport const ReservationGuests = ({ setPageTitle }: Props) => {\r\n\r\n  let { hash }: { hash: string } = useParams()\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const [ guest, setGuest ] = useState<ReservationGuest[]>()\r\n  const [ roommates, setRoommates ] = useState<ReservationGuest[]>()\r\n  const [ selectedGuest, setSelectedGuest ] = useState<ReservationGuest>()\r\n  const [ drawerVisible, setDrawerVisible ] = useState<boolean>(false)\r\n  const [ showError, setShowError ] = useState<boolean>(false)\r\n\r\n  const { loading: dataLoading, data } = useQuery<ReservationGuestsData, ReservationGuestsVariables>(RESERVATION_GUESTS, {\r\n    variables: { reservationHash: hash },\r\n    onCompleted: () => {\r\n      setPageTitle(t(\"guests.page-title\"))\r\n      setShowError(false)\r\n    },\r\n    onError: () => {\r\n      setPageTitle(null)\r\n      setShowError(true)\r\n    }\r\n  })\r\n\r\n  useEffect(() => {\r\n    const roommateList: Guests_guests[] = []\r\n    const guest = data?.reservationGuests?.guest\r\n    const roommates = data?.reservationGuests?.roommates\r\n    if (guest !== undefined && guest !== null) {\r\n      setGuest([ guest ])\r\n    }\r\n    if (roommates !== undefined && roommates !== null) {\r\n      roommates.forEach((roommate: ReservationGuests_reservationGuests_roommates | null) => {\r\n        if (roommate !== null) {\r\n          roommateList.push(roommate)\r\n        }\r\n      })\r\n      setRoommates(roommateList)\r\n    }\r\n  }, [ data ])\r\n\r\n  return (\r\n    <>\r\n      <Spin\r\n        spinning={ dataLoading }>\r\n        <Host\r\n          guest={ guest }\r\n          loading={ dataLoading }\r\n          openDrawer={ (reservationGuest: ReservationGuest) => {\r\n            setSelectedGuest(reservationGuest)\r\n            setDrawerVisible(true)\r\n          } } />\r\n        <Roommates\r\n          loading={ dataLoading }\r\n          openDrawer={ (roommate: ReservationGuest) => {\r\n            setSelectedGuest(roommate)\r\n            setDrawerVisible(true)\r\n          } }\r\n          roommates={ roommates } />\r\n        <Error show={ showError } />\r\n      </Spin>\r\n      <ReservationGuestDrawer\r\n        close={ () => setDrawerVisible(false) }\r\n        guest={ selectedGuest }\r\n        reservationHash={ hash }\r\n        visible={ drawerVisible } />\r\n    </>\r\n  )\r\n}","import Title from \"antd/lib/typography/Title\"\r\n\r\ninterface Props {\r\n  title: string | null\r\n}\r\n\r\nexport const PageTitle = ({\r\n  title\r\n}: Props) => {\r\n  return title === null ? null : (\r\n    <Title\r\n      level={ 3 }\r\n      style={ {\r\n        borderBottom: \"1px solid #e1e1e1\",\r\n        paddingBottom: \".3em\"\r\n      } }>\r\n      { title }\r\n    </Title>\r\n  )\r\n}","import { Affix, Layout } from \"antd\"\nimport { useState } from \"react\"\nimport { Route, Switch } from \"react-router-dom\"\nimport { Header } from \"./components/Header\"\nimport { NotFound } from \"../NotFound\"\nimport { Reservations } from \"../Reservations\"\nimport { Guests } from \"../Guests\"\nimport { Suites } from \"../Suites\"\nimport { Login } from \"../Login\"\nimport { paths, usernameKey } from \"../../lib/Constants\"\nimport { ReservationGuests } from \"../ReservationGuests\"\nimport { PageTitle } from \"./components/PageTitle\"\nimport { useTranslation } from \"react-i18next\"\nimport { MenuItemKey, User } from \"../../lib/Types\"\n\nexport const App = () => {\n\n  const { t } = useTranslation()\n\n  const [ pageTitle, setPageTitle ] = useState<string | null>(`${ t(\"loading\") }...`)\n  const [ selectedPage, setSelectedPage ] = useState<MenuItemKey>(\"user\")\n\n  const getUser = (): User | null => {\n    const username = localStorage.getItem(usernameKey)\n    return username !== null ? {\n      username\n    } : null\n  }\n\n  return (\n    <Layout id=\"app\">\n      <Affix offsetTop={ 0 } className=\"app__affix-header\">\n        <Header\n          selectedPage={ selectedPage }\n          user={ getUser() } />\n      </Affix>\n      <Layout.Header>\n        <PageTitle title={ pageTitle } />\n      </Layout.Header>\n      <Layout.Content className=\"app-content\">\n        <Switch>\n          <Route exact path={ paths.root }>\n            <Reservations\n              setPageTitle={ setPageTitle }\n              setSelectedPage={ setSelectedPage } />\n          </Route>\n          <Route exact path={ paths.suites }>\n            <Suites\n              setPageTitle={ setPageTitle }\n              setSelectedPage={ setSelectedPage } />\n          </Route>\n          <Route exact path={ paths.guests }>\n            <Guests\n              setPageTitle={ setPageTitle }\n              setSelectedPage={ setSelectedPage } />\n          </Route>\n          <Route exact path={ paths.login }>\n            <Login\n              setPageTitle={ setPageTitle } />\n          </Route>\n          <Route exact path={ paths.reservation_guests }>\n            <ReservationGuests\n              setPageTitle={ setPageTitle } />\n          </Route>\n          <Route path=\"*\">\n            <NotFound />\n          </Route>\n        </Switch>\n      </Layout.Content>\n    </Layout >\n  )\n}","import i18next from \"i18next\";\r\n\r\nimport Backend from \"i18next-http-backend\"\r\nimport { initReactI18next } from \"react-i18next\";\r\n\r\ni18next\r\n  .use(Backend)\r\n  .use(initReactI18next)\r\n  .init({\r\n    fallbackLng: \"cs\",\r\n    debug: false,\r\n    lng: \"cs\"\r\n  })\r\n\r\nexport default i18next\r\n","import ReactDOM from 'react-dom'\nimport { BrowserRouter as Router } from \"react-router-dom\"\nimport './index.css'\nimport { getCookie } from \"./lib/Cookie\"\nimport moment from 'moment'\nimport 'moment/locale/cs'\nimport { ApolloClient, ApolloError, ApolloLink, ApolloProvider, FetchResult, from, fromPromise, HttpLink, InMemoryCache } from '@apollo/client'\nimport { onError } from '@apollo/client/link/error'\nimport { App } from './sections/App'\nimport { ConfigProvider } from 'antd'\nimport csCZ from \"antd/lib/locale/cs_CZ\"\nimport { csrfTokenName, errorMessages, paths, refreshTokenName, tokenName, usernameKey } from './lib/Constants'\nimport { RefreshToken, RefreshToken_refreshToken } from './lib/graphql/mutations/Token/__generated__/RefreshToken'\nimport { TOKEN_REFRESH } from './lib/graphql/mutations/Token'\nimport \"./i18n\"\nimport { Suspense } from 'react'\nimport { Splash } from './sections/Splash'\n\nmoment.locale(\"cs\")\n\nlet apolloClient: any\n\nconst httpLink = new HttpLink({\n  uri: '/api'\n});\nconst authMiddleware = new ApolloLink((operation, forward) => {\n  const token = localStorage.getItem(tokenName)\n  const csrftoken = getCookie(csrfTokenName)\n  operation.setContext(({ headers = {} }) => ({\n    headers: {\n      ...headers,\n      \"Authorization\": token === null ? \"\" : `JWT ${ token }`,\n      \"X-CSRFToken\": csrftoken === null ? \"\" : csrftoken\n    }\n  }));\n  return forward(operation);\n})\n\nconst refreshToken = () => {\n  return apolloClient\n    .mutate({ mutation: TOKEN_REFRESH, variables: { refreshToken: localStorage.getItem(refreshTokenName) } })\n    .then((value: FetchResult<RefreshToken>) => {\n      return value.data?.refreshToken\n    })\n}\n\nconst errorLink = onError(\n  ({ graphQLErrors, networkError, operation, forward }) => {\n    if (graphQLErrors) {\n      for (let reason of graphQLErrors) {\n        switch (reason.message) {\n          case errorMessages.signatureExpired:\n            return fromPromise(\n              refreshToken()\n                .catch((reason: ApolloError) => console.error(reason))\n            )\n              .flatMap(authToken => {\n                const token = authToken as RefreshToken_refreshToken\n                localStorage.setItem(tokenName, token.token)\n                localStorage.setItem(refreshTokenName, token.refreshToken)\n                localStorage.setItem(usernameKey, token.payload.username)\n                // for debugging only\n                localStorage.setItem(\"tokenExpiresIn\", token.payload.exp.toString())\n                localStorage.setItem(\"refreshTokenExpiresIn\", token.refreshExpiresIn.toString())\n                // --- / ---\n                return forward(operation)\n              })\n          case errorMessages.refreshTokenExpired:\n          case errorMessages.unauthorized:\n            localStorage.removeItem(tokenName)\n            localStorage.removeItem(refreshTokenName)\n            localStorage.removeItem(usernameKey)\n            window.location.replace(paths.login)\n        }\n      }\n    }\n    if (networkError) {\n      console.error(networkError);\n    }\n  }\n)\n\napolloClient = new ApolloClient({\n  cache: new InMemoryCache({\n    typePolicies: {\n      Query: {\n        fields: {\n          guests: {\n            merge: false\n          },\n          reservations: {\n            merge: false\n          },\n          suiteReservations: {\n            merge: false\n          },\n          suites: {\n            merge: false\n          }\n        }\n      },\n      Reservation: {\n        fields: {\n          roommates: { merge: false }\n        }\n      }\n    }\n  }),\n  link: from([\n    errorLink,\n    authMiddleware,\n    httpLink\n  ]),\n})\n\nReactDOM.render(\n  <Suspense fallback={ <Splash /> }>\n    <ApolloProvider client={ apolloClient }>\n      <ConfigProvider locale={ csCZ }>\n        <Router>\n          <App />\n        </Router>\n      </ConfigProvider>\n    </ApolloProvider>\n  </Suspense>,\n  document.getElementById('root')\n);\n","import { Layout, Skeleton } from \"antd\"\r\nimport \"./index.css\"\r\n\r\nexport const Splash = () => {\r\n  return (\r\n    <Layout\r\n      className=\"splash-layout\">\r\n      <Layout.Content>\r\n        <Skeleton\r\n          active\r\n          avatar\r\n          paragraph={ { rows: 3 } }\r\n          className=\"splash-skeleton\" />\r\n        <Skeleton\r\n          active\r\n          avatar\r\n          paragraph={ { rows: 3 } }\r\n          className=\"splash-skeleton\" />\r\n        <Skeleton\r\n          active\r\n          avatar\r\n          paragraph={ { rows: 3 } }\r\n          className=\"splash-skeleton\" />\r\n      </Layout.Content>\r\n    </Layout>\r\n  )\r\n}"],"sourceRoot":""}