(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{318:function(e,t,n){},320:function(e,t,n){},321:function(e,t,n){},428:function(e,t,n){},513:function(e,t,n){},514:function(e,t,n){},520:function(e,t,n){},521:function(e,t,n){},522:function(e,t,n){},523:function(e,t,n){},527:function(e,t,n){"use strict";n.r(t);var a,r,i,s,c,o=n(279),l=n(30),d=n(41),u=n.n(d),j=n(65),m=(n(318),function(e){if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var a=t[n].trim();if(a.substring(0,e.length+1)===e+"=")return decodeURIComponent(a.substring(e.length+1))}return null}),b=n(37),p=n.n(b),O=(n(319),n(546)),h=n(150),v=n(537),f=n(544),g=n(547),x=n(538),y=n(539),I=n(294),k=n(17),S=n(533),C=n(554),F=n(0),N=n(48),T=(n(320),n.p+"static/media/mill.1f872c17.svg"),w=n(560),E=n(561),D=n(562),M=n(563),R=n(559),z=n(299),A=n(235),P=n(556),q={colors:["#f5222d","#fa541c","#fa8c16","#faad14","#fadb14","#a0d911","#52c41a","#13c2c2","#1890ff","#2f54eb","#722ed1","#eb2f96"],getRandomColor:function(){return q.colors[Math.floor(Math.random()*q.colors.length)]},getReservationColor:function(e){switch(e){case"NONBINDING":return"rgb(254, 223, 3)";case"ACCOMMODATED":return"rgb(0, 133, 182)";case"INHABITED":return"rgb(254, 127, 45)";case"BINDING":default:return"rgb(0, 212, 157)"}}},B=function(){var e=window.location.search.substring(1).split("=");return e.length>=2&&void 0!==e[1]?e[1]:"/"},G="YYYY-MM-DD HH:mm",$="Please enter valid credentials",H="Refresh token is expired",_="Signature has expired",U="Unauthorized",L="/guests",V="/login",K="/rezervace/:hash/hoste",X="/",Y="/apartma",Z="refreshToken",J="token",W="username",Q=n(39),ee=n(550),te=Object(ee.a)(a||(a=Object(Q.a)(["\n  mutation TokenAuth($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n      payload\n      refreshExpiresIn\n      refreshToken\n      token\n    }\n  }\n"]))),ne=Object(ee.a)(r||(r=Object(Q.a)(["\n  mutation RefreshToken($refreshToken: String!) {\n    refreshToken(refreshToken: $refreshToken) {\n      payload\n      refreshExpiresIn\n      refreshToken\n      token\n    }\n  }\n"]))),ae=Object(ee.a)(i||(i=Object(Q.a)(["\n  mutation RevokeToken($refreshToken: String!) {\n    revokeToken(refreshToken: $refreshToken) {\n      revoked\n    }\n  }\n"]))),re=(n(321),n(3)),ie=Object(N.g)((function(e){var t=e.history,n=e.selectedPage,a=e.user,r=Object(P.a)().t,i=Object(R.a)(ae),s=Object(k.a)(i,1)[0],c=Object(F.useCallback)((function(){localStorage.removeItem(W),t.push("/login?next=".concat(B()))}),[t]),o=null!==a?Object(re.jsx)(z.a,{size:32,style:{backgroundColor:q.getRandomColor()},children:a.username.substring(0,1).toUpperCase()}):null;return null!==a?Object(re.jsxs)(re.Fragment,{children:[Object(re.jsxs)(A.a,{mode:"horizontal",className:"navigation-items",selectedKeys:[n],children:[Object(re.jsx)(A.a.Item,{icon:Object(re.jsx)(w.a,{}),children:Object(re.jsx)(j.b,{to:"/",children:r("reservations.name")})},"reservation"),Object(re.jsx)(A.a.Item,{icon:Object(re.jsx)(E.a,{}),children:Object(re.jsx)(j.b,{to:"/guests",children:r("guests.name-pl")})},"guests"),Object(re.jsx)(A.a.Item,{icon:Object(re.jsx)(D.a,{}),children:Object(re.jsx)(j.b,{to:"/apartma",children:r("living-units")})},"suites")]}),Object(re.jsx)(A.a,{className:"user",mode:"horizontal",selectedKeys:[n],children:Object(re.jsx)(A.a.SubMenu,{title:o,children:Object(re.jsx)(A.a.Item,{icon:Object(re.jsx)(M.a,{}),onClick:function(){var e=localStorage.getItem(Z);null!==e?s({variables:{refreshToken:e}}).then((function(){localStorage.removeItem(J),localStorage.removeItem(Z)})).finally((function(){return c()})):c()},children:r("logout")},"logout")},"user")})]}):null})),se=n(545),ce=function(e){var t=e.selectedPage,n=e.user,a=Object(re.jsx)("img",{className:"logo",src:T,alt:"Kamenice logo"});return Object(re.jsxs)(se.a,{children:[null!==n?Object(re.jsx)(j.b,{to:"/",children:a}):a,Object(re.jsx)(ie,{selectedPage:t,user:n})]})},oe=n(551),le=n(66),de=Object(N.g)((function(e){var t=e.history,n=Object(P.a)().t;return Object(re.jsx)(S.a,{children:Object(re.jsx)(S.a.Content,{children:Object(re.jsx)(oe.a,{status:"404",title:n("errors.oops"),subTitle:n("errors.404"),extra:Object(re.jsx)(le.a,{onClick:function(){return t.push("/")},type:"primary",children:n("go-home")})})})})})),ue=n(77),je=n.n(ue),me=n(131),be=n.n(me),pe=(n(427),n(428),n(284)),Oe=n(286),he=n.n(Oe),ve=function(e){var t=e.item,n=e.itemContext,a=e.getItemProps,r=e.getResizeProps,i=Object(P.a)().t,s=r(),c=s.left,o=s.right;return void 0!==t.itemProps?Object(re.jsxs)("div",Object(l.a)(Object(l.a)({},a(t.itemProps)),{},{children:[n.useResizeHandle?Object(re.jsx)("div",Object(l.a)({},c)):"",Object(re.jsx)(pe.a,{title:t.title,content:Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)("div",{style:{color:t.color,fontWeight:700},children:i("reservation-types.".concat(t.type))}),Object(re.jsxs)("div",{children:[i("from"),": ",Object(re.jsx)("strong",{children:t.start_time.format("DD MMM HH:mm")})]}),Object(re.jsxs)("div",{children:[i("to"),": ",Object(re.jsx)("strong",{children:t.end_time.format("DD MMM HH:mm")})]})]}),children:Object(re.jsx)("div",{className:"rct-item-content",style:{maxHeight:"".concat(n.dimensions.height)},children:Object(re.jsx)(he.a,{strong:!0,children:t.title})})}),n.useResizeHandle?Object(re.jsx)("div",Object(l.a)({},o)):""]})):null},fe=n(303),ge=n(300),xe=n(541),ye=n(534),Ie=n(549),ke=n(290),Se=n(540),Ce=n(161),Fe=n(555),Ne=n(553),Te=n(543),we=n(535),Ee=n(206),De=n(566),Me=n(305),Re=n(93),ze=n(567),Ae=n(558),Pe=n(304),qe=n(302),Be=(n(513),function(e){switch(e){case"NONBINDING":return"Nez\xe1vazn\xe1 Rezervace";case"ACCOMMODATED":return"Aktu\xe1ln\u011b Ubytov\xe1n\xed";case"INHABITED":return"Obydlen\xfd Term\xedn";case"BINDING":default:return"Z\xe1vazn\xe1 Rezervace"}});!function(e){e.ADULT="ADULT",e.CHILD="CHILD",e.INFANT="INFANT",e.YOUNG="YOUNG"}(s||(s={})),function(e){e.F="F",e.M="M"}(c||(c={}));var Ge,$e,He,_e,Ue,Le,Ve,Ke,Xe,Ye,Ze,Je,We,Qe,et,tt={mealOptions:[{label:"Bez Stravy",value:"NOMEAL"},{label:"Jen Sn\xeddan\u011b",value:"BREAKFAST"},{label:"Polopenze",value:"HALFBOARD"}],reservationOptions:[{label:Be("BINDING"),value:"BINDING"},{label:Be("NONBINDING"),value:"NONBINDING"},{label:Be("ACCOMMODATED"),value:"ACCOMMODATED"},{label:Be("INHABITED"),value:"INHABITED"}],getRequiredRule:function(e){return{required:!0,message:e}}},nt={requiredRule:function(e){return{required:!0,message:e}},trim:function(e){return void 0===e?e:e.trim()}},at=n(552),rt=n(548),it=n(564),st=n(565),ct={ageOptions:[{label:"12+",value:"YOUNG"},{label:"3-12 let",value:"CHILD"},{label:"Do 3 let",value:"INFANT"},{label:"Dosp\u011bl\xfd",value:"ADULT"}],requiredAlphaRule:function(e){return{message:e,pattern:/^([A-Za-z\s\xe1\xc1\u010d\u010c\u010f\u010e\xe9\xc9\u011b\u011a\xed\xcd\u0148\u0147\u0159\u0158\u0161\u0160\u0165\u0164\xfa\xda\u016f\u016e\xfd\xdd\u017e\u017d\xf3\xd3])+$/,transform:nt.trim}}},ot=(n(514),Object(ee.a)(Ge||(Ge=Object(Q.a)(["\n  mutation CreateGuest($data: GuestInput!) {\n    createGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n"])))),lt=Object(ee.a)($e||($e=Object(Q.a)(["\n  mutation UpdateGuest($data: GuestInput!) {\n    updateGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n"]))),dt=Object(ee.a)(He||(He=Object(Q.a)(["\n  mutation DeleteGuest($guestId: ID!) {\n    deleteGuest(guestId: $guestId) {\n      guest {\n        id\n      }\n    }\n  }\n"]))),ut=function(e){var t=e.addGuest,n=e.close,a=e.guest,r=e.removeGuest,i=e.visible,s=Object(P.a)().t,c=xe.a.useForm(),o=Object(k.a)(c,1)[0],d=function(e){return ge.b.error(e.message)},u=Object(R.a)(ot,{onError:d}),j=Object(k.a)(u,2),m=j[0],b=j[1].loading,p=Object(R.a)(lt,{onError:d}),O=Object(k.a)(p,2),h=O[0],v=O[1].loading,f=Object(R.a)(dt,{onError:d}),g=Object(k.a)(f,2),x=g[0],y=g[1].loading,I=Object(F.useState)(!1),S=Object(k.a)(I,2),C=S[0],N=S[1],T={age:null===a||void 0===a?void 0:a.age,address:{municipality:null===a||void 0===a?void 0:a.addressMunicipality,psc:null===a||void 0===a?void 0:a.addressPsc,street:null===a||void 0===a?void 0:a.addressStreet},citizenship:{selected:null===a||void 0===a?void 0:a.citizenship},email:null===a||void 0===a?void 0:a.email,gender:null===a||void 0===a?void 0:a.gender,identity:null===a||void 0===a?void 0:a.identity,name:null===a||void 0===a?void 0:a.name,phone:null===a||void 0===a?void 0:a.phoneNumber,surname:null===a||void 0===a?void 0:a.surname,visa:null===a||void 0===a?void 0:a.visaNumber},w=Object(re.jsx)(xe.a.Item,{name:"email-prefix",noStyle:!0,children:Object(re.jsx)(it.a,{})});return Object(F.useEffect)((function(){!0===i&&o.resetFields()}),[o,i]),Object(re.jsx)(at.a,{closeIcon:Object(re.jsx)(ye.a,{onCancel:function(){return N(!1)},onConfirm:function(){N(!1),o.resetFields(),n()},placement:"rightTop",title:s("forms.close-dirty"),visible:C,children:Object(re.jsx)(Re.a,{onClick:function(){o.isFieldsTouched()?N(!0):n()}})}),placement:"left",title:s("guests.name"),width:500,visible:i,footer:Object(re.jsxs)(re.Fragment,{children:[void 0!==a&&null!==a&&Object(re.jsx)(ye.a,{cancelText:s("no"),icon:Object(re.jsx)(st.a,{}),okText:s("yes"),onConfirm:function(){x({variables:{guestId:a.id}}).then((function(e){var t,a,i=null===(t=e.data)||void 0===t||null===(a=t.deleteGuest)||void 0===a?void 0:a.guest;void 0!==r&&void 0!==i&&null!==i&&(r(i.id),ge.b.success(s("guests.deleted")),n())}))},title:s("forms.delete-confirm"),children:Object(re.jsx)(le.a,{danger:!0,style:{float:"left"},type:"primary",children:s("forms.delete")})}),Object(re.jsx)(le.a,{onClick:function(){o.validateFields().then((function(){var e,r,i,c,d,u=o.getFieldsValue(!0),j={age:u.age,addressMunicipality:null===(e=u.address)||void 0===e?void 0:e.municipality,addressPsc:null===(r=u.address)||void 0===r?void 0:r.psc,addressStreet:null===(i=u.address)||void 0===i?void 0:i.street,citizenship:void 0===(null===(c=u.citizenship)||void 0===c?void 0:c.selected)?null===(d=u.citizenship)||void 0===d?void 0:d.new:u.citizenship.selected,email:u.email,gender:u.gender,identity:u.identity,name:u.name,phoneNumber:u.phone,surname:u.surname,visaNumber:u.visa};void 0===a||null===a?m({variables:{data:Object(l.a)({},j)}}).then((function(e){var a,r,i=null===(a=e.data)||void 0===a||null===(r=a.createGuest)||void 0===r?void 0:r.guest;void 0!==i&&null!==i&&(t(i),ge.b.success(s("guests.added",{name:i.name,surname:i.surname}))),n()})):h({variables:{data:Object(l.a)({id:String(a.id)},j)}}).then((function(e){var a,r,i=null===(a=e.data)||void 0===a||null===(r=a.updateGuest)||void 0===r?void 0:r.guest;void 0!==i&&null!==i&&(t(i),ge.b.success(s("guests.updated",{name:i.name,surname:i.surname}))),n()}))})).catch((function(){return ge.b.error(s("errors.invalid-form"))}))},type:"primary",children:s(void 0===a||null===a?"forms.create":"forms.update")})]}),footerStyle:{padding:"16px 20px",textAlign:"right"},children:Object(re.jsx)(rt.a,{active:!0,loading:b||v||y,paragraph:{rows:15},children:Object(re.jsxs)(xe.a,{form:o,initialValues:T,layout:"vertical",name:"guest",children:[Object(re.jsx)(je.a,{level:5,children:s("forms.personal-data")}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("name"),name:"name",required:!0,rules:[nt.requiredRule(s("forms.field-required")),ct.requiredAlphaRule(s("forms.enter-text"))],children:Object(re.jsx)(Ne.a,{placeholder:s("forms.your-name")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("surname"),name:"surname",required:!0,rules:[nt.requiredRule(s("forms.field-required")),ct.requiredAlphaRule(s("forms.enter-text"))],children:Object(re.jsx)(Ne.a,{placeholder:s("your-surname")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("email"),name:"email",required:!0,rules:[nt.requiredRule(s("forms.field-required"))],children:Object(re.jsx)(Ne.a,{addonBefore:w,placeholder:s("email"),type:"email"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("forms.id-number"),name:"identity",children:Object(re.jsx)(Ne.a,{placeholder:s("forms.id-number-full")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("phone-number"),name:"phone",children:Object(re.jsx)(Ne.a,{placeholder:s("number")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("age"),name:"age",children:Object(re.jsx)(Ce.a,{options:ct.ageOptions,placeholder:s("forms.choose-from-list")})}),Object(re.jsx)(xe.a.Item,{label:s("sex"),name:"gender",children:Object(re.jsxs)(Ce.a,{placeholder:s("forms.choose-from-list"),children:[Object(re.jsx)(Ce.a.Option,{value:"M",children:s("man")}),Object(re.jsx)(Ce.a.Option,{value:"F",children:s("woman")})]})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("forms.visa-number"),name:"visa",children:Object(re.jsx)(Ne.a,{placeholder:s("forms.visa-number")})}),Object(re.jsx)(je.a,{level:5,children:s("forms.address")}),Object(re.jsx)(xe.a.Item,{label:s("forms.street"),name:["address","street"],children:Object(re.jsx)(Ne.a,{placeholder:s("forms.street")})}),Object(re.jsx)(xe.a.Item,{label:s("forms.psc-label"),children:Object(re.jsxs)(Ne.a.Group,{compact:!0,children:[Object(re.jsx)(xe.a.Item,{style:{marginBottom:0,width:"50%"},name:["address","psc"],children:Object(re.jsx)(Ne.a,{placeholder:s("forms.psc")})}),Object(re.jsx)(xe.a.Item,{style:{marginBottom:0,width:"50%"},name:["address","municipality"],children:Object(re.jsx)(Ne.a,{placeholder:s("forms.municipality")})})]})}),Object(re.jsx)(xe.a.Item,{label:s("forms.citizenship"),children:Object(re.jsxs)(Ne.a.Group,{compact:!0,children:[Object(re.jsx)(xe.a.Item,{style:{width:"50%"},name:["citizenship","selected"],children:Object(re.jsxs)(Ce.a,{style:{width:"100%"},placeholder:s("forms.from-list"),children:[Object(re.jsx)(Ce.a.Option,{value:"cze",children:"CZE"}),Object(re.jsx)(Ce.a.Option,{value:"sk",children:"SK"})]})}),Object(re.jsx)(xe.a.Item,{style:{width:"50%"},name:["citizenship","new"],children:Object(re.jsx)(Ne.a,{placeholder:s("forms.by-hand")})})]})})]})})})},jt=Object(ee.a)(_e||(_e=Object(Q.a)(["\n  query Guests {\n    guests {\n      age\n      addressMunicipality\n      addressPsc\n      addressStreet\n      citizenship\n      email\n      gender\n      identity\n      id\n      name\n      phoneNumber\n      surname\n      visaNumber\n    }\n  }\n"]))),mt=Object(ee.a)(Ue||(Ue=Object(Q.a)(["\n  mutation CreateReservation($data: ReservationInput!) {\n    createReservation(data: $data) {\n      reservation {\n        fromDate\n        id\n        guest {\n          id\n          name\n          surname\n        }\n        meal\n        notes\n        priceAccommodation\n        priceExtra\n        priceMeal\n        priceMunicipality\n        priceTotal\n        purpose\n        roommates {\n          age\n          id\n          name\n          surname\n        }\n        suite {\n          id\n          number\n          title\n        }\n        toDate\n        type\n      }\n    }\n  }\n"]))),bt=Object(ee.a)(Le||(Le=Object(Q.a)(["\n  mutation DeleteReservation($reservationId: ID!) {\n    deleteReservation(reservationId: $reservationId) {\n      reservation {\n        id\n      }\n    }\n  }\n"]))),pt=Object(ee.a)(Ve||(Ve=Object(Q.a)(["\n  mutation UpdateReservation($data: ReservationInput!) {\n    updateReservation(data: $data) {\n      reservation {\n        fromDate\n        id\n        guest {\n          id\n          name\n          surname\n        }\n        meal\n        notes\n        priceAccommodation\n        priceExtra\n        priceMeal\n        priceMunicipality\n        priceTotal\n        purpose\n        roommates {\n          age\n          id\n          name\n          surname\n        }\n        suite {\n          id\n          number\n          title\n        }\n        toDate\n        type\n      }\n    }\n  }\n"]))),Ot={municipalityFee:21,getDailyPricePerGuest:function(e,t){var n=e;switch(t){case"BREAKFAST":n+=80;break;case"HALFBOARD":n+=200}return n},getDailyPricePerRoommate:function(e,t,n){return 0},calculatePrice:function(e,t){var n,a=e.priceBase,r=0;if(void 0!==t.toDate&&null!==t.toDate){var i=p()(t.toDate),s=p()(t.fromDate);r=Math.ceil(p.a.duration(i.diff(s)).asDays())}return{priceAccommodation:a=r<3?e.priceBase*r:e.priceBase*r-e.priceBase*r*.12,priceMunicipality:n=Ot.municipalityFee*r,priceTotal:a+n}}},ht=["key","name","fieldKey"],vt=function(e){var t=e.addOrUpdateReservation,n=e.close,a=e.isOpen,r=e.clearReservation,i=e.reservation,s=e.suite,c=Object(P.a)().t,o=function(e){return ge.b.error(e.message)},d=Object(R.a)(mt,{onCompleted:function(e){var a;t(null===(a=e.createReservation)||void 0===a?void 0:a.reservation),ge.b.success(c("reservations.created")),n()},onError:o}),u=Object(k.a)(d,2),j=u[0],m=u[1].loading,b=Object(R.a)(bt,{onCompleted:function(e){var t,a;r(null===(t=e.deleteReservation)||void 0===t||null===(a=t.reservation)||void 0===a?void 0:a.id),ge.b.success(c("reservations.deleted")),n()},onError:o}),p=Object(k.a)(b,2),O=p[0],h=p[1].loading,v=Object(R.a)(pt,{onCompleted:function(e){var a;t(null===(a=e.updateReservation)||void 0===a?void 0:a.reservation),ge.b.success(c("reservations.updated")),n()},onError:o}),f=Object(k.a)(v,2),g=f[0],x=f[1].loading,y=Object(we.a)(jt,{onError:o}),I=Object(k.a)(y,2),S=I[0],C=I[1],N=C.loading,T=C.data,w=Object(F.useState)(!1),E=Object(k.a)(w,2),D=E[0],M=E[1],z=Object(F.useState)(!1),A=Object(k.a)(z,2),q=A[0],B=A[1],$=Object(F.useState)([]),H=Object(k.a)($,2),_=H[0],U=H[1],L=Object(F.useState)(!1),V=Object(k.a)(L,2),K=V[0],X=V[1],Y=Object(F.useState)(!1),Z=Object(k.a)(Y,2),J=Z[0],W=Z[1],Q=xe.a.useForm(),ee=Object(k.a)(Q,1)[0],te=function(e){return{label:"".concat(e.name," ").concat(e.surname),value:e.id}},ne=void 0!==i?{dates:[i.fromDate,i.toDate],guest:void 0===i.guest?null:i.guest.id,meal:i.meal,notes:i.notes,priceAccommodation:"0.00",priceExtra:"0.00",priceMeal:"0.00",priceMunicipality:"0.00",priceTotal:i.priceTotal,purpose:i.purpose,roommates:Array.from(i.roommates,(function(e){return{id:e.id}})),type:i.type}:{type:"NONBINDING"},ae=Object(F.useCallback)((function(){var e=ee.getFieldsValue(!0),t=ee.getFieldValue("dates"),n=Object(k.a)(t,2),a=n[0],r=n[1],s=void 0===e.roommates?[]:Array.from(e.roommates,(function(e){return e.id}));return{fromDate:a.format(G),guest:e.guest,meal:e.meal,notes:e.notes,priceAccommodation:e.priceAccommodation,priceExtra:e.priceExtra,priceMeal:e.priceMeal,priceMunicipality:e.priceMunicipality,priceTotal:e.priceTotal,purpose:e.purpose,roommates:s,suite:void 0!==i?+i.suite.id:null,toDate:r.format(G),type:e.type}}),[ee,i]),ie=function(){var e=ae();void 0!==i&&void 0!==i.id?g({variables:{data:Object(l.a)({id:String(i.id)},e)}}):j({variables:{data:Object(l.a)({},e)}})},se=[{message:c("forms.guest-duplicate"),validator:function(e,t){var n=ee.getFieldValue("roommates");if(void 0===n||0===n.length)return Promise.resolve();var a=n.filter((function(e){return void 0!==e&&e.id===t}));return void 0===a||0===a.length?Promise.resolve():Promise.reject(new Error("Fail guest validation, equals to roommate"))}},{message:c("forms.choose-guest"),required:!0}],ce=[{message:c("forms.guest-selected"),validator:function(e,t){var n=ee.getFieldValue("roommates").filter((function(e){return void 0!==e&&e.id===t}));return void 0===n||n.length<=1?Promise.resolve():Promise.reject(new Error("Fail roommate validation, duplicate value"))}},{message:c("forms.guest-equals-roommate"),validator:function(e,t){return ee.getFieldValue("guest")!==t?Promise.resolve():Promise.reject(new Error("Fail roommate validation, equals to guest"))}}],oe=[void 0!==i&&void 0!==i.id?Object(re.jsx)(ye.a,{cancelText:c("no"),okText:c("yes"),onConfirm:function(){void 0!==i.id&&O({variables:{reservationId:String(i.id)}})},title:"".concat(c("reservations.remove"),"?"),children:Object(re.jsx)(le.a,{className:"cancel-button",danger:!0,icon:Object(re.jsx)(Ee.a,{}),children:c("forms.delete")})},"remove"):null,Object(re.jsx)(le.a,{onClick:function(){return B(!0)},children:c("guests.add")},"guest"),Object(re.jsx)(le.a,{icon:void 0===i?Object(re.jsx)(De.a,{}):Object(re.jsx)(Me.a,{}),onClick:function(){ee.validateFields().then(ie)},type:"primary",children:void 0!==i&&void 0!==i.id?c("forms.update"):c("forms.save")},"create")],de=Object(F.useCallback)((function(){void 0!==s&&void 0!==i&&ee.setFieldsValue(Ot.calculatePrice(s,ae()))}),[ee,ae,i,s]);Object(F.useEffect)((function(){!0===a&&(ee.resetFields(),S())}),[ee,S,a,i]),Object(F.useEffect)((function(){if(void 0!==T&&null!==T.guests){var e=[];T.guests.forEach((function(t){null!==t&&e.push(te(t))})),U(e)}}),[T]);return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(Ie.a,{className:"reservation-modal",closeIcon:Object(re.jsx)(ye.a,{onCancel:function(){return M(!1)},onConfirm:function(){M(!1),setTimeout(n)},title:c("forms.close-dirty"),visible:D,children:Object(re.jsx)(Re.a,{onClick:function(){ee.isFieldsTouched()?M(!0):n()}})}),footer:oe,title:c("reservations.form"),visible:a,children:Object(re.jsx)(ke.a,{spinning:N||m||h||x,tip:"".concat(c("loading"),"..."),children:Object(re.jsxs)(xe.a,Object(l.a)(Object(l.a)({form:ee,initialValues:ne},{labelCol:{span:8},wrapperCol:{span:16}}),{},{children:[Object(re.jsx)(xe.a.Item,{label:c("reservations.date"),name:"dates",required:!0,children:Object(re.jsx)(Se.a.RangePicker,{format:G,onChange:de,showTime:!0})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:c("guests.name"),name:"guest",required:!0,rules:se,children:Object(re.jsx)(Ce.a,{filterOption:function(e,t){var n,a=null===t||void 0===t||null===(n=t.label)||void 0===n?void 0:n.toString().toLowerCase().indexOf(e.toLowerCase());return void 0!==a&&a>=0},options:_,showSearch:!0})}),Object(re.jsx)(xe.a.List,{name:"roommates",children:function(e,t){var n=t.add,a=t.remove;return Object(re.jsxs)(re.Fragment,{children:[e.map((function(t){var n=t.key,r=t.name,i=t.fieldKey,s=Object(fe.a)(t,ht);return Object(re.jsxs)(Fe.b,{align:"baseline",className:"roommate-list",children:[Object(re.jsx)(xe.a.Item,Object(l.a)(Object(l.a)({hasFeedback:!0},s),{},{fieldKey:[i,"first"],label:c("reservations.roommate"),name:[r,"id"],rules:ce,children:Object(re.jsx)(Ce.a,{onChange:function(){return console.log(e)},options:_,showSearch:!0})})),Object(re.jsx)(ze.a,{onClick:function(){a(r),ee.validateFields(),console.log(e)}})]},n)})),Object(re.jsx)(xe.a.Item,{wrapperCol:{offset:8,span:16},children:Object(re.jsx)(le.a,{disabled:e.length>=_.length,type:"dashed",onClick:function(){return n()},block:!0,icon:Object(re.jsx)(Ae.a,{}),children:c("reservations.add-roommate")})})]})}}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:c("reservations.type"),name:"type",required:!0,rules:[tt.getRequiredRule(c("reservations.choose-type"))],children:Object(re.jsx)(Ce.a,{options:tt.reservationOptions})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:c("reservations.meal"),name:"meal",required:!0,rules:[nt.requiredRule(c("forms.field-required"))],children:Object(re.jsx)(Ce.a,{options:tt.mealOptions})}),Object(re.jsx)(xe.a.Item,{hidden:!K,label:c("reservations.purpose"),name:"purpose",children:Object(re.jsx)(Ne.a,{placeholder:c("reservations.purpose")})}),Object(re.jsx)(xe.a.Item,{hidden:!K,label:c("reservations.notes"),name:"notes",children:Object(re.jsx)(Ne.a.TextArea,{placeholder:c("forms.enter-text"),allowClear:!0})}),Object(re.jsx)(xe.a.Item,{wrapperCol:{offset:8,span:16},children:Object(re.jsx)(le.a,{block:!0,onClick:function(){return X(!K)},type:"dashed",icon:K?Object(re.jsx)(Pe.a,{}):Object(re.jsx)(qe.a,{}),children:c(K?"reservations.hide-info":"reservations.show-info")})}),Object(re.jsx)(xe.a.Item,{hidden:!J,label:c("reservations.price-room"),children:Object(re.jsx)(Te.a.Text,{children:Object(re.jsxs)("strong",{children:[null===s||void 0===s?void 0:s.priceBase," ",c("rooms.currency")]})})}),Object(re.jsx)(xe.a.Item,{hidden:!J,label:c("reservations.price-accommodation"),name:"priceAccommodation",children:Object(re.jsx)(Ne.a,{addonBefore:c("rooms.currency"),type:"number"})}),Object(re.jsx)(xe.a.Item,{hidden:!J,label:c("reservations.price-extra"),name:"priceExtra",children:Object(re.jsx)(Ne.a,{addonBefore:c("rooms.currency"),type:"number"})}),Object(re.jsx)(xe.a.Item,{hidden:!J,label:c("reservations.price-meal"),name:"priceMeal",children:Object(re.jsx)(Ne.a,{addonBefore:c("rooms.currency"),type:"number"})}),Object(re.jsx)(xe.a.Item,{hidden:!J,label:c("reservations.price-municipality"),name:"priceMunicipality",children:Object(re.jsx)(Ne.a,{addonBefore:c("rooms.currency"),type:"number"})}),Object(re.jsx)(xe.a.Item,{hidden:!J,label:Object(re.jsx)("strong",{children:c("reservations.price-total")}),name:"priceTotal",children:Object(re.jsx)(Ne.a,{addonBefore:c("rooms.currency"),type:"number"})}),Object(re.jsx)(xe.a.Item,{wrapperCol:{offset:8,span:16},children:Object(re.jsx)(le.a,{block:!0,onClick:function(){return W(!J)},type:"dashed",icon:J?Object(re.jsx)(Pe.a,{}):Object(re.jsx)(qe.a,{}),children:c(J?"reservations.hide-prices":"reservations.show-prices")})})]}))})}),Object(re.jsx)(ut,{close:function(){return B(!1)},addGuest:function(e){U(_.concat(te(e)))},visible:q})]})},ft=n(536),gt=Object(ee.a)(Ke||(Ke=Object(Q.a)(["\n  query Suites {\n    suites {\n      id\n      number\n      numberBeds\n      priceBase\n      priceChild\n      priceExtra\n      priceInfant\n      title\n    }\n  }\n"]))),xt=Object(ee.a)(Xe||(Xe=Object(Q.a)(["\n  query SuitesWithReservations {\n    guests {\n      id\n      name\n      surname\n    }\n    suites {\n      id\n      number\n      numberBeds\n      priceBase\n      priceChild\n      priceExtra\n      priceInfant\n      title\n    }\n    reservations {\n      fromDate\n      id\n      guest {\n        id\n        name\n        surname\n      }\n      meal\n      notes\n      priceAccommodation\n      priceExtra\n      priceMeal\n      priceMunicipality\n      priceTotal\n      purpose\n      roommates {\n        age\n        id\n        name\n        surname\n      }\n      suite {\n        id\n      }\n      toDate\n      type\n    }\n  }\n"]))),yt=Object(N.g)((function(e){var t=e.setPageTitle,n=e.setSelectedPage,a=Object(P.a)().t,r=Object(F.useState)(!0),i=Object(k.a)(r,2),s=i[0],c=i[1],o=Object(F.useState)([]),d=Object(k.a)(o,2),u=d[0],j=d[1],m=Object(F.useState)([]),b=Object(k.a)(m,2),O=b[0],h=b[1],v=Object(F.useState)(),f=Object(k.a)(v,2),g=f[0],x=f[1],y=Object(F.useState)(!1),I=Object(k.a)(y,2),S=I[0],C=I[1],N=Object(F.useState)(),T=Object(k.a)(N,2),w=T[0],E=T[1],D=Object(ft.a)(xt,{onCompleted:function(){c(!1)},onError:function(e){return ge.b.error(e.message)}}).data,M=function(e){return{color:q.getReservationColor(e.type),end_time:p()(e.toDate),group:e.suite.id,guest:e.guest,id:e.id,itemProps:{className:"reservation-item",style:{background:q.getReservationColor(e.type),border:"none"}},meal:e.meal,notes:e.notes,priceAccommodation:e.priceAccommodation,priceExtra:e.priceExtra,priceMeal:e.priceMeal,priceMunicipality:e.priceMunicipality,priceTotal:e.priceTotal,purpose:e.purpose,roommates:e.roommates,start_time:p()(e.fromDate),suite:e.suite,title:"".concat(e.guest.name," ").concat(e.guest.surname),type:e.type}};Object(F.useEffect)((function(){var e,t,n=[],a=[];null===D||void 0===D||null===(e=D.suites)||void 0===e||e.forEach((function(e){null!==e&&a.push(e)})),null===D||void 0===D||null===(t=D.reservations)||void 0===t||t.forEach((function(e){null!==e&&n.push(M(e))})),h(n),j(a)}),[D]),Object(F.useEffect)((function(){t(a("home-title")),n("reservation")}),[t,n,a]);return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(rt.a,{active:!0,loading:s,paragraph:{rows:5},children:Object(re.jsxs)(be.a,{canChangeGroup:!1,canMove:!1,canResize:!1,defaultTimeEnd:p()().add(12,"day"),defaultTimeStart:p()().add(-12,"day"),groupRenderer:function(e){var t=e.group;return Object(re.jsx)(re.Fragment,{children:Object(re.jsx)(je.a,{level:5,children:t.title})})},groups:u,itemRenderer:function(e){return Object(re.jsx)(ve,Object(l.a)({},e))},items:O,lineHeight:60,onCanvasClick:function(e,t){var n=u.find((function(t){return t.id===e}));if(void 0!==n){var a,r=null===D||void 0===D||null===(a=D.suites)||void 0===a?void 0:a.find((function(e){return(null===e||void 0===e?void 0:e.id)===n.id}));null!==r&&E(r),x({fromDate:p()(t),meal:"NOMEAL",roommates:[],suite:Object(l.a)({},n),priceAccommodation:"0.00",priceExtra:"0.00",priceMeal:"0.00",priceMunicipality:"0.00",priceTotal:"0.00",toDate:p()(t).add(1,"day"),type:"NONBINDING"}),C(!0)}},onItemClick:function(e){var t=O.find((function(t){return t.id===e}));if(void 0!==t){var n,a=null===D||void 0===D||null===(n=D.suites)||void 0===n?void 0:n.find((function(e){return(null===e||void 0===e?void 0:e.id)===t.suite.id}));null!==a&&E(a),x({fromDate:p()(t.start_time),guest:t.guest,id:t.id,meal:t.meal,notes:t.notes,priceAccommodation:t.priceAccommodation,priceExtra:t.priceExtra,priceMeal:t.priceMeal,priceMunicipality:t.priceMunicipality,priceTotal:t.priceTotal,purpose:t.purpose,roommates:t.roommates,suite:t.suite,toDate:p()(t.end_time),type:t.type}),C(!0)}},children:[Object(re.jsxs)(me.TimelineHeaders,{children:[Object(re.jsx)(me.SidebarHeader,{children:function(e){var t=e.getRootProps;return Object(re.jsx)("div",Object(l.a)(Object(l.a)({},t()),{},{className:"side-header",children:a("living-units")}))}}),Object(re.jsx)(me.DateHeader,{unit:"primaryHeader"}),Object(re.jsx)(me.DateHeader,{className:"days",unit:"day"})]}),Object(re.jsx)(me.CursorMarker,{children:function(e){var t=e.styles,n=e.date;return Object(re.jsx)("div",{style:Object(l.a)(Object(l.a)({},t),{},{backgroundColor:"rgba(136, 136, 136, 0.5)",color:"#888"}),children:Object(re.jsx)("div",{className:"rt-marker__label",children:Object(re.jsx)("div",{className:"rt-marker__content",children:p()(n).format("DD MMM HH:mm")})})})}})]})}),Object(re.jsx)(vt,{addOrUpdateReservation:function(e){if(void 0!==e&&null!==e){var t=O.filter((function(t){return t.id!==e.id}));h(t.concat(M(e)))}},close:function(){x(void 0),C(!1)},isOpen:S,clearReservation:function(e){void 0!==e&&null!==e&&h(O.filter((function(t){return t.id!==e}))),x(void 0)},reservation:g,suite:w})]})})),It=n(542),kt=(n(520),function(e){var t=e.guest,n=e.openGuestDrawer,a=e.selectGuest;return Object(re.jsx)(It.b.Item,{actions:[Object(re.jsx)(le.a,{onClick:function(){a(t),n()},type:"link",children:"upravit"},"edit")],children:Object(re.jsx)(It.b.Item.Meta,{avatar:Object(re.jsx)(z.a,{gap:4,size:"large",style:{backgroundColor:q.getRandomColor()},children:t.name.substring(0,1).toUpperCase()}),description:t.email,title:"".concat(t.name," ").concat(t.surname)})})}),St=Object(N.g)((function(e){var t=e.setPageTitle,n=e.setSelectedPage,a=Object(P.a)().t,r=Object(F.useState)(!0),i=Object(k.a)(r,2),s=i[0],c=i[1],o=Object(F.useState)(!1),l=Object(k.a)(o,2),d=l[0],u=l[1],j=Object(F.useState)([]),m=Object(k.a)(j,2),b=m[0],p=m[1],O=Object(F.useState)(null),h=Object(k.a)(O,2),v=h[0],f=h[1],g=Object(ft.a)(jt,{onCompleted:function(){c(!1)},onError:function(e){return ge.b.error(e.message)}}).data;return Object(F.useEffect)((function(){var e=[];void 0!==g&&null!==(null===g||void 0===g?void 0:g.guests)&&(g.guests.forEach((function(t){null!==t&&e.push(t)})),p(e))}),[g]),Object(F.useEffect)((function(){t(a("guests.page-title")),n("guests")}),[t,n,a]),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(rt.a,{active:!0,loading:s,paragraph:{rows:5},children:Object(re.jsx)(It.b,{bordered:!0,className:"guests-list",dataSource:b,footer:Object(re.jsx)(le.a,{icon:Object(re.jsx)(De.a,{}),onClick:function(){f(null),u(!0)},type:"primary",children:a("guests.add")}),header:Object(re.jsx)("h4",{children:a("guests.list")}),itemLayout:"horizontal",renderItem:function(e){return Object(re.jsx)(kt,{guest:e,openGuestDrawer:function(){return u(!0)},selectGuest:f})}})}),Object(re.jsx)(ut,{addGuest:function(e){var t=b.filter((function(t){return t.id!==e.id}));p(t.concat(e))},close:function(){return u(!1)},guest:v,removeGuest:function(e){return p(b.filter((function(t){return t.id!==e})))},visible:d})]})})),Ct=Object(ee.a)(Ye||(Ye=Object(Q.a)(["\n  mutation CreateSuite($data: SuiteInput!) {\n    createSuite(data: $data) {\n      suite {\n        id\n        number\n        numberBeds\n        priceBase\n        priceChild\n        priceExtra\n        priceInfant\n        title\n      }\n    }\n  }\n"]))),Ft=Object(ee.a)(Ze||(Ze=Object(Q.a)(["\n  mutation UpdateSuite($data: SuiteInput!) {\n    updateSuite(data: $data) {\n      suite {\n        id\n        number\n        numberBeds\n        priceBase\n        priceChild\n        priceExtra\n        priceInfant\n        title\n      }\n    }\n  }\n"]))),Nt=Object(ee.a)(Je||(Je=Object(Q.a)(["\n  mutation DeleteSuite($suiteId: ID!) {\n    deleteSuite(suiteId: $suiteId) {\n      suite {\n        id\n      }\n    }\n  }\n"]))),Tt=function(e){var t=e.deleteSuite,n=e.submitForm,a=e.suite,r=Object(P.a)().t;return Object(re.jsxs)(re.Fragment,{children:[void 0!==a&&Object(re.jsx)(ye.a,{cancelText:r("no"),icon:Object(re.jsx)(st.a,{}),okText:r("yes"),onConfirm:function(){t(a.id)},title:r("forms.delete-confirm"),children:Object(re.jsx)(le.a,{danger:!0,style:{float:"left"},type:"primary",children:r("forms.delete")})}),Object(re.jsx)(le.a,{onClick:n,type:"primary",children:r(void 0===a?"forms.create":"forms.update")})]})},wt=function(e){var t=e.addOrUpdateSuite,n=e.clearSuite,a=e.close,r=e.suite,i=e.visible,s=Object(P.a)().t,c=function(e){return ge.b.error(e.message)},o=Object(R.a)(Ct,{onError:c}),d=Object(k.a)(o,2),u=d[0],j=d[1].loading,m=Object(R.a)(Nt,{onError:c}),b=Object(k.a)(m,2),p=b[0],O=b[1].loading,h=Object(R.a)(Ft,{onError:c}),v=Object(k.a)(h,2),f=v[0],g=v[1].loading,x=xe.a.useForm(),y=Object(k.a)(x,1)[0],I=Object(F.useState)(!1),S=Object(k.a)(I,2),C=S[0],N=S[1],T={beds:null===r||void 0===r?void 0:r.numberBeds,number:null===r||void 0===r?void 0:r.number,price_base:null===r||void 0===r?void 0:r.priceBase,price_child:null===r||void 0===r?void 0:r.priceChild,price_extra:null===r||void 0===r?void 0:r.priceExtra,price_infant:null===r||void 0===r?void 0:r.priceInfant,title:null===r||void 0===r?void 0:r.title};return Object(F.useEffect)((function(){!0===i&&y.resetFields()}),[y,i]),Object(re.jsx)(at.a,{closeIcon:Object(re.jsx)(ye.a,{onCancel:function(){return N(!1)},onConfirm:function(){N(!1),a()},placement:"rightTop",title:s("forms.close-dirty"),visible:C,children:Object(re.jsx)(Re.a,{onClick:function(){y.isFieldsTouched()?N(!0):a()}})}),footer:Object(re.jsx)(Tt,{deleteSuite:function(e){p({variables:{suiteId:e}}).then((function(e){var t,r,i,c=null===(t=e.data)||void 0===t||null===(r=t.deleteSuite)||void 0===r||null===(i=r.suite)||void 0===i?void 0:i.id;void 0!==c&&(n(c),ge.b.success(s("rooms.deleted")),a())}))},submitForm:function(){y.validateFields().then((function(){var e=y.getFieldsValue(!0),n={number:e.number,numberBeds:e.beds,priceBase:e.price_base,priceChild:e.price_child,priceExtra:e.price_extra,priceInfant:e.price_infant,title:e.title};void 0===r?u({variables:{data:Object(l.a)({},n)}}).then((function(e){var n,r,i=null===(n=e.data)||void 0===n||null===(r=n.createSuite)||void 0===r?void 0:r.suite;void 0!==i&&null!==i&&(t(i),ge.b.success(s("rooms.created")),a())})):f({variables:{data:Object(l.a)({id:r.id},n)}}).then((function(e){var n,r,i=null===(n=e.data)||void 0===n||null===(r=n.updateSuite)||void 0===r?void 0:r.suite;void 0!==i&&null!==i&&(t(i),ge.b.success(s("rooms.updated")),a())}))})).catch((function(){console.error("Form validation failed")}))},suite:r}),footerStyle:{textAlign:"right"},placement:"left",title:s("rooms.new"),visible:i,width:500,children:Object(re.jsx)(ke.a,{size:"large",spinning:j||O||g,tip:"".concat(s("loading"),"..."),children:Object(re.jsxs)(xe.a,{form:y,initialValues:T,layout:"vertical",name:"suite",children:[Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("forms.name"),name:"title",required:!0,rules:[nt.requiredRule(s("forms.field-required"))],children:Object(re.jsx)(Ne.a,{placeholder:s("rooms.name")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("rooms.number-beds"),name:"beds",required:!0,rules:[nt.requiredRule(s("forms.field-required")),{message:s("forms.enter-number"),pattern:/^[0-9]+$/}],children:Object(re.jsx)(Ne.a,{placeholder:s("rooms.number-beds"),type:"number"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("number"),name:"number",required:!0,rules:[nt.requiredRule(s("forms.field-required")),{message:s("forms.enter-number"),pattern:/^[0-9]+$/}],children:Object(re.jsx)(Ne.a,{placeholder:s("rooms.number"),type:"number"})}),Object(re.jsx)(je.a,{level:5,children:s("rooms.prices-title")}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("rooms.price-base"),name:"price_base",rules:[{message:s("forms.enter-number"),pattern:/^[0-9]{1,4}(\.[0-9]{1,2})?$/}],children:Object(re.jsx)(Ne.a,{addonBefore:s("rooms.currency")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("rooms.price-child"),name:"price_child",rules:[{message:s("forms.enter-number"),pattern:/^[0-9]{1,4}(\.[0-9]{1,2})?$/}],children:Object(re.jsx)(Ne.a,{addonBefore:s("rooms.currency")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("rooms.price-infant"),name:"price_infant",rules:[{message:s("forms.enter-number"),pattern:/^[0-9]{1,4}(\.[0-9]{1,2})?$/}],children:Object(re.jsx)(Ne.a,{addonBefore:s("rooms.currency")})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:s("rooms.price-extra"),name:"price_extra",rules:[{message:s("forms.enter-number"),pattern:/^[0-9]{1,4}(\.[0-9]{1,2})?$/}],children:Object(re.jsx)(Ne.a,{addonBefore:s("rooms.currency")})})]})})})},Et=(n(521),function(e){var t=e.hasAccess,n=e.onAdd,a=Object(P.a)().t;return!0===t?Object(re.jsx)(le.a,{icon:Object(re.jsx)(De.a,{}),onClick:n,type:"primary",children:a("living-unit-add")}):null}),Dt=function(e){var t=e.openSuite,n=e.suite,a=Object(P.a)().t;return Object(re.jsx)(It.b.Item,{actions:[Object(re.jsx)(le.a,{className:"low-case",onClick:function(){return t(n)},type:"link",children:a("forms.update")},"edit")],className:"suite-item",onClick:function(){return t(n)},children:Object(re.jsx)(It.b.Item.Meta,{avatar:Object(re.jsx)(z.a,{gap:4,size:"large",children:Object(re.jsx)(D.a,{})}),description:"".concat(a("rooms.number")," - ").concat(n.number),title:n.title})})},Mt=Object(N.g)((function(e){var t=e.setPageTitle,n=e.setSelectedPage,a=Object(P.a)().t,r=Object(F.useState)(!0),i=Object(k.a)(r,2),s=i[0],c=i[1],o=Object(F.useState)(!1),l=Object(k.a)(o,2),d=l[0],u=l[1],j=Object(F.useState)(),m=Object(k.a)(j,2),b=m[0],p=m[1],O=Object(F.useState)([]),h=Object(k.a)(O,2),v=h[0],f=h[1],g=Object(F.useState)(!1),x=Object(k.a)(g,2),y=x[0],I=x[1],S=Object(ft.a)(gt,{onCompleted:function(){I(!0),c(!1)},onError:function(e){ge.b.error(e.message),I(!1),c(!1)}}).data,C=function(e){p(e),u(!0)};return Object(F.useEffect)((function(){var e,t=[];null===S||void 0===S||null===(e=S.suites)||void 0===e||e.forEach((function(e){null!==e&&t.push(e)})),f(t)}),[S]),Object(F.useEffect)((function(){t(a("living-units")),n("suites")}),[t,n,a]),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(rt.a,{active:!0,loading:s,paragraph:{rows:5},children:Object(re.jsx)(It.b,{bordered:!0,className:"suites-list",dataSource:v,footer:Object(re.jsx)(Et,{hasAccess:y,onAdd:function(){return C(void 0)}}),header:Object(re.jsx)("h4",{children:a("living-units-list")}),itemLayout:"horizontal",renderItem:function(e){return Object(re.jsx)(Dt,{openSuite:C,suite:e})}})}),Object(re.jsx)(wt,{addOrUpdateSuite:function(e){f(v.filter((function(t){return t.id!==e.id})).concat(e))},clearSuite:function(e){f(v.filter((function(t){return t.id!==e})))},close:function(){return u(!1)},suite:b,visible:d})]})})),Rt=(n(522),{labelCol:{lg:8,md:8,sm:8},wrapperCol:{lg:16,md:16,sm:16}}),zt={wrapperCol:{lg:{offset:8,span:16},xs:{offset:0,span:24}}},At=Object(N.g)((function(e){var t=e.history,n=e.setPageTitle,a=Object(P.a)().t,r=Object(R.a)(te,{onCompleted:function(e){null!==e.tokenAuth&&(localStorage.setItem(J,e.tokenAuth.token),localStorage.setItem(Z,e.tokenAuth.refreshToken),localStorage.setItem(W,e.tokenAuth.payload.username),t.push(B()))},onError:function(e){switch(e.message){case $:ge.b.error(a("login.invalid-login"));break;default:ge.b.error(a("generic-error"))}}}),i=Object(k.a)(r,2),s=i[0],c=i[1].loading,o=xe.a.useForm(),d=Object(k.a)(o,1)[0];return Object(F.useEffect)((function(){n(a("pages.login"))}),[n,a]),Object(re.jsx)(S.a.Content,{children:Object(re.jsx)(ke.a,{spinning:c,tip:"".concat(a("login.in-progress"),"..."),children:Object(re.jsxs)(xe.a,Object(l.a)(Object(l.a)({},Rt),{},{className:"login",form:d,name:"login",onFinish:function(e){s({variables:{password:e.password.trim(),username:e.username.trim()}})},children:[Object(re.jsx)(xe.a.Item,{label:a("name"),name:"username",rules:[{required:!0,message:a("forms.field-required")}],children:Object(re.jsx)(Ne.a,{type:"text",placeholder:a("forms.user-name")})}),Object(re.jsx)(xe.a.Item,{label:"Heslo",name:"password",rules:[{required:!0,message:a("forms.field-required")}],children:Object(re.jsx)(Ne.a,{type:"password",placeholder:a("forms.password")})}),Object(re.jsxs)(xe.a.Item,Object(l.a)(Object(l.a)({},zt),{},{children:[Object(re.jsx)(le.a,{type:"default",htmlType:"button",onClick:function(){return d.resetFields()},children:a("forms.reset")}),Object(re.jsx)(le.a,{type:"primary",htmlType:"submit",children:a("forms.login")})]}))]}))})})})),Pt=Object(ee.a)(We||(We=Object(Q.a)(["\n  query ReservationGuests($reservationHash: String!) {\n    reservationGuests(reservationHash: $reservationHash) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n      roommates {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n"]))),qt=Object(ee.a)(Qe||(Qe=Object(Q.a)(["\n  mutation CreateContactMessage($data: ContactInput!) {\n    createContactMessage(data: $data) {\n      contact {\n        message\n      }\n    }\n  }\n"]))),Bt=function(e){var t=e.show,n=Object(R.a)(qt),a=Object(k.a)(n,2),r=a[0],i=a[1].loading,s=xe.a.useForm(),c=Object(k.a)(s,1)[0];return!0===t?Object(re.jsx)(ke.a,{spinning:i,tip:"Pos\xedl\xe1m zpr\xe1vu",children:Object(re.jsx)(oe.a,{status:"error",title:"Rezervace nenalezena",subTitle:"Zanechte n\xe1m pros\xedm zpr\xe1vu, nebo n\xe1m zavolejte na +420 XXX XXX XXX",extra:Object(re.jsxs)(xe.a,{form:c,name:"contact",onFinish:function(){c.validateFields().then((function(){r({variables:{data:{message:c.getFieldValue("message")}}}).then((function(){ge.b.success("Va\u0161e zpr\xe1va byla odesl\xe1na, d\u011bkujeme!"),c.resetFields()}))})).catch((function(){return ge.b.error("Formul\xe1\u0159 nelze odeslat, opravte pros\xedm chyby")}))},wrapperCol:{offset:6,span:12},children:[Object(re.jsx)(xe.a.Item,{name:"message",rules:[{required:!0,message:"Zadejte text zpr\xe1vy"}],children:Object(re.jsx)(Ne.a.TextArea,{rows:4})}),Object(re.jsx)(xe.a.Item,{children:Object(re.jsx)(le.a,{type:"primary",htmlType:"submit",children:"Odeslat"})})]})})}):null},Gt=function(e){var t=e.guest,n=e.loading,a=e.openDrawer;return void 0===t?null:Object(re.jsx)(It.b,{bordered:!0,className:"guests-list",dataSource:t,header:Object(re.jsx)("h4",{children:"Host"}),itemLayout:"horizontal",renderItem:function(e){return Object(re.jsx)(It.b.Item,{actions:n?[]:[Object(re.jsx)(le.a,{onClick:function(){a(e)},type:"link",children:"upravit"},"edit")],children:Object(re.jsx)(It.b.Item.Meta,{avatar:Object(re.jsx)(z.a,{gap:4,size:"large",style:{backgroundColor:q.getRandomColor()},children:e.name.substring(0,1).toUpperCase()}),description:e.email,title:"".concat(e.name," ").concat(e.surname)})},e.id)}})},$t=Object(ee.a)(et||(et=Object(Q.a)(["\n  mutation UpdateReservationGuest($data: ReservationGuestInput!) {\n    updateReservationGuest(data: $data) {\n      guest {\n        addressMunicipality\n        addressPsc\n        addressStreet\n        age\n        citizenship\n        email\n        gender\n        identity\n        id\n        name\n        phoneNumber\n        surname\n        visaNumber\n      }\n    }\n  }\n"]))),Ht=function(e){var t=e.close,n=e.guest,a=e.reservationHash,r=e.visible,i=Object(P.a)().t,s=Object(R.a)($t),c=Object(k.a)(s,2),o=c[0],d=c[1].loading,u=Object(F.useState)(!1),j=Object(k.a)(u,2),m=j[0],b=j[1],p=xe.a.useForm(),O=Object(k.a)(p,1)[0],h={age:null===n||void 0===n?void 0:n.age,address:{municipality:null===n||void 0===n?void 0:n.addressMunicipality,psc:null===n||void 0===n?void 0:n.addressPsc,street:null===n||void 0===n?void 0:n.addressStreet},citizenship:{selected:null===n||void 0===n?void 0:n.citizenship},email:null===n||void 0===n?void 0:n.email,gender:null===n||void 0===n?void 0:n.gender,identity:null===n||void 0===n?void 0:n.identity,name:null===n||void 0===n?void 0:n.name,phone:null===n||void 0===n?void 0:n.phoneNumber,surname:null===n||void 0===n?void 0:n.surname,visa:null===n||void 0===n?void 0:n.visaNumber},v=Object(re.jsx)(xe.a.Item,{name:"email-prefix",noStyle:!0,children:Object(re.jsx)(it.a,{})});return Object(F.useEffect)((function(){!0===r&&O.resetFields()}),[O,r]),void 0===n?null:Object(re.jsx)(at.a,{closeIcon:Object(re.jsx)(ye.a,{onCancel:function(){return b(!1)},onConfirm:function(){b(!1),O.resetFields(),t()},placement:"rightTop",title:"Zav\u0159\xedt formul\xe1\u0159? Data ve formul\xe1\u0159i budou ztracena",visible:m,children:Object(re.jsx)(Re.a,{onClick:function(){O.isFieldsTouched()?b(!0):t()}})}),placement:"left",title:"Nov\xfd host",width:500,visible:r,footer:Object(re.jsx)(le.a,{onClick:function(){O.validateFields().then((function(){var e,r,i,s,c,d=O.getFieldsValue(!0),u={age:d.age,addressMunicipality:null===(e=d.address)||void 0===e?void 0:e.municipality,addressPsc:null===(r=d.address)||void 0===r?void 0:r.psc,addressStreet:null===(i=d.address)||void 0===i?void 0:i.street,citizenship:void 0===(null===(s=d.citizenship)||void 0===s?void 0:s.selected)?null===(c=d.citizenship)||void 0===c?void 0:c.new:d.citizenship.selected,email:d.email,gender:d.gender,identity:d.identity,name:d.name,phoneNumber:d.phone,surname:d.surname,visaNumber:d.visa};o({variables:{data:Object(l.a)({id:String(null===n||void 0===n?void 0:n.id),hash:a},u)}}).then((function(e){var n,a,r=null===(n=e.data)||void 0===n||null===(a=n.updateReservationGuest)||void 0===a?void 0:a.guest;void 0!==r&&null!==r&&ge.b.success("Host ".concat(r.name," ").concat(r.surname," aktualizov\xe1n!")),t()})).catch((function(e){return ge.b.error(e.message)}))})).catch((function(){return ge.b.error("Formul\xe1\u0159 nelze odeslat, opravte pros\xedm chyby")}))},type:"primary",children:"Ulo\u017eit"}),footerStyle:{padding:"16px 20px",textAlign:"right"},children:Object(re.jsx)(rt.a,{active:!0,loading:d,paragraph:{rows:15},children:Object(re.jsxs)(xe.a,{form:O,initialValues:h,layout:"vertical",name:"guest",children:[Object(re.jsx)(je.a,{level:5,children:"Osobn\xed \xfadaje"}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"Jm\xe9no",name:"name",required:!0,rules:[nt.requiredRule(i("forms.field-required")),ct.requiredAlphaRule(i("forms.enter-text"))],children:Object(re.jsx)(Ne.a,{placeholder:"Va\u0161e Jm\xe9no"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"P\u0159\xedjmen\xed",name:"surname",required:!0,rules:[nt.requiredRule(i("forms.field-required")),ct.requiredAlphaRule(i("forms.enter-text"))],children:Object(re.jsx)(Ne.a,{placeholder:"Va\u0161e P\u0159\xedjmen\xed"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"E-Mail",name:"email",required:!0,rules:[nt.requiredRule(i("forms.field-required"))],children:Object(re.jsx)(Ne.a,{addonBefore:v,placeholder:"e-mail",type:"email"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"\u010c\xedslo OP",name:"identity",children:Object(re.jsx)(Ne.a,{placeholder:"\u010d\xedslo ob\u010dansk\xe9ho pr\u016fkazu"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"Telefonn\xed \u010c\xedslo",name:"phone",children:Object(re.jsx)(Ne.a,{placeholder:"\u010d\xedslo"})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"V\u011bk",name:"age",children:Object(re.jsx)(Ce.a,{options:ct.ageOptions,placeholder:"vyberte ze seznamu"})}),Object(re.jsx)(xe.a.Item,{label:"Pohlav\xed",name:"gender",children:Object(re.jsxs)(Ce.a,{placeholder:"vyberte ze seznamu",children:[Object(re.jsx)(Ce.a.Option,{value:"M",children:"Mu\u017e"}),Object(re.jsx)(Ce.a.Option,{value:"F",children:"\u017dena"})]})}),Object(re.jsx)(xe.a.Item,{hasFeedback:!0,label:"\u010c\xedslo viza",name:"visa",children:Object(re.jsx)(Ne.a,{placeholder:"\u010d\xedslo visa"})}),Object(re.jsx)(je.a,{level:5,children:"Trval\xe9 bydli\u0161t\u011b"}),Object(re.jsx)(xe.a.Item,{label:"Ulice",name:["address","street"],children:Object(re.jsx)(Ne.a,{placeholder:"ulice"})}),Object(re.jsx)(xe.a.Item,{label:"PS\u010c/Obec",children:Object(re.jsxs)(Ne.a.Group,{compact:!0,children:[Object(re.jsx)(xe.a.Item,{style:{marginBottom:0,width:"50%"},name:["address","psc"],children:Object(re.jsx)(Ne.a,{placeholder:"PS\u010c"})}),Object(re.jsx)(xe.a.Item,{style:{marginBottom:0,width:"50%"},name:["address","municipality"],children:Object(re.jsx)(Ne.a,{placeholder:"Obec"})})]})}),Object(re.jsx)(xe.a.Item,{label:"Ob\u010danstv\xed",children:Object(re.jsxs)(Ne.a.Group,{compact:!0,children:[Object(re.jsx)(xe.a.Item,{style:{width:"50%"},name:["citizenship","selected"],children:Object(re.jsxs)(Ce.a,{style:{width:"100%"},placeholder:"ze seznamu",children:[Object(re.jsx)(Ce.a.Option,{value:"cze",children:"CZE"}),Object(re.jsx)(Ce.a.Option,{value:"sk",children:"SK"})]})}),Object(re.jsx)(xe.a.Item,{style:{width:"50%"},name:["citizenship","new"],children:Object(re.jsx)(Ne.a,{placeholder:"ru\u010dn\u011b"})})]})})]})})})},_t=function(e){var t=e.loading,n=e.openDrawer,a=e.roommates;return void 0===a||0===a.length?null:Object(re.jsx)(It.b,{bordered:!0,className:"guests-list",dataSource:a,header:Object(re.jsx)("h4",{children:"Spolubydl\xedc\xed"}),itemLayout:"horizontal",renderItem:function(e){return Object(re.jsx)(It.b.Item,{actions:t?[]:[Object(re.jsx)(le.a,{onClick:function(){n(e)},type:"link",children:"upravit"},"edit")],children:Object(re.jsx)(It.b.Item.Meta,{avatar:Object(re.jsx)(z.a,{gap:4,size:"large",style:{backgroundColor:q.getRandomColor()},children:e.name.substring(0,1).toUpperCase()}),description:e.email,title:"".concat(e.name," ").concat(e.surname)})},e.id)}})},Ut=function(e){var t=e.setPageTitle,n=Object(N.f)().hash,a=Object(P.a)().t,r=Object(F.useState)(),i=Object(k.a)(r,2),s=i[0],c=i[1],o=Object(F.useState)(),l=Object(k.a)(o,2),d=l[0],u=l[1],j=Object(F.useState)(),m=Object(k.a)(j,2),b=m[0],p=m[1],O=Object(F.useState)(!1),h=Object(k.a)(O,2),v=h[0],f=h[1],g=Object(F.useState)(!1),x=Object(k.a)(g,2),y=x[0],I=x[1],S=Object(ft.a)(Pt,{variables:{reservationHash:n},onCompleted:function(){t(a("guests.page-title")),I(!1)},onError:function(){t(null),I(!0)}}),C=S.loading,T=S.data;return Object(F.useEffect)((function(){var e,t,n=[],a=null===T||void 0===T||null===(e=T.reservationGuests)||void 0===e?void 0:e.guest,r=null===T||void 0===T||null===(t=T.reservationGuests)||void 0===t?void 0:t.roommates;void 0!==a&&null!==a&&c([a]),void 0!==r&&null!==r&&(r.forEach((function(e){null!==e&&n.push(e)})),u(n))}),[T]),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsxs)(ke.a,{spinning:C,children:[Object(re.jsx)(Gt,{guest:s,loading:C,openDrawer:function(e){p(e),f(!0)}}),Object(re.jsx)(_t,{loading:C,openDrawer:function(e){p(e),f(!0)},roommates:d}),Object(re.jsx)(Bt,{show:y})]}),Object(re.jsx)(Ht,{close:function(){return f(!1)},guest:b,reservationHash:n,visible:v})]})},Lt=function(e){var t=e.title;return null===t?null:Object(re.jsx)(je.a,{level:3,style:{borderBottom:"1px solid #e1e1e1",paddingBottom:".3em"},children:t})},Vt=function(){var e=Object(P.a)().t,t=Object(F.useState)("".concat(e("loading"),"...")),n=Object(k.a)(t,2),a=n[0],r=n[1],i=Object(F.useState)("user"),s=Object(k.a)(i,2),c=s[0],o=s[1];return Object(re.jsxs)(S.a,{id:"app",children:[Object(re.jsx)(C.a,{offsetTop:0,className:"app__affix-header",children:Object(re.jsx)(ce,{selectedPage:c,user:function(){var e=localStorage.getItem(W);return null!==e?{username:e}:null}()})}),Object(re.jsx)(S.a.Header,{children:Object(re.jsx)(Lt,{title:a})}),Object(re.jsx)(S.a.Content,{className:"app-content",children:Object(re.jsxs)(N.c,{children:[Object(re.jsx)(N.a,{exact:!0,path:X,children:Object(re.jsx)(yt,{setPageTitle:r,setSelectedPage:o})}),Object(re.jsx)(N.a,{exact:!0,path:Y,children:Object(re.jsx)(Mt,{setPageTitle:r,setSelectedPage:o})}),Object(re.jsx)(N.a,{exact:!0,path:L,children:Object(re.jsx)(St,{setPageTitle:r,setSelectedPage:o})}),Object(re.jsx)(N.a,{exact:!0,path:V,children:Object(re.jsx)(At,{setPageTitle:r})}),Object(re.jsx)(N.a,{exact:!0,path:K,children:Object(re.jsx)(Ut,{setPageTitle:r})}),Object(re.jsx)(N.a,{path:"*",children:Object(re.jsx)(de,{})})]})})]})},Kt=n(16),Xt=n(295),Yt=n.n(Xt),Zt=n(236),Jt=n(292),Wt=n(164);Zt.a.use(Jt.a).use(Wt.e).init({fallbackLng:"cs",debug:!1,lng:"cs"});Zt.a,n(523);var Qt,en=function(){return Object(re.jsx)(S.a,{className:"splash-layout",children:Object(re.jsxs)(S.a.Content,{children:[Object(re.jsx)(rt.a,{active:!0,avatar:!0,paragraph:{rows:3},className:"splash-skeleton"}),Object(re.jsx)(rt.a,{active:!0,avatar:!0,paragraph:{rows:3},className:"splash-skeleton"}),Object(re.jsx)(rt.a,{active:!0,avatar:!0,paragraph:{rows:3},className:"splash-skeleton"})]})})};p.a.locale("cs");var tn=new O.a({uri:"/api"}),nn=new h.a((function(e,t){var n=localStorage.getItem(J),a=m("csrftoken");return e.setContext((function(e){var t=e.headers,r=void 0===t?{}:t;return{headers:Object(l.a)(Object(l.a)({},r),{},{Authorization:null===n?"":"JWT ".concat(n),"X-CSRFToken":null===a?"":a})}})),t(e)})),an=Object(I.a)((function(e){var t=e.graphQLErrors,n=e.networkError,a=e.operation,r=e.forward;if(t){var i,s=Object(o.a)(t);try{for(s.s();!(i=s.n()).done;){switch(i.value.message){case _:return Object(v.a)(Qt.mutate({mutation:ne,variables:{refreshToken:localStorage.getItem(Z)}}).then((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.refreshToken})).catch((function(e){return console.error(e)}))).flatMap((function(e){var t=e;return localStorage.setItem(J,t.token),localStorage.setItem(Z,t.refreshToken),localStorage.setItem(W,t.payload.username),localStorage.setItem("tokenExpiresIn",t.payload.exp.toString()),localStorage.setItem("refreshTokenExpiresIn",t.refreshExpiresIn.toString()),r(a)}));case H:case U:localStorage.removeItem(J),localStorage.removeItem(Z),localStorage.removeItem(W),window.location.replace(V)}}}catch(c){s.e(c)}finally{s.f()}}n&&console.error(n)}));Qt=new f.a({cache:new g.a({typePolicies:{Query:{fields:{guests:{merge:!1},reservations:{merge:!1},suiteReservations:{merge:!1},suites:{merge:!1}}},Reservation:{fields:{roommates:{merge:!1}}}}}),link:Object(x.a)([an,nn,tn])}),u.a.render(Object(re.jsx)(F.Suspense,{fallback:Object(re.jsx)(en,{}),children:Object(re.jsx)(y.a,{client:Qt,children:Object(re.jsx)(Kt.b,{locale:Yt.a,children:Object(re.jsx)(j.a,{children:Object(re.jsx)(Vt,{})})})})}),document.getElementById("root"))}},[[527,1,2]]]);
//# sourceMappingURL=main.7cc29cf4.chunk.js.map